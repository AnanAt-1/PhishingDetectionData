<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head profile="http://gmpg.org/xfn/11">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>Hacking into a Vehicle CAN bus (Toyothack and SocketCAN) | fabiobaltieri</title>
	<link rel="pingback" href="https://fabiobaltieri.com/xmlrpc.php" />
	<meta name='robots' content='max-image-preview:large' />
<meta name="google-site-verification" content="JOrcXaaXV3pQ_4aOOW20szJJ0d_Xi_DK-1sYgvg2lfg" />

<!-- Async WordPress.com Remote Login -->
<script id="wpcom_remote_login_js">
var wpcom_remote_login_extra_auth = '';
function wpcom_remote_login_remove_dom_node_id( element_id ) {
	var dom_node = document.getElementById( element_id );
	if ( dom_node ) { dom_node.parentNode.removeChild( dom_node ); }
}
function wpcom_remote_login_remove_dom_node_classes( class_name ) {
	var dom_nodes = document.querySelectorAll( '.' + class_name );
	for ( var i = 0; i < dom_nodes.length; i++ ) {
		dom_nodes[ i ].parentNode.removeChild( dom_nodes[ i ] );
	}
}
function wpcom_remote_login_final_cleanup() {
	wpcom_remote_login_remove_dom_node_classes( "wpcom_remote_login_msg" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_key" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_validate" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_js" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_request_access_iframe" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_request_access_styles" );
}

// Watch for messages back from the remote login
window.addEventListener( "message", function( e ) {
	if ( e.origin === "https://r-login.wordpress.com" ) {
		var data = {};
		try {
			data = JSON.parse( e.data );
		} catch( e ) {
			wpcom_remote_login_final_cleanup();
			return;
		}

		if ( data.msg === 'LOGIN' ) {
			// Clean up the login check iframe
			wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_key" );

			var id_regex = new RegExp( /^[0-9]+$/ );
			var token_regex = new RegExp( /^.*|.*|.*$/ );
			if (
				token_regex.test( data.token )
				&& id_regex.test( data.wpcomid )
			) {
				// We have everything we need to ask for a login
				var script = document.createElement( "script" );
				script.setAttribute( "id", "wpcom_remote_login_validate" );
				script.src = '/remote-login.php?wpcom_remote_login=validate'
					+ '&wpcomid=' + data.wpcomid
					+ '&token=' + encodeURIComponent( data.token )
					+ '&host=' + window.location.protocol
					+ '//' + window.location.hostname
					+ '&postid=1419'
					+ '&is_singular=1';
				document.body.appendChild( script );
			}

			return;
		}

		// Safari ITP, not logged in, so redirect
		if ( data.msg === 'LOGIN-REDIRECT' ) {
			window.location = 'https://wordpress.com/log-in?redirect_to=' + window.location.href;
			return;
		}

		// Safari ITP, storage access failed, remove the request
		if ( data.msg === 'LOGIN-REMOVE' ) {
			var css_zap = 'html { -webkit-transition: margin-top 1s; transition: margin-top 1s; } /* 9001 */ html { margin-top: 0 !important; } * html body { margin-top: 0 !important; } @media screen and ( max-width: 782px ) { html { margin-top: 0 !important; } * html body { margin-top: 0 !important; } }';
			var style_zap = document.createElement( 'style' );
			style_zap.type = 'text/css';
			style_zap.appendChild( document.createTextNode( css_zap ) );
			document.body.appendChild( style_zap );

			var e = document.getElementById( 'wpcom_request_access_iframe' );
			e.parentNode.removeChild( e );

			document.cookie = 'wordpress_com_login_access=denied; path=/; max-age=31536000';

			return;
		}

		// Safari ITP
		if ( data.msg === 'REQUEST_ACCESS' ) {
			console.log( 'request access: safari' );

			// Check ITP iframe enable/disable knob
			if ( wpcom_remote_login_extra_auth !== 'safari_itp_iframe' ) {
				return;
			}

			// If we are in a "private window" there is no ITP.
			var private_window = false;
			try {
				var opendb = window.openDatabase( null, null, null, null );
			} catch( e ) {
				private_window = true;
			}

			if ( private_window ) {
				console.log( 'private window' );
				return;
			}

			var iframe = document.createElement( 'iframe' );
			iframe.id = 'wpcom_request_access_iframe';
			iframe.setAttribute( 'scrolling', 'no' );
			iframe.setAttribute( 'sandbox', 'allow-storage-access-by-user-activation allow-scripts allow-same-origin allow-top-navigation-by-user-activation' );
			iframe.src = 'https://r-login.wordpress.com/remote-login.php?wpcom_remote_login=request_access&origin=' + encodeURIComponent( data.origin ) + '&wpcomid=' + encodeURIComponent( data.wpcomid );

			var css = 'html { -webkit-transition: margin-top 1s; transition: margin-top 1s; } /* 9001 */ html { margin-top: 46px !important; } * html body { margin-top: 46px !important; } @media screen and ( max-width: 660px ) { html { margin-top: 71px !important; } * html body { margin-top: 71px !important; } #wpcom_request_access_iframe { display: block; height: 71px !important; } } #wpcom_request_access_iframe { border: 0px; height: 46px; position: fixed; top: 0; left: 0; width: 100%; min-width: 100%; z-index: 99999; background: #23282d; } ';

			var style = document.createElement( 'style' );
			style.type = 'text/css';
			style.id = 'wpcom_request_access_styles';
			style.appendChild( document.createTextNode( css ) );
			document.body.appendChild( style );

			document.body.appendChild( iframe );
		}

		if ( data.msg === 'DONE' ) {
			wpcom_remote_login_final_cleanup();
		}
	}
}, false );

// Inject the remote login iframe after the page has had a chance to load
// more critical resources
window.addEventListener( "DOMContentLoaded", function( e ) {
	var iframe = document.createElement( "iframe" );
	iframe.style.display = "none";
	iframe.setAttribute( "scrolling", "no" );
	iframe.setAttribute( "id", "wpcom_remote_login_key" );
	iframe.src = "https://r-login.wordpress.com/remote-login.php"
		+ "?wpcom_remote_login=key"
		+ "&origin=aHR0cHM6Ly9mYWJpb2JhbHRpZXJpLmNvbQ%3D%3D"
		+ "&wpcomid=26221171"
		+ "&time=1747344578";
	document.body.appendChild( iframe );
}, false );
</script>
<link rel='dns-prefetch' href='//s1.wp.com' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//s2.wp.com' />
<link rel='dns-prefetch' href='//widgets.wp.com' />
<link rel='dns-prefetch' href='//af.pubmine.com' />
<link rel='dns-prefetch' href='//s.pubmine.com' />
<link rel='dns-prefetch' href='//x.bidswitch.net' />
<link rel='dns-prefetch' href='//static.criteo.net' />
<link rel='dns-prefetch' href='//ib.adnxs.com' />
<link rel='dns-prefetch' href='//aax.amazon-adsystem.com' />
<link rel='dns-prefetch' href='//bidder.criteo.com' />
<link rel='dns-prefetch' href='//cas.criteo.com' />
<link rel='dns-prefetch' href='//gum.criteo.com' />
<link rel='dns-prefetch' href='//ads.pubmatic.com' />
<link rel='dns-prefetch' href='//gads.pubmatic.com' />
<link rel='dns-prefetch' href='//tpc.googlesyndication.com' />
<link rel='dns-prefetch' href='//ad.doubleclick.net' />
<link rel='dns-prefetch' href='//googleads.g.doubleclick.net' />
<link rel='dns-prefetch' href='//www.googletagservices.com' />
<link rel='dns-prefetch' href='//cdn.switchadhub.com' />
<link rel='dns-prefetch' href='//delivery.g.switchadhub.com' />
<link rel='dns-prefetch' href='//delivery.swid.switchadhub.com' />
<link rel='dns-prefetch' href='//a.teads.tv' />
<link rel='dns-prefetch' href='//prebid.media.net' />
<link rel='dns-prefetch' href='//adserver-us.adtech.advertising.com' />
<link rel='dns-prefetch' href='//fastlane.rubiconproject.com' />
<link rel='dns-prefetch' href='//prebid-server.rubiconproject.com' />
<link rel='dns-prefetch' href='//hb-api.omnitagjs.com' />
<link rel='dns-prefetch' href='//mtrx.go.sonobi.com' />
<link rel='dns-prefetch' href='//apex.go.sonobi.com' />
<link rel='dns-prefetch' href='//u.openx.net' />
<link rel="alternate" type="application/rss+xml" title="fabiobaltieri &raquo; Feed" href="https://fabiobaltieri.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="fabiobaltieri &raquo; Comments Feed" href="https://fabiobaltieri.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="fabiobaltieri &raquo; Hacking into a Vehicle CAN bus (Toyothack and&nbsp;SocketCAN) Comments Feed" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/feed/" />
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
	<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s1.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1743601627i&ver=6.8.1-alpha-60199"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\ud83d\udd25","\ud83d\udc26\u200b\ud83d\udd25")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-0-1' href='https://s0.wp.com/_static/??-eJyFjNsKwjAQBX/IuMS2+CR+S5osIe0mG7Ib+/teEAUFfRzOmYGtGs9FsSjMxNFU6jEVgY1bcEEgEs+O9l5kB/++twFbbUnQXA5fSu4vYUGtzq9PBukFModOKNCQnGIwlUU/6FeR0orv7oPu93M+2eM4TXYY7bBcAd4uWGA=&cssminify=yes' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-2-1' href='https://s1.wp.com/wp-content/plugins/gutenberg-core/v20.6.0/build/block-library/style.css?m=1744959081i&cssminify=yes' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify {
	text-align:justify;
}
.has-text-align-justify{text-align:justify;}
</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-4-1' href='https://s1.wp.com/_static/??-eJyVzDEOgCAMQNELiQU1Jg7Gs2AlDYpAaInx9ro5O/7hfbiywhTFRYEcKvnIQPXN1RVSa0h4MOxOssVDBXunKoqK34DlDq5F5gb+LIoVH4k/vpyzGYe+03oyw/4AcmU1KQ==&cssminify=yes' type='text/css' media='all' />
<link crossorigin='anonymous' rel='stylesheet' id='all-css-6-1' href='https://s2.wp.com/_static/??-eJzTLy/QzcxLzilNSS3WzyrWz01NyUxMzUnNTc0rQeEU5CRWphbp5qSmJyZX6uVm5uklFxfr6OPTDpRD5sM02efaGpoZmFkYGRuZGmQBAHPvL0Y=&cssminify=yes' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-8-1' href='https://s2.wp.com/_static/??-eJx9jcEKg0AMRH+oaVhorR7Eb9E16IpZg8min2889FZ6GYbhPQYPgbhlo2zIBWQtU8qKcdvJd5be0AmmMfW0Ejv2jKoP/K0daZzIXNdvB6PzvyJ+A8MgO6mCJ6fCYLN/6e113IZXU9WfUL/DcgHSTkDo&cssminify=yes' type='text/css' media='all' />
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-family--albert-sans: 'Albert Sans', sans-serif;--wp--preset--font-family--alegreya: Alegreya, serif;--wp--preset--font-family--arvo: Arvo, serif;--wp--preset--font-family--bodoni-moda: 'Bodoni Moda', serif;--wp--preset--font-family--bricolage-grotesque: 'Bricolage Grotesque', sans-serif;--wp--preset--font-family--cabin: Cabin, sans-serif;--wp--preset--font-family--chivo: Chivo, sans-serif;--wp--preset--font-family--commissioner: Commissioner, sans-serif;--wp--preset--font-family--cormorant: Cormorant, serif;--wp--preset--font-family--courier-prime: 'Courier Prime', monospace;--wp--preset--font-family--crimson-pro: 'Crimson Pro', serif;--wp--preset--font-family--dm-mono: 'DM Mono', monospace;--wp--preset--font-family--dm-sans: 'DM Sans', sans-serif;--wp--preset--font-family--dm-serif-display: 'DM Serif Display', serif;--wp--preset--font-family--domine: Domine, serif;--wp--preset--font-family--eb-garamond: 'EB Garamond', serif;--wp--preset--font-family--epilogue: Epilogue, sans-serif;--wp--preset--font-family--fahkwang: Fahkwang, sans-serif;--wp--preset--font-family--figtree: Figtree, sans-serif;--wp--preset--font-family--fira-sans: 'Fira Sans', sans-serif;--wp--preset--font-family--fjalla-one: 'Fjalla One', sans-serif;--wp--preset--font-family--fraunces: Fraunces, serif;--wp--preset--font-family--gabarito: Gabarito, system-ui;--wp--preset--font-family--ibm-plex-mono: 'IBM Plex Mono', monospace;--wp--preset--font-family--ibm-plex-sans: 'IBM Plex Sans', sans-serif;--wp--preset--font-family--ibarra-real-nova: 'Ibarra Real Nova', serif;--wp--preset--font-family--instrument-serif: 'Instrument Serif', serif;--wp--preset--font-family--inter: Inter, sans-serif;--wp--preset--font-family--josefin-sans: 'Josefin Sans', sans-serif;--wp--preset--font-family--jost: Jost, sans-serif;--wp--preset--font-family--libre-baskerville: 'Libre Baskerville', serif;--wp--preset--font-family--libre-franklin: 'Libre Franklin', sans-serif;--wp--preset--font-family--literata: Literata, serif;--wp--preset--font-family--lora: Lora, serif;--wp--preset--font-family--merriweather: Merriweather, serif;--wp--preset--font-family--montserrat: Montserrat, sans-serif;--wp--preset--font-family--newsreader: Newsreader, serif;--wp--preset--font-family--noto-sans-mono: 'Noto Sans Mono', sans-serif;--wp--preset--font-family--nunito: Nunito, sans-serif;--wp--preset--font-family--open-sans: 'Open Sans', sans-serif;--wp--preset--font-family--overpass: Overpass, sans-serif;--wp--preset--font-family--pt-serif: 'PT Serif', serif;--wp--preset--font-family--petrona: Petrona, serif;--wp--preset--font-family--piazzolla: Piazzolla, serif;--wp--preset--font-family--playfair-display: 'Playfair Display', serif;--wp--preset--font-family--plus-jakarta-sans: 'Plus Jakarta Sans', sans-serif;--wp--preset--font-family--poppins: Poppins, sans-serif;--wp--preset--font-family--raleway: Raleway, sans-serif;--wp--preset--font-family--roboto: Roboto, sans-serif;--wp--preset--font-family--roboto-slab: 'Roboto Slab', serif;--wp--preset--font-family--rubik: Rubik, sans-serif;--wp--preset--font-family--rufina: Rufina, serif;--wp--preset--font-family--sora: Sora, sans-serif;--wp--preset--font-family--source-sans-3: 'Source Sans 3', sans-serif;--wp--preset--font-family--source-serif-4: 'Source Serif 4', serif;--wp--preset--font-family--space-mono: 'Space Mono', monospace;--wp--preset--font-family--syne: Syne, sans-serif;--wp--preset--font-family--texturina: Texturina, serif;--wp--preset--font-family--urbanist: Urbanist, sans-serif;--wp--preset--font-family--work-sans: 'Work Sans', sans-serif;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}.has-albert-sans-font-family{font-family: var(--wp--preset--font-family--albert-sans) !important;}.has-alegreya-font-family{font-family: var(--wp--preset--font-family--alegreya) !important;}.has-arvo-font-family{font-family: var(--wp--preset--font-family--arvo) !important;}.has-bodoni-moda-font-family{font-family: var(--wp--preset--font-family--bodoni-moda) !important;}.has-bricolage-grotesque-font-family{font-family: var(--wp--preset--font-family--bricolage-grotesque) !important;}.has-cabin-font-family{font-family: var(--wp--preset--font-family--cabin) !important;}.has-chivo-font-family{font-family: var(--wp--preset--font-family--chivo) !important;}.has-commissioner-font-family{font-family: var(--wp--preset--font-family--commissioner) !important;}.has-cormorant-font-family{font-family: var(--wp--preset--font-family--cormorant) !important;}.has-courier-prime-font-family{font-family: var(--wp--preset--font-family--courier-prime) !important;}.has-crimson-pro-font-family{font-family: var(--wp--preset--font-family--crimson-pro) !important;}.has-dm-mono-font-family{font-family: var(--wp--preset--font-family--dm-mono) !important;}.has-dm-sans-font-family{font-family: var(--wp--preset--font-family--dm-sans) !important;}.has-dm-serif-display-font-family{font-family: var(--wp--preset--font-family--dm-serif-display) !important;}.has-domine-font-family{font-family: var(--wp--preset--font-family--domine) !important;}.has-eb-garamond-font-family{font-family: var(--wp--preset--font-family--eb-garamond) !important;}.has-epilogue-font-family{font-family: var(--wp--preset--font-family--epilogue) !important;}.has-fahkwang-font-family{font-family: var(--wp--preset--font-family--fahkwang) !important;}.has-figtree-font-family{font-family: var(--wp--preset--font-family--figtree) !important;}.has-fira-sans-font-family{font-family: var(--wp--preset--font-family--fira-sans) !important;}.has-fjalla-one-font-family{font-family: var(--wp--preset--font-family--fjalla-one) !important;}.has-fraunces-font-family{font-family: var(--wp--preset--font-family--fraunces) !important;}.has-gabarito-font-family{font-family: var(--wp--preset--font-family--gabarito) !important;}.has-ibm-plex-mono-font-family{font-family: var(--wp--preset--font-family--ibm-plex-mono) !important;}.has-ibm-plex-sans-font-family{font-family: var(--wp--preset--font-family--ibm-plex-sans) !important;}.has-ibarra-real-nova-font-family{font-family: var(--wp--preset--font-family--ibarra-real-nova) !important;}.has-instrument-serif-font-family{font-family: var(--wp--preset--font-family--instrument-serif) !important;}.has-inter-font-family{font-family: var(--wp--preset--font-family--inter) !important;}.has-josefin-sans-font-family{font-family: var(--wp--preset--font-family--josefin-sans) !important;}.has-jost-font-family{font-family: var(--wp--preset--font-family--jost) !important;}.has-libre-baskerville-font-family{font-family: var(--wp--preset--font-family--libre-baskerville) !important;}.has-libre-franklin-font-family{font-family: var(--wp--preset--font-family--libre-franklin) !important;}.has-literata-font-family{font-family: var(--wp--preset--font-family--literata) !important;}.has-lora-font-family{font-family: var(--wp--preset--font-family--lora) !important;}.has-merriweather-font-family{font-family: var(--wp--preset--font-family--merriweather) !important;}.has-montserrat-font-family{font-family: var(--wp--preset--font-family--montserrat) !important;}.has-newsreader-font-family{font-family: var(--wp--preset--font-family--newsreader) !important;}.has-noto-sans-mono-font-family{font-family: var(--wp--preset--font-family--noto-sans-mono) !important;}.has-nunito-font-family{font-family: var(--wp--preset--font-family--nunito) !important;}.has-open-sans-font-family{font-family: var(--wp--preset--font-family--open-sans) !important;}.has-overpass-font-family{font-family: var(--wp--preset--font-family--overpass) !important;}.has-pt-serif-font-family{font-family: var(--wp--preset--font-family--pt-serif) !important;}.has-petrona-font-family{font-family: var(--wp--preset--font-family--petrona) !important;}.has-piazzolla-font-family{font-family: var(--wp--preset--font-family--piazzolla) !important;}.has-playfair-display-font-family{font-family: var(--wp--preset--font-family--playfair-display) !important;}.has-plus-jakarta-sans-font-family{font-family: var(--wp--preset--font-family--plus-jakarta-sans) !important;}.has-poppins-font-family{font-family: var(--wp--preset--font-family--poppins) !important;}.has-raleway-font-family{font-family: var(--wp--preset--font-family--raleway) !important;}.has-roboto-font-family{font-family: var(--wp--preset--font-family--roboto) !important;}.has-roboto-slab-font-family{font-family: var(--wp--preset--font-family--roboto-slab) !important;}.has-rubik-font-family{font-family: var(--wp--preset--font-family--rubik) !important;}.has-rufina-font-family{font-family: var(--wp--preset--font-family--rufina) !important;}.has-sora-font-family{font-family: var(--wp--preset--font-family--sora) !important;}.has-source-sans-3-font-family{font-family: var(--wp--preset--font-family--source-sans-3) !important;}.has-source-serif-4-font-family{font-family: var(--wp--preset--font-family--source-serif-4) !important;}.has-space-mono-font-family{font-family: var(--wp--preset--font-family--space-mono) !important;}.has-syne-font-family{font-family: var(--wp--preset--font-family--syne) !important;}.has-texturina-font-family{font-family: var(--wp--preset--font-family--texturina) !important;}.has-urbanist-font-family{font-family: var(--wp--preset--font-family--urbanist) !important;}.has-work-sans-font-family{font-family: var(--wp--preset--font-family--work-sans) !important;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-10-1' href='https://s2.wp.com/wp-content/mu-plugins/jetpack-mu-wpcom-plugin/sun/jetpack_vendor/automattic/jetpack-mu-wpcom/src/build/verbum-comments/verbum-comments.css?m=1746618905i&cssminify=yes' type='text/css' media='all' />
<link rel='stylesheet' id='verbum-gutenberg-css-css' href='https://widgets.wp.com/verbum-block-editor/block-editor.css?ver=1738686361' media='all' />
<link crossorigin='anonymous' rel='stylesheet' id='all-css-12-1' href='https://s1.wp.com/wp-content/themes/pub/enterprise/style.css?m=1454612929i&cssminify=yes' type='text/css' media='all' />
<style id='akismet-widget-style-inline-css'>

			.a-stats {
				--akismet-color-mid-green: #357b49;
				--akismet-color-white: #fff;
				--akismet-color-light-grey: #f6f7f7;

				max-width: 350px;
				width: auto;
			}

			.a-stats * {
				all: unset;
				box-sizing: border-box;
			}

			.a-stats strong {
				font-weight: 600;
			}

			.a-stats a.a-stats__link,
			.a-stats a.a-stats__link:visited,
			.a-stats a.a-stats__link:active {
				background: var(--akismet-color-mid-green);
				border: none;
				box-shadow: none;
				border-radius: 8px;
				color: var(--akismet-color-white);
				cursor: pointer;
				display: block;
				font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen-Sans', 'Ubuntu', 'Cantarell', 'Helvetica Neue', sans-serif;
				font-weight: 500;
				padding: 12px;
				text-align: center;
				text-decoration: none;
				transition: all 0.2s ease;
			}

			/* Extra specificity to deal with TwentyTwentyOne focus style */
			.widget .a-stats a.a-stats__link:focus {
				background: var(--akismet-color-mid-green);
				color: var(--akismet-color-white);
				text-decoration: none;
			}

			.a-stats a.a-stats__link:hover {
				filter: brightness(110%);
				box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06), 0 0 2px rgba(0, 0, 0, 0.16);
			}

			.a-stats .count {
				color: var(--akismet-color-white);
				display: block;
				font-size: 1.5em;
				line-height: 1.4;
				padding: 0 13px;
				white-space: nowrap;
			}
		
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-14-1' href='https://s1.wp.com/_static/??-eJzTLy/QTc7PK0nNK9HPLdUtyClNz8wr1i9KTcrJTwcy0/WTi5G5ekCujj52Temp+bo5+cmJJZn5eSgc3bScxMwikFb7XFtDE1NLExMLc0OTLACohS2q&cssminify=yes' type='text/css' media='all' />
<link crossorigin='anonymous' rel='stylesheet' id='print-css-15-1' href='https://s1.wp.com/wp-content/mu-plugins/global-print/global-print.css?m=1465851035i&cssminify=yes' type='text/css' media='print' />
<style id='jetpack-global-styles-frontend-style-inline-css'>
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-18-1' href='https://s2.wp.com/_static/??-eJyNjcsKAjEMRX/IGmYYdFyInyKZNrQd06SYFvHvfeBG3Li7By7nwK06r9JIGpTuKveYxWClVtFfPgzWBYqGzmRgCa8UMIT7e2aJW2+2gb9F5yweTH1GdqxR7Qt+ZC1ReWbTBJF1QX4dTuU47KfdPI7zYVgfuRlIaA==&cssminify=yes' type='text/css' media='all' />
<script type="text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="text/javascript" id="jetpack-mu-wpcom-settings-js-before">
/* <![CDATA[ */
var JETPACK_MU_WPCOM_SETTINGS = {"assetsUrl":"https:\/\/s1.wp.com\/wp-content\/mu-plugins\/jetpack-mu-wpcom-plugin\/sun\/jetpack_vendor\/automattic\/jetpack-mu-wpcom\/src\/build\/"};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s1.wp.com/_static/??/wp-content/mu-plugins/jetpack-plugin/sun/_inc/build/related-posts/related-posts.min.js,/wp-content/js/rlt-proxy.js?m=1733765333j'></script>
<script type="text/javascript" id="rlt-proxy-js-after">
/* <![CDATA[ */
	rltInitialize( {"token":null,"iframeOrigins":["https:\/\/widgets.wp.com"]} );
/* ]]> */
</script>
<script type="text/javascript" crossorigin='anonymous' src="https://s0.wp.com/wp-content/plugins/gutenberg-core/v20.6.0/build/hooks/index.min.js?m=1744959081i&amp;ver=84e753e2b66eb7028d38" id="wp-hooks-js"></script>
<script type="text/javascript" crossorigin='anonymous' src="https://s0.wp.com/wp-content/plugins/gutenberg-core/v20.6.0/build/i18n/index.min.js?m=1744959081i&amp;ver=bd5a2533e717a1043151" id="wp-i18n-js"></script>
<script type="text/javascript" id="wp-i18n-js-after">
/* <![CDATA[ */
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
/* ]]> */
</script>
<script type="text/javascript" id="wpcom-actionbar-placeholder-js-extra">
/* <![CDATA[ */
var actionbardata = {"siteID":"26221171","postID":"1419","siteURL":"https:\/\/fabiobaltieri.com","xhrURL":"https:\/\/fabiobaltieri.com\/wp-admin\/admin-ajax.php","nonce":"2b7e8ab620","isLoggedIn":"","statusMessage":"","subsEmailDefault":"instantly","proxyScriptUrl":"https:\/\/s0.wp.com\/wp-content\/js\/wpcom-proxy-request.js?ver=20211021","shortlink":"https:\/\/wp.me\/p1M1k7-mT","i18n":{"followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/reader\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","shortLinkCopied":"Shortlink copied to clipboard."}};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s1.wp.com/wp-content/blog-plugins/wordads-classes/js/cmp/v2/cmp-non-gdpr.js?m=1707933448i'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://fabiobaltieri.wordpress.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress.com" />
<link rel="canonical" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/" />
<link rel='shortlink' href='https://wp.me/p1M1k7-mT' />
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/?format=json&amp;url=https%3A%2F%2Ffabiobaltieri.com%2F2013%2F07%2F23%2Fhacking-into-a-vehicle-can-bus-toyothack-and-socketcan%2F&amp;for=wpcom-auto-discovery" /><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/?format=xml&amp;url=https%3A%2F%2Ffabiobaltieri.com%2F2013%2F07%2F23%2Fhacking-into-a-vehicle-can-bus-toyothack-and-socketcan%2F&amp;for=wpcom-auto-discovery" />
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Hacking into a Vehicle CAN bus (Toyothack and SocketCAN)" />
<meta property="og:url" content="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/" />
<meta property="og:description" content="CAN bus is an automation fieldbus commonly used in the automotive industry as the main network bus to allow communications between the many on-board ECUs on modern vehicles. The Linux kernel has na…" />
<meta property="article:published_time" content="2013-07-23T14:59:19+00:00" />
<meta property="article:modified_time" content="2014-06-15T17:47:27+00:00" />
<meta property="og:site_name" content="fabiobaltieri" />
<meta property="og:image" content="https://fabiobaltieri.com/wp-content/uploads/2013/07/toyothack-intro.png" />
<meta property="og:image:alt" content="https://fabiobaltieri.com/wp-content/uploads/2013/07/toyothack-intro.png" />
<meta property="og:locale" content="en_US" />
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom" />
<meta name="twitter:text:title" content="Hacking into a Vehicle CAN bus (Toyothack and&nbsp;SocketCAN)" />
<meta name="twitter:image" content="https://fabiobaltieri.com/wp-content/uploads/2013/07/toyothack-intro.png?w=144" />
<meta name="twitter:image:alt" content="https://fabiobaltieri.com/wp-content/uploads/2013/07/toyothack-intro.png" />
<meta name="twitter:card" content="summary" />

<!-- End Jetpack Open Graph Tags -->
<link rel="shortcut icon" type="image/x-icon" href="https://s1.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="icon" type="image/x-icon" href="https://s1.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="apple-touch-icon" href="https://s2.wp.com/i/webclip.png" />
<link rel='openid.server' href='https://fabiobaltieri.com/?openidserver=1' />
<link rel='openid.delegate' href='https://fabiobaltieri.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="https://fabiobaltieri.com/osd.xml" title="fabiobaltieri" />
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com" />
		<style id="wpcom-hotfix-masterbar-style">
			@media screen and (min-width: 783px) {
				#wpadminbar .quicklinks li#wp-admin-bar-my-account.with-avatar > a img {
					margin-top: 5px;
				}
			}
		</style>
		<meta name="description" content="CAN bus is an automation fieldbus commonly used in the automotive industry as the main network bus to allow communications between the many on-board ECUs on modern vehicles. The Linux kernel has native CAN bus support at network layer since some years, with a lot of drivers for both embedded and USB CAN bus controllers,&hellip;" />
		<style type="text/css">
			#header h1,
			#header h1 a,
			#header h1 a:visited,
			#header h4,
			#header h4 a,
			#header h4 a:visited,
			.header-left {
				color: #333333;
			}
		</style>
<script type="text/javascript">
/* <![CDATA[ */
var wa_smart = { 'network_id': 3905, 'site_id': 560111, 'page_id': 1700829, 'blog_id': 26221171, 'post_id': 1419, 'theme': 'pub/enterprise', 'target': 'wp_blog_id=26221171;language=en', '_': { 'title': 'Advertisement', 'privacy_settings': 'Privacy Settings' }, 'top': { 'enabled': false, 'format_id': 135099 }, 'inline': { 'enabled': true, 'format_id': 110354, 'max_slots': 20, 'max_blaze_slots': 20 }, 'belowpost': { 'enabled': false, 'format_id': 134071 }, 'bottom_sticky': { 'enabled': false, 'format_id': 117571 }, 'sidebar': { 'enabled': false, 'format_id': 134686 }, 'sidebar_sticky_right': { 'enabled': false, 'format_id': 135281 }, 'gutenberg_rectangle': { 'enabled': false, 'format_id': 134788 }, 'gutenberg_leaderboard': { 'enabled': false, 'format_id': 135073 }, 'gutenberg_mobile_leaderboard': { 'enabled': false, 'format_id': 135098 }, 'gutenberg_skyscraper': { 'enabled': false, 'format_id': 135088 }, 'sidebar_widget_mediumrectangle': { 'enabled': false, 'format_id': 137624 }, 'sidebar_widget_leaderboard': { 'enabled': false, 'format_id': 137625 }, 'sidebar_widget_wideskyscraper': { 'enabled': false, 'format_id': 137626 }, 'shortcode': { 'enabled': false, 'format_id': 137678 }, 'is_wordads': true }; wa_smart.cmd = [];
/* ]]> */
</script>
		<script type="text/javascript">
		function __ATA_CC() {var v = document.cookie.match('(^|;) ?personalized-ads-consent=([^;]*)(;|$)');return v ? 1 : 0;}
		var __ATA_PP = { 'pt': 1, 'ht': 1, 'tn': 'enterprise', 'uloggedin': 0, 'amp': false, 'consent': __ATA_CC(), 'gdpr_applies': false, 'ad': { 'label': { 'text': 'Advertisements' }, 'reportAd': { 'text': 'Report this ad' } }, 'disabled_slot_formats': [ 'IAD' ], 'siteid': 26221171 };
		var __ATA = __ATA || {};
		__ATA.cmd = __ATA.cmd || [];
		__ATA.criteo = __ATA.criteo || {};
		__ATA.criteo.cmd = __ATA.criteo.cmd || [];
		</script>
		<script type="text/javascript">
		(function(){var g=Date.now||function(){return+new Date};function h(a,b){a:{for(var c=a.length,d="string"==typeof a?a.split(""):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:"string"==typeof a?a.charAt(b):a[b]};function k(a,b,c){c=null!=c?"="+encodeURIComponent(String(c)):"";if(b+=c){c=a.indexOf("#");0>c&&(c=a.length);var d=a.indexOf("?");if(0>d||d>c){d=c;var e=""}else e=a.substring(d+1,c);a=[a.substr(0,d),e,a.substr(c)];c=a[1];a[1]=b?c?c+"&"+b:b:c;a=a[0]+(a[1]?"?"+a[1]:"")+a[2]}return a};var l=0;function m(a,b){var c=document.createElement("script");c.src=a;c.onload=function(){b&&b(void 0)};c.onerror=function(){b&&b("error")};a=document.getElementsByTagName("head");var d;a&&0!==a.length?d=a[0]:d=document.documentElement;d.appendChild(c)}function n(a){var b=void 0===b?document.cookie:b;return(b=h(b.split("; "),function(c){return-1!=c.indexOf(a+"=")}))?b.split("=")[1]:""}function p(a){return"string"==typeof a&&0<a.length}
		function r(a,b,c){b=void 0===b?"":b;c=void 0===c?".":c;var d=[];Object.keys(a).forEach(function(e){var f=a[e],q=typeof f;"object"==q&&null!=f||"function"==q?d.push(r(f,b+e+c)):null!==f&&void 0!==f&&(e=encodeURIComponent(b+e),d.push(e+"="+encodeURIComponent(f)))});return d.filter(p).join("&")}function t(a,b){a||((window.__ATA||{}).config=b.c,m(b.url))}var u=Math.floor(1E13*Math.random()),v=window.__ATA||{};window.__ATA=v;window.__ATA.cmd=v.cmd||[];v.rid=u;v.createdAt=g();var w=window.__ATA||{},x="s.pubmine.com";
		w&&w.serverDomain&&(x=w.serverDomain);var y="//"+x+"/conf",z=window.top===window,A=window.__ATA_PP&&window.__ATA_PP.gdpr_applies,B="boolean"===typeof A?Number(A):null,C=window.__ATA_PP||null,D=z?document.referrer?document.referrer:null:null,E=z?window.location.href:document.referrer?document.referrer:null,F,G=n("__ATA_tuuid");F=G?G:null;var H=window.innerWidth+"x"+window.innerHeight,I=n("usprivacy"),J=r({gdpr:B,pp:C,rid:u,src:D,ref:E,tuuid:F,vp:H,us_privacy:I?I:null},"",".");
		(function(a){var b=void 0===b?"cb":b;l++;var c="callback__"+g().toString(36)+"_"+l.toString(36);a=k(a,b,c);window[c]=function(d){t(void 0,d)};m(a,function(d){d&&t(d)})})(y+"?"+J);}).call(this);
		</script>	<script>
		var sas_fallback = sas_fallback || [];
		sas_fallback.push(
			{ tag: "&lt;div id=&quot;atatags-262211711-{{unique_id}}&quot;&gt;&lt;/div&gt;&lt;script&gt;__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: \'atatags-262211711-{{unique_id}}\',location: 120,formFactor: \'001\',label: {text: \'Advertisements\',},creative: {reportAd: {text: \'Report this ad\',},privacySettings: {text: \'Privacy\',}}});});&lt;/script&gt;", type: 'belowpost' },
			{ tag: "&lt;div id=&quot;atatags-262211711-{{unique_id}}&quot;&gt;&lt;/div&gt;&lt;script&gt;__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: \'atatags-262211711-{{unique_id}}\',location: 310,formFactor: \'001\',label: {text: \'Advertisements\',},creative: {reportAd: {text: \'Report this ad\',},privacySettings: {text: \'Privacy\',}}});});&lt;/script&gt;", type: 'inline' },
			{ tag: "&lt;div id=&quot;atatags-262211711-{{unique_id}}&quot;&gt;&lt;/div&gt;&lt;script&gt;__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: \'atatags-262211711-{{unique_id}}\',location: 140,formFactor: \'003\',label: {text: \'Advertisements\',},creative: {reportAd: {text: \'Report this ad\',},privacySettings: {text: \'Privacy\',}}});});&lt;/script&gt;", type: 'sidebar' },
			{ tag: "&lt;div id=&quot;atatags-262211711-{{unique_id}}&quot;&gt;&lt;/div&gt;&lt;script&gt;__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: \'atatags-262211711-{{unique_id}}\',location: 110,formFactor: \'002\',label: {text: \'Advertisements\',},creative: {reportAd: {text: \'Report this ad\',},privacySettings: {text: \'Privacy\',}}});});&lt;/script&gt;", type: 'top' }
		);
	</script></head>

<body class="wp-singular post-template-default single single-post postid-1419 single-format-standard wp-theme-pubenterprise customizer-styles-applied jetpack-reblog-enabled">
			<div id="atatags-262211712-68265cc207fbc"></div>
			
			<script>
				__ATA.cmd.push(function() {
					__ATA.initDynamicSlot({
						id: 'atatags-262211712-68265cc207fbc',
						location: 110,
						formFactor: '002',
						label: {
							text: 'Advertisements',
						},
						creative: {
							reportAd: {
								text: 'Report this ad',
							},
							privacySettings: {
								text: 'Privacy',
								
							}
						}
					});
				});
			</script>
<div id="header">
	<div class="header-left">
					<h4><a href="https://fabiobaltieri.com/">fabiobaltieri</a></h4>
				<p id="description">Fabio Firmware?</p>
	</div>
	<div class="header-right">
		<form method="get" id="searchform" action="https://fabiobaltieri.com/" >
			<div><label class="hidden" for="s">Search:</label>
			<input type="text" value="" name="s" id="s" />
			<input type="submit" id="searchsubmit" value="Go" /></div>
		</form>
	</div>
</div>
<div id="access">
	<div id="nav">
		<div id="supernav" class="navleft nav">
			<div class="menu"><ul>
<li ><a href="https://fabiobaltieri.com/">Home</a></li><li class="page_item page-item-2"><a href="https://fabiobaltieri.com/about/">About Me</a></li>
</ul></div>
		</div>
		<div class="navright">
			<a class="rsslink" rel="nofollow" href="https://fabiobaltieri.com/feed/">Posts</a>
			<a class="rsslink" rel="nofollow" href="https://fabiobaltieri.com/comments/feed/">Comments</a>
		</div>
	</div>

	<div id="subnav" class="subnav nav">
			<div class="menu">
		<ul>
				<li class="cat-item cat-item-79"><a href="https://fabiobaltieri.com/category/hardware/">Hardware</a>
</li>
	<li class="cat-item cat-item-7426"><a href="https://fabiobaltieri.com/category/networking/">Networking</a>
</li>
	<li class="cat-item cat-item-34922710"><a href="https://fabiobaltieri.com/category/linux-2/">Linux</a>
</li>
	<li class="cat-item cat-item-38819914"><a href="https://fabiobaltieri.com/category/avr-2/">AVR</a>
</li>
		</ul>
	</div>
	</div>
</div>

<div id="wrap">
<div id="content">

	<div id="content-left">

		
			<div id="nav-above">
				<div class="nav-previous"><a href="https://fabiobaltieri.com/2013/07/10/inside-a-hantek-dso-2090-usb-oscilloscope/" rel="prev"><span class="meta-nav">&larr;</span> Inside a Hantek DSO-2090 USB&nbsp;Oscilloscope</a></div>
				<div class="nav-next"><a href="https://fabiobaltieri.com/2013/11/18/halogen-led/" rel="next">LED Light Replacement for AC Halogen&nbsp;Lamps <span class="meta-nav">&rarr;</span></a></div>
			</div>

			<div class="post-1419 post type-post status-publish format-standard hentry category-hardware category-linux-2 category-networking tag-automotive tag-canbus tag-hack tag-linux tag-obd tag-socketcan tag-toyota">

				<div class="entry">

					<h1>Hacking into a Vehicle CAN bus (Toyothack and&nbsp;SocketCAN)</h1>

					<div class="post-info">
						<p>
							<span class="time">2013/07/23</span>
																						<span class="post-comments"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comments">113 Comments</a></span>
																				</p>
					</div>

					<p><a href="http://en.wikipedia.org/wiki/Canbus">CAN bus</a> is an automation fieldbus commonly used in the automotive industry as the main network bus to allow communications between the many on-board ECUs on modern vehicles.</p>
<p>The Linux kernel has native CAN bus support at network layer since some years, with a lot of drivers for both embedded and USB CAN bus controllers, so it&#8217;s now fairly easy to add a CAN bus interface to any Linux laptop and have a playaround with it.</p>
<p>In this post I&#8217;ll show how to tap into a modern car local bus, dump a bunch of data and analyze the trace offline to write a decoder from scratch using the SocketCAN APIs and utilities.</p>
<p>This is based on my experiences hacking into my Toyota&#8230;  Toyothack!</p>
<p><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/"><br />
<img src="https://fabiobaltieri.com/wp-content/uploads/2013/07/toyothack-intro.png?w=630" style="border-width:0;" alt="https://fabiobaltieri.com/wp-content/uploads/2013/07/toyothack-intro.png"><br />
</a></p>
<p><span id="more-1419"></span></p>
<p><strong>CAN bus Network Model</strong></p>
<p>If you are new to field busses, CAN bus may appear weird at first sight.  The bus is physically deployed as a terminated differential twisted pair with a ground reference, and it&#8217;s usually in a trunk-drop topology, where many nodes are connected to a main trunk cable with short drop lines, sometimes using T junctions.  The bus runs up to 1Mbps, and the speed directly influences the max bus length.</p>
<p><img src="https://fabiobaltieri.com/wp-content/uploads/2013/07/toyothack-trunkdrop.png?w=630" alt="https://fabiobaltieri.com/wp-content/uploads/2013/07/toyothack-trunkdrop.png" class="aligncenter"></p>
<p>(Image from Maxim <a href="http://datasheets.maximintegrated.com/en/ds/MAX3051.pdf">MAX3051</a> datasheet)</p>
<p>What is really interesting about CAN bus is the actual usage model: each packet has single address of either 11 or 29 bits (the latter is called extended frame), and a maximum payload of 8 bytes.  The unusual thing is that we think of frame address, not source or destination address, in fact CAN bus nodes does not have an address at all!</p>
<p><img src="https://fabiobaltieri.com/wp-content/uploads/2013/07/toyothack-canframe.png?w=630" alt="https://fabiobaltieri.com/wp-content/uploads/2013/07/toyothack-canframe.png" class="aligncenter"></p>
<p>(Image from Analog Devices <a href="http://www.analog.com/static/imported-files/application_notes/AN-1123.pdf">AN-1123 Application Note</a> datasheet)</p>
<p>The idea behind this is that address are used to identify the type of frame (i.e. what&#8217;s the meaning of the payload), and all nodes on the bus can send and receive any type of frame.  As the bus can have a lot of traffic on it, but most nodes only care about some specific frame IDs and does not have the computational resources to handle the full traffic, each CAN bus controller implements some sort of &#8220;acceptance filter&#8221;, which is usually a bitmask to decide which range of frame addresses should be received by the node, while all the others are discarded silently.</p>
<p>What this means that while the bus is physically a broadcast (all the nodes are connected to the same cable), the protocol makes it work logically as multicast.</p>
<p>This makes the bus very well suitable in automotive and automation environment, where some sensor may put data on the bus that is used by many processors or actuators, and allows to mix nodes with different computing power on the same bus.</p>
<p>At the same time, nothing prohibit the designer to assign some frame addresses for a logically point-to-point communication between two specific nodes, and implement a stream protocol no top of it: in fact that&#8217;s what is done in the standard <a href="http://en.wikipedia.org/wiki/ISO_15765-2">ISO-TP</a> protocol, and there even is a SocketCAN example application to run a full Linux netdevice on top of it.</p>
<p>One additional feature is that the bus is designed so that lower frame addresses have an higher priority when contending for the bus.  This should be kept into account when designing the high level protocol, where often the address is segmented into fields, dedicating an higher portion as a &#8220;priority&#8221; indication.</p>
<p><strong>CAN bus in Automotive</strong></p>
<p>CAN bus was designed for the automotive environment, and that&#8217;s where it&#8217;s still widely deployed.  A modern car have many different ECUs and sensors, and the multicast nature of CAN bus makes it ideal to distribute the data as needed.</p>
<p>Let&#8217;s take vehicle speed as an example, it is transmitted just once on the bus by some wheel sensor, and may be used at the same time by the dashboard, ABS, cruise control, radio/navigation and other devices.</p>
<p>Of course, some data and some nodes are more important than the others, and while CAN bus controller implements some safety features such as error counters to self-disconnect from the bus in case of errors, the bus itself can still suffer from a catastrophic failure, such as a cable short or a cut in the middle.</p>
<p>For this reason, complex cars usually have more than one bus, often running at different speed.  As an example that I found on a FIAT car, one bus is running at a relatively high speed (500kbps) and it&#8217;s wired only on the front of the car connecting critical systems, such as engine control, ABS, power steering and so on.  An additional bus runs at a much lower speed (50kbps), allowing for longer connection segments, and it&#8217;s only used by the non critical equipments, such as dashboard, stereo, electric windows, lights, parking sensors etc.  This one is also wired into the CAN pair of the OBD diagnostic connector, making this easier to tap into.</p>
<p>All vehicle busses are usually connected to a common ECU at some point, which may be used as a proxy to selectively transport some information between busses, while keeping the physical isolation for safety reasons.</p>
<p>How the bus is laid out is specific to each car, so you may want to search for the service manual of a specific model, where you can usually found information on the physical bus topology.  Some really complex installation may also spot additional LIN busses behind CAN bus nodes&#8230;  Do your own research!</p>
<p><strong>On-Board What??</strong></p>
<p>OBD, or On-board Diagnostics, is a set of standards to provide diagnosis and error reporting from the vehicle ECU.</p>
<p>The idea behind OBD is that as modern vehicles rely heavily on electronics and have a many self test capability, a common protocol should allow a service center to read some standard error code to help troubleshooting.  Once an ECU detect some sensor value is out of a &#8220;safe&#8221; range, the system can store an error code and alert the driver by lighting up the well known &#8220;check engine&#8221; yellow light.  At this point, a service center should be able to connect a generic scanner to the vehicle standard OBD port, and that should give a indication of what have failed in the vehicle history.</p>
<p>How&#8217;s that related to CAN bus?  The OBD was originally implemented through some simple vendor-specific protocol, at the point that when the standard OBD-II connector was defined many different busses, including CAN bus, were supported on the same cable, and a generic scanner needed to support all of those and guess which one is used on a specific vehicle (see <a href="http://elmelectronics.com/obdic.html#ELM327">ELM327</a>).</p>
<p>Luckily enough, vehicle regulations become more specific over time, to the point that since 2008, all car sold in the USA are required to implement OBD-II in the CAN bus signaling variant.</p>
<p>This means that in most (possibly all) modern cars, you can find a standard diagnostic connector accessible somewhere near the dashboard, and on this connector you are sure to get access to one of the vehicle CAN bus.</p>
<p>So, what can you expect to find once you tap into that bus with your CAN bus interface?  You can&#8217;t tell until you try, because apart from OBD data (which doesn&#8217;t send anything on it&#8217;s own anyway), the bus can be used by the vendor for anything else: it may be the only bus of the car &#8211; in which case you get <strong>lots</strong> of data &#8211; or it may be dedicated for diagnosis, and in this case you get nothing at all.</p>
<p>If you are reading this just to have some fun and learn more about your car digital guts, you&#8217;ll not find OBD data that interesting, as that&#8217;s mostly diagnostic stuff.  On the other side, if you manage to attach and configure your interface correctly, turn on the ignition and see a flow of data, that means the bus you&#8217;re on is also shared with other vehicle ECUs, and that&#8217;s where the fun begins!</p>
<p>So, to sum up: most modern car have many digital busses, and at least one is a CAN bus and exposed on the standard diagnostics connector.  You can attach a generic interface on it and send access generic OBD data, but if the vendor decided to use that bus for something else, you&#8217;ll also find a stream of vendor-specific frames, with real time sensor and control information, waiting to be reverse engineered.</p>
<p><strong>SocketCAN</strong></p>
<p>On a CAN bus system you have a lot of self-contained microcontroller/DSP based units connected together, each one with its own acceptance filter and possibly injecting some information on the bus, but how does it step-up to be used on a complex operating system?  Enter SocketCAN.</p>
<p><a href="http://en.wikipedia.org/wiki/SocketCAN">SocketCAN</a> is CAN bus stack for the Linux kernel, contributed by a team at Volkswagen Research (well done VW!), and it&#8217;s really ingenious in that it implements CAN bus as a network device, exploiting many existing features of the Linux network stack.</p>
<p>What this means practically is that you are going to see your CAN bus controller as a network device, controlled by the &#8220;ip&#8221; system command.</p>
<p>That&#8217;s an example of how a CAN bus device appears on the system:</p>
<pre># ip link show dev can0
9: can0: &lt;NOARP,UP,LOWER_UP&gt; mtu 16 qdisc noqueue state UNKNOWN mode DEFAULT
    link/can</pre>
<p>From an application point-of-view this great news, as it means that CAN bus is handled by the well know Berkley sockets APIs and you have full software portability: there is no API difference between an USB interface connected to a big workstation or a memory mapped interface on a small ARM SoC.  The main &#8220;trick&#8221; is that when using a socketcan interface, the application actually send and receive a specific can_frame structure, defined as:</p>
<pre class="brush: cpp; title: ; notranslate" title="">
#define CAN_EFF_FLAG 0x80000000U /* EFF/SFF is set in the MSB */
#define CAN_RTR_FLAG 0x40000000U /* remote transmission request */
#define CAN_ERR_FLAG 0x20000000U /* error message frame */

typedef __u32 canid_t;

#define CAN_MAX_DLC 9
#define CAN_MAX_DLEN 8

struct can_frame {
        canid_t can_id;  /* 32 bit CAN_ID + EFF/RTR/ERR flags */
        __u8    can_dlc; /* frame payload length in byte (0 .. CAN_MAX_DLEN) */
        __u8    data[CAN_MAX_DLEN] __attribute__aligned(8);
};
</pre>
<p>At system level, it means that your applications behave like nodes on the bus: they can be attached to a &#8220;virtual&#8221; interface and exchange frames with any other node, without knowing if those are real devices on an external bus or other applications running locally on the same virtual interface.</p>
<p>At a low level, this also means that the interface driver is running with fully open acceptance filter, so the kernel actually receives all the bus data and decides whether or not to send frames to any application depending a higher level software filter, but that&#8217;s usually not a problem as modern Linux enabled SoCs are powerful enough to handle the full traffic anyway.</p>
<p>At this point you may be interested into how to find a list of supported USB-to-CANBUS devices to play with, and that&#8217;s quite easy as all of those are in a <a href="http://lxr.linux.no/#linux+v3.10/drivers/net/can/usb/">dedicated directory in the kernel sources</a>.  Either way, this is a quick list:</p>
<ul>
<li>
ems_usb.c: <a href="http://www.ems-wuensche.com/product/datasheet/html/can-usb-adapter-converter-interface-cpcusb.html">CPC-USB/ARM7 from EMS</a>
</li>
<li>
esd_usb2.c: <a href="http://www.esd-electronics-usa.com/Store/ProductDetails.aspx?itemID=56">CAN-USB/2 and CAN-USB/Micro from ESD</a>
</li>
<li>
kvaser_usb.c: <a href="http://www.kvaser.com/zh/products/can/usb.html">CAN/USB from Kvaser</a>
</li>
<li>
pcan_usb: <a href="http://www.peak-system.com/PCAN-USB.199.0.html?&amp;L=1">PCAN-USB from PEAK System</a>
</li>
<li>
usb_8dev.c: <a href="http://8devices.com/usb2can">USB2CAN from 8 devices</a>
</li>
</ul>
<p>Of all of this, I&#8217;ve only had experiences the EMS one, but that&#8217;s quite expensive and maybe harder to obtain, so the one I would buy right now is the USB2CAN from 8 devices: it&#8217;s cheap, you can get one from the webstore and they provide full schematics and firmware upgrades.  There is also a repository with the actual device source code, but that&#8217;s hardly of any use without the correct programming environment.</p>
<p>As for my setup, I&#8217;m using my own open hardware USB AVR + MCP2515 interface.  You can find the repository for my design <a href="https://github.com/fabiobaltieri/open-usb-can">here</a>, but the performances are not that good above 250kbps, so I&#8217;m planning a complete redesign in the future.</p>
<p><strong>What if I&#8217;m Stuck on Windows?</strong></p>
<p>While I don&#8217;t usually consider this case, I&#8217;ve seen <a href="http://www.canviausb.com/">CANviaUSB</a> used in the development on a critical project and seems to be a great tool. So, if you really can&#8217;t avoid Windows, CANviaUSB is probably the free tool for you (the homepage contains a list of supported device).</p>
<p><strong>Hacking Into the Bus</strong></p>
<p>If you&#8217;ve read all the way through here I hope you&#8217;ve understood that you will have no idea of what&#8217;s attached to the bus until you&#8217;ve analyzed it.  This also means that you don&#8217;t know what can break once you start poking on it, so this may be a good time for a bit of a disclaimer:</p>
<table bgcolor="#ffffee" width="100%" style="margin:.2em 0;">
<tr>
<td style="padding:.5em;">
<p>You shouldn&#8217;t mess with your vehicle bus while it&#8217;s moving unless you are 100% sure of what&#8217;s going on.  The chance of breaking something critical is high and you can hurt someone (possibly yourself) if you mess up.</p>
</td>
</tr>
</table>
<p>The first thing you need other than a laptop and the CAN bus interface is a matching cable for the OBD-II port.  I have an <a href="https://www.sparkfun.com/products/10087">OBD to DE-9</a> cable from SparkFun, but you may also find a suitable one from your CAN bus interface vendor.  As with my interface I used a custom 8P8C based connector, I&#8217;ve actually cut my DE-9 side of the cable and crimped the wires to a standard Ethernet Jack.</p>
<p><img src="https://fabiobaltieri.com/wp-content/uploads/2013/07/toyothack-sfcable.jpg?w=630" alt="https://fabiobaltieri.com/wp-content/uploads/2013/07/toyothack-sfcable.jpg" class="aligncenter"></p>
<p>(Image from <a href="https://www.sparkfun.com/products/10087">Sparkfun</a>)</p>
<p>You should check the cable and interface pinout twice before attaching to the vehicle, as there are many signals on the connector, including a +12V and possibly some vendor specific ones.</p>
<p><img src="https://fabiobaltieri.com/wp-content/uploads/2013/07/toyothack-obdpinout.png?w=630" alt="https://fabiobaltieri.com/wp-content/uploads/2013/07/toyothack-obdpinout.png" class="aligncenter"></p>
<p>(Image from <a href="http://en.wikipedia.org/wiki/File:OBD-connector-pinout.png">Wikipedia</a>)<br />
&#8211; pin 4: chassis ground<br />
&#8211; pin 5: signal ground<br />
&#8211; pin 6: CANH<br />
&#8211; pin 14: CANL<br />
&#8211; pin 16: Battery Voltage</p>
<p>This is the actual connector pinout.  Be sure to connect the CANH, CANL and GND signals.  Shielding and +12V may be useful too but the other lines should be left unconnected.</p>
<p>Next, you should find the connector in the vehicle.  The shape is easy to spot but it may actually be hidden under the dashboard, in an internal fuse box or under the ashtray or some other removable feature.</p>
<p>Don&#8217;t force the connector too much, many of those cheap cables are badly designed and fits too tight, I actually had to  chop off some plastic from mine.</p>
<p>Also, make sure to connect the car while the ignition is OFF for thirty seconds or so &#8211; I found my car transmits data for some time even when everything should be shut off.</p>
<p><strong>Device Configuration and Dumpting the Stream</strong></p>
<p>Time to dump some data, but the interface have to be configured first!</p>
<p>The standard command to configure a CAN bus interface is <code>ip</code>, as in:</p>
<pre># ip link set can0 type can help
Usage: ip link set DEVICE type can
        [ bitrate BITRATE [ sample-point SAMPLE-POINT] ] |
        [ tq TQ prop-seg PROP_SEG phase-seg1 PHASE-SEG1
          phase-seg2 PHASE-SEG2 [ sjw SJW ] ]

        [ loopback { on | off } ]
        [ listen-only { on | off } ]
        [ triple-sampling { on | off } ]
        [ one-shot { on | off } ]
        [ berr-reporting { on | off } ]

        [ restart-ms TIME-MS ]
        [ restart ]

        Where: BITRATE       := { 1..1000000 }
               SAMPLE-POINT  := { 0.000..0.999 }
               TQ            := { NUMBER }
               PROP-SEG      := { 1..8 }
               PHASE-SEG1    := { 1..8 }
               PHASE-SEG2    := { 1..8 }
               SJW           := { 1..4 }
               RESTART-MS    := { 0 | NUMBER }</pre>
<p>Here you need to set the bitrate to match the one used in your target bus.  As you probably don&#8217;t know that before starting, you have to take a guess (or probe it with an oscilloscope).</p>
<p>As CAN bus sends error frames if misconfigured, you most likely want to keep the interface in listen-only mode for all the time, so that other nodes does not notice that something weird is happening.  Just as you know, what may happen if you forget to do so is that something on the bus notices the problem and either display (like in the car stereo) or records the error.</p>
<p>This is how you set the <code>can0</code> interface at 500kbps in listen only mode:</p>
<pre># ip link set can0 type can bitrate 500000 listen-only on</pre>
<p>If there are no errors you can now bring the interface up and start dumping frames:</p>
<pre># ip link set can0 up
# candump -cae can0,0:0,#FFFFFFFF</pre>
<p>At this point, you are receiving everything that is happening on the bus, including errors.  You should try doing something on the car, like closing a door or turning on the ignition.</p>
<p>If your bitrate is wrong, you should receive a stream of errors from the CAN bus interface:</p>
<pre>$ candump -cae can0,0:0,#FFFFFFFF
  can0  20000008  [8] 00 00 04 00 00 00 00 00   ERRORFRAME
        protocol-violation{{bit-stuffing-error}{}}
...</pre>
<p>In this case, bring the interface back down, and try with a different bit-rate.  Most common ones are 500kbps, 250kbps and 50kbps.</p>
<p>If you are lucky, you&#8217;ll eventually find the correct configuration, and get a lot of valid frames from <code>candump</code>:</p>
<pre>balto@balto:~$ candump -cae any,0:0,#FFFFFFFF
  can0  440  [8] 40 00 80 00 00 00 00 00   '@.......'
  can0  442  [8] 42 00 80 00 00 00 00 00   'B.......'
  can0  440  [8] 40 01 80 00 00 00 00 00   '@.......'
  can0  620  [8] 10 80 00 00 00 40 00 80   '.....@..'
  can0  442  [8] 42 01 80 00 00 00 00 00   'B.......'
  can0  440  [8] 42 02 00 00 00 00 00 00   'B.......'
  can0  442  [8] 40 02 00 00 00 00 00 00   '@.......'
  can0  440  [8] 42 02 00 00 00 00 00 00   'B.......'
  can0  620  [8] 10 00 00 00 00 40 00 80   '.....@..'
  can0  442  [8] 40 02 00 00 00 00 00 00   '@.......'
...</pre>
<p>Now that you have the data, this probably looks like noise to you, as that&#8217;s all part of proprietary protocols used by your vehicle ECUs.  If you plan to do some reverse engineering on it, the best thing to do is to record all the data for offline playback, but also to setup a camera in the car to record what&#8217;s happening on the dashboard and on the road.  Be sure to record so that you can easily identify when you started dumping so that the video can be easily synchronized.</p>
<p>This is how to instruct <code>candump</code> to save all the received packets for offline analysis:</p>
<pre>$ candump -l can0,0:0,#FFFFFFFF
Disabled standard output while logging.

Enabling Logfile 'candump-2013-05-06_190603.log'</pre>
<p>This leads to a log file with a series precisely timestamped packet dumps:</p>
<pre>$ head -n5 candump-2013-05-06_190603.log
(1367859965.231495) can0 440#4000800000000000
(1367859965.249499) can0 442#4200800000000000
(1367859965.330495) can0 440#4001800000000000
(1367859965.335500) can0 620#1080000000400080
(1367859965.349499) can0 442#4201800000000000</pre>
<p><strong>Stream Playback on Virtual Device</strong></p>
<p>Now that you have an offline stream, you can replay it on a virtual interface for realtime analysis.</p>
<p>To do that, first create and bring up a new virtual interface with:</p>
<pre># modprobe vcan
# ip link add vcan0 type vcan
# ip link set vcan0 up</pre>
<p>Now you can run <code>canplayer</code> feeding in the original dump, but you also need to specify the mapping between the interface name used when recording and the new one, as in:</p>
<pre>$ canplayer vcan0=can0 &lt; candump-2013-05-06_190603.log</pre>
<p>At this point, if you have a <code>candump</code> instance running on <code>vcan0</code>, you should see packet flowing with the same timings of the original recording.</p>
<p>If you recorded a video stream of the car while dumping, this is a good time to find some way to synchronize it, possibly by cutting the video to the start of dumping.  What I actually did was using the <code>-ss</code> option of <code>mplayer</code> to get it to the right point, and start it simultaneously with <code>candump</code>:</p>
<pre>$ canplayer  &lt; candump-2013-05-06_190603.log &amp; mplayer SMOV0087.AVI -ss 1:17</pre>
<p><strong>Reverse Engineering of CAN bus Frames</strong></p>
<p>Now that you have the packet stream synchronized with a real world image, you can start reverse engineering some frame.  I found that my car only have one bus, and there are as many as 41 different frame types on it.</p>
<p>You should try to use <code>cansniffer</code> to get a first overview of the traffic, but that&#8217;s not really helping much.</p>
<p>What you should do instead is to prepare a basic application to quickly try and decode a frame and focus on one frame at a time.</p>
<p>First, you dump all frames with a specific ID, this is an example for 0x2c4:</p>
<pre>$ candump -cae vcan0,2c4:7ff
  vcan0  2C4  [8] 0A C5 00 18 00 00 92 47   '.......G'
  vcan0  2C4  [8] 0A C8 00 18 00 00 92 4A   '.......J'
  vcan0  2C4  [8] 0A D0 00 18 00 00 92 52   '.......R'
  vcan0  2C4  [8] 0A DC 00 18 00 00 92 5E   '.......^'
  vcan0  2C4  [8] 0A E1 00 18 00 00 92 63   '.......c'
  vcan0  2C4  [8] 0A EB 00 18 00 00 92 6D   '.......m'
  vcan0  2C4  [8] 0A F0 00 18 00 00 92 72   '.......r'
  vcan0  2C4  [8] 0A F2 00 18 00 00 92 74   '.......t'
  vcan0  2C4  [8] 0A F3 00 18 00 00 92 75   '.......u'</pre>
<p>What to look for is how the data is packed up: by looking at the dump changing you should try to guess for each byte if it contains flags or if it&#8217;s part of a signed or unsigned 8, 16 or 32 bits number.  This is easier than it seems, but a bit time consuming.</p>
<p>Once you have that, you can write a data structure to represent the information and print it out in your test application in a readable format, such as:</p>
<pre class="brush: cpp; title: ; notranslate" title="">
struct __packed {
        uint16_t unk0; /* in BE on the bus, use be16toh */
        uint8_t _pad0;
        uint8_t unk1;
        uint8_t _pad1;
        uint8_t _pad2;
        uint8_t unk2;
        int8_t unk3;
} test;

...

mvprintw(1, 1, &quot;test: unk0=%5hd unk1=%3d unk2=%3d, unk3=%3hhd&quot;,
        be16toh(toy-&gt;test.unk0),
        toy-&gt;test.unk1,
        toy-&gt;test.unk2,
        toy-&gt;test.unk3);
</pre>
<p>If you look at the numbers changing in realtime with the video, you may now be able to make some sense out of those: in this case it turns out that the first number is the actual RPM of the engine, so the structure can be modified into:</p>
<pre class="brush: cpp; title: ; notranslate" title="">
struct __packed {
        uint16_t rpm;
        uint8_t _pad0;
        uint8_t unk0;
        uint8_t _pad1;
        uint8_t _pad2;
        uint8_t unk1;
        int8_t unk2;
} engine;

...

mvprintw(1, 1, &quot;engine: rpm=%5hd unk0=%3d unk1=%3d, unk2=%3hhd&quot;,
                be16toh(toy-&gt;engine.rpm),
                toy-&gt;engine.unk0,
                toy-&gt;engine.unk1,
                toy-&gt;engine.unk2);
</pre>
<p>Now that you know that the frame contains engine information, you can assume that other fields of the same frame are somehow related, as those come from the same ECU.</p>
<p>In my case I was able to identify some data such as throttle position, speed, rpm, mileage counters and the speed of individual wheels.  I wrote a simple application to open the CAN bus interface, read the frames and decode the supported ones.  You can use it as a base to write your own packet decoders, it&#8217;s easy to hack, ncurses based and gives a list of unknown packets&#8230; Grab it on <a href="http://github.com/fabiobaltieri/toyothack">GitHub</a>!</p>
<p><a href="http://github.com/fabiobaltieri/toyothack"><br />
<img src="https://fabiobaltieri.com/wp-content/uploads/2011/08/github_button.png?w=630" style="border-width:0;" alt="GitHub"><br />
</a></p>
<p>Finally, this is a video of what the final result looks like:</p>
<span class="embed-youtube" style="text-align:center; display: block;"><iframe class="youtube-player" width="630" height="355" src="https://www.youtube.com/embed/KHRPmjwXF1U?version=3&#038;rel=1&#038;showsearch=0&#038;showinfo=1&#038;iv_load_policy=1&#038;fs=1&#038;hl=en&#038;autohide=2&#038;wmode=transparent" allowfullscreen="true" style="border:0;" sandbox="allow-scripts allow-same-origin allow-popups allow-presentation allow-popups-to-escape-sandbox"></iframe></span>
<span id="wordads-inline-marker" style="display: none;"></span><div id="atatags-262211715-68265cc20ab57">
		<script type="text/javascript">
			__ATA.cmd.push(function() {
				__ATA.initVideoSlot('atatags-262211715-68265cc20ab57', {
					sectionId: '262211715',
					format: 'inread'
				});
			});
		</script>
	</div>			<div id="atatags-262211711-68265cc20ad22"></div>
			
			<script>
				__ATA.cmd.push(function() {
					__ATA.initDynamicSlot({
						id: 'atatags-262211711-68265cc20ad22',
						location: 120,
						formFactor: '001',
						label: {
							text: 'Advertisements',
						},
						creative: {
							reportAd: {
								text: 'Report this ad',
							},
							privacySettings: {
								text: 'Privacy',
								
							}
						}
					});
				});
			</script><div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer"
				data-shared="sharing-twitter-1419"
				class="share-twitter sd-button share-icon no-text"
				href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?share=twitter"
				target="_blank"
				aria-labelledby="sharing-twitter-1419"
				>
				<span id="sharing-twitter-1419" hidden>Click to share on X (Opens in new window)</span>
				<span>X</span>
			</a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer"
				data-shared="sharing-facebook-1419"
				class="share-facebook sd-button share-icon no-text"
				href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?share=facebook"
				target="_blank"
				aria-labelledby="sharing-facebook-1419"
				>
				<span id="sharing-facebook-1419" hidden>Click to share on Facebook (Opens in new window)</span>
				<span>Facebook</span>
			</a></li><li class="share-end"></li></ul></div></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-26221171-1419-68265cc20b33b' data-src='//widgets.wp.com/likes/index.html?ver=20250515#blog_id=26221171&amp;post_id=1419&amp;origin=fabiobaltieri.wordpress.com&amp;obj_id=26221171-1419-68265cc20b33b&amp;domain=fabiobaltieri.com' data-name='like-post-frame-26221171-1419-68265cc20b33b' data-title='Like or Reblog'><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height: 55px;'><span class='button'><span>Like</span></span> <span class='loading'>Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div></div><div class="clear"></div>
					
					<!--
					<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/"
    dc:identifier="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/"
    dc:title="Hacking into a Vehicle CAN bus (Toyothack and&nbsp;SocketCAN)"
    trackback:ping="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/trackback/" />
</rdf:RDF>					-->

				</div>

				<div class="post-meta">
					<p>
						<span class="categories">Filed under <a href="https://fabiobaltieri.com/category/hardware/" rel="category tag">Hardware</a>, <a href="https://fabiobaltieri.com/category/linux-2/" rel="category tag">Linux</a>, <a href="https://fabiobaltieri.com/category/networking/" rel="category tag">Networking</a></span>
						<span class="tags">Tagged with <a href="https://fabiobaltieri.com/tag/automotive/" rel="tag">automotive</a>, <a href="https://fabiobaltieri.com/tag/canbus/" rel="tag">canbus</a>, <a href="https://fabiobaltieri.com/tag/hack/" rel="tag">hack</a>, <a href="https://fabiobaltieri.com/tag/linux/" rel="tag">linux</a>, <a href="https://fabiobaltieri.com/tag/obd/" rel="tag">obd</a>, <a href="https://fabiobaltieri.com/tag/socketcan/" rel="tag">socketcan</a>, <a href="https://fabiobaltieri.com/tag/toyota/" rel="tag">Toyota</a></span>					</p>
				</div>

			</div>

			
						<p></p>

			<div id="comments">
	

	<h3 id="comments-title">113 Responses to <em>Hacking into a Vehicle CAN bus (Toyothack and&nbsp;SocketCAN)</em>	</h3>

	<ol class="commentlist snap_preview">
			<li class="comment even thread-even depth-1" id="li-comment-688">
		<div id="comment-688">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='ildiopantofola&#039;s avatar' src='https://2.gravatar.com/avatar/83516818ffae5e8288a8137c4faa85d4865f16a059144e7567b89c1aaba0d00b?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/83516818ffae5e8288a8137c4faa85d4865f16a059144e7567b89c1aaba0d00b?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/83516818ffae5e8288a8137c4faa85d4865f16a059144e7567b89c1aaba0d00b?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/83516818ffae5e8288a8137c4faa85d4865f16a059144e7567b89c1aaba0d00b?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/83516818ffae5e8288a8137c4faa85d4865f16a059144e7567b89c1aaba0d00b?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/83516818ffae5e8288a8137c4faa85d4865f16a059144e7567b89c1aaba0d00b?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://gravatar.com/ildiopantofola" class="url" rel="ugc external nofollow">ildiopantofola</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-688">2013/07/23 at 16:09</a></div>

		<div class="comment-body"><p>Love it!!! *___*</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=688#respond" data-commentid="688" data-postid="1419" data-belowelement="comment-688" data-respondelement="respond" data-replyto="Reply to ildiopantofola" aria-label="Reply to ildiopantofola">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-811">
		<div id="comment-811">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Daniel&#039;s avatar' src='https://2.gravatar.com/avatar/2226c2816c6eb52f52a630a0cbdee5629237dede9188d9d11e1a1702a42c0375?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/2226c2816c6eb52f52a630a0cbdee5629237dede9188d9d11e1a1702a42c0375?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/2226c2816c6eb52f52a630a0cbdee5629237dede9188d9d11e1a1702a42c0375?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/2226c2816c6eb52f52a630a0cbdee5629237dede9188d9d11e1a1702a42c0375?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/2226c2816c6eb52f52a630a0cbdee5629237dede9188d9d11e1a1702a42c0375?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/2226c2816c6eb52f52a630a0cbdee5629237dede9188d9d11e1a1702a42c0375?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">Daniel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-811">2013/09/20 at 16:23</a></div>

		<div class="comment-body"><p>Great job, I really admire all your projects, ideas and, of course, skills.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=811#respond" data-commentid="811" data-postid="1419" data-belowelement="comment-811" data-respondelement="respond" data-replyto="Reply to Daniel" aria-label="Reply to Daniel">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-812">
		<div id="comment-812">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-812">2013/09/20 at 17:01</a></div>

		<div class="comment-body"><p>Thanks Daniel!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=812#respond" data-commentid="812" data-postid="1419" data-belowelement="comment-812" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1" id="li-comment-902">
		<div id="comment-902">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='mangodan2003&#039;s avatar' src='https://0.gravatar.com/avatar/c3baf8b7b437375d58d7c01c05c0bc971055725eacb40be4e530c8606aa71d8d?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/c3baf8b7b437375d58d7c01c05c0bc971055725eacb40be4e530c8606aa71d8d?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/c3baf8b7b437375d58d7c01c05c0bc971055725eacb40be4e530c8606aa71d8d?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/c3baf8b7b437375d58d7c01c05c0bc971055725eacb40be4e530c8606aa71d8d?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/c3baf8b7b437375d58d7c01c05c0bc971055725eacb40be4e530c8606aa71d8d?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/c3baf8b7b437375d58d7c01c05c0bc971055725eacb40be4e530c8606aa71d8d?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://gravatar.com/mangodan2003" class="url" rel="ugc external nofollow">mangodan2003</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-902">2013/11/08 at 13:42</a></div>

		<div class="comment-body"><p>Hi there, great writeup! I am very interested in your open-usb-can project.</p>
<p>I have different hardware, an STM32f4 with 2 can controllers, I plan to eventually use both by making my firmware present 2 USB interface descriptors .</p>
<p>For now I have been coding firmware in the hope that I can just use your kernel module, by making my hardware appear to be the same as yours from the host&#8217;s point of view.</p>
<p>I have got the device/interface/endpoint descriptors working, and can set the hw config, and start the interface. But I cannot figure out how you start the data flow. The urb&#8217;s callbacks in the kernel module do not seem to ever be called.</p>
<p>I can make data go out, for a short while using cangen, but never get anything back in.</p>
<p>I can see in the ep0.c control values that do not seem to ever be sent by the driver. But which appear to be needed to start the data flow.</p>
<p>ATUSB_SPI_WRITE1/ATUSB_SPI_WRITE2<br />
and<br />
ATUSB_SPI_READ1/ATUSB_SPI_READ2</p>
<p>The Write one seems to be the only place the ep in callback gets set.</p>
<p>Am I missing something?</p>
<p>Are these parts of the code actually used?</p>
<p>Thanks in advance, Dan</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=902#respond" data-commentid="902" data-postid="1419" data-belowelement="comment-902" data-respondelement="respond" data-replyto="Reply to mangodan2003" aria-label="Reply to mangodan2003">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-906">
		<div id="comment-906">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-906">2013/11/08 at 20:18</a></div>

		<div class="comment-body"><p>Hi Dan!</p>
<p>I was actually in the process of redesigning my open-usb-can with an STM32F103, as I abandoned the AVR based design for performance reasons, but then I stalled the project to work on other stuff&#8230;</p>
<p>Anyway, I&#8217;m happy that you&#8217;re using my kernel module as a base! That&#8217;s actually quite simple because the firmware uses socketcan compatible data structures and you can easily do the same.  You may also be interested into a discussion on the linux-can list about USB-CAN protocols (<a href="http://article.gmane.org/gmane.linux.can/2004" rel="nofollow ugc">http://article.gmane.org/gmane.linux.can/2004</a>) and maybe even join the list!</p>
<p>The firmware code is actually based on the ATUSB Ben-WPAN project (<a href="http://en.qi-hardware.com/wiki/Ben_WPAN" rel="nofollow ugc">http://en.qi-hardware.com/wiki/Ben_WPAN</a>) so you may find some debugging/helper code still there and not used by the kernel module, and that&#8217;s the case for the ATUSB_SPI_* calls &#8211; the AVR to CAN controller SPI data is not exposed on the USB side for normal operation.</p>
<p>As for the data flow, the stuff you find in ep0.c is only for the control endpoint (&amp;eps[0]), and that&#8217;s used only for device configuration/start/stop.  The actual bulk traffic is handled in buffer.c, where you can find references to usb_send(&amp;eps[2], &#8230;) and usb_recv[&amp;eps[1], &#8230;).  Those two maps to the two kernel queues: usb_sndbulkpipe(dev-&gt;udev, 1) and usb_rcvbulkpipe(dev-&gt;udev, 2) and relative callbacks.</p>
<p>There may be a *ton* of reasons why your traffic doesn&#8217;t go trough, and you may want to double check your descriptors and the hardware USB controller configuration on the STM32, especially for the endpoint sizes.</p>
<p>In this situation I would search for an working example project to run on the STM32 that uses bulk endpoint and adapt it to your configuration until you find what breaks.  On the Linux side you can use the usbmon module to see the raw traffic.  Also, one of my favorite utilities for hacking on USB is the usbtool application from the v-usb package, you can find it here <a href="https://github.com/obdev/v-usb" rel="nofollow ugc">https://github.com/obdev/v-usb</a> hidden into the examples/usbtool directory.  It allows you send and receive arbitrary USB traffic, it uses libusb internally.  If you use that just keep in mind that it doesn&#8217;t flip between the DATA0/1 packet id, so it will actually work only for the first packet&#8230; but that&#8217;s often enough! :-)</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=906#respond" data-commentid="906" data-postid="1419" data-belowelement="comment-906" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-mangodan2003 odd alt depth-3" id="li-comment-907">
		<div id="comment-907">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='mangodan2003&#039;s avatar' src='https://0.gravatar.com/avatar/c3baf8b7b437375d58d7c01c05c0bc971055725eacb40be4e530c8606aa71d8d?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/c3baf8b7b437375d58d7c01c05c0bc971055725eacb40be4e530c8606aa71d8d?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/c3baf8b7b437375d58d7c01c05c0bc971055725eacb40be4e530c8606aa71d8d?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/c3baf8b7b437375d58d7c01c05c0bc971055725eacb40be4e530c8606aa71d8d?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/c3baf8b7b437375d58d7c01c05c0bc971055725eacb40be4e530c8606aa71d8d?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/c3baf8b7b437375d58d7c01c05c0bc971055725eacb40be4e530c8606aa71d8d?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">mangodan2003</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-907">2013/11/09 at 11:19</a></div>

		<div class="comment-body"><p>Thankyou for such an in depth reply.</p>
<p>I have managed to get data flowing to the host, it was something to do with the FIFO buffer settings, I do not fully understand how these are allocated and used at present so need to investigate.<br />
I had based my CAN vender specific driver on the stm cdc example class, removing the command endpoint so I just have the control endpoint and two bulk end points as you do, but had over looked the FIFO settings.<br />
I have used lsusb with -v option to confirm the descriptors are all correct.</p>
<p>Although data flows to the host it is presently  split in to tiny packets, I am only sending 17 bytes and it seems to send this as 12 bytes followed by the remaining 5 bytes.My wxPacket sizes for both the in and out Endpoint are set way higher than this, 64 and 32 bytes. So I have some work todo to find out why this is happening, but once resolved I am nearly there :).</p>
<p>I have been using usbmon module  with wireshark, and also a libusb test program adapted from something else I found online. I will investigate the other things you suggested.</p>
<p>Thanks again </p>
<p>Dan</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even depth-2" id="li-comment-1177">
		<div id="comment-1177">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='ZeroAviation&#039;s avatar' src='https://0.gravatar.com/avatar/336c83cbd3a5ee1efd09b58b72f026c6f21bdd9eb6685222c5451214275aa4de?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/336c83cbd3a5ee1efd09b58b72f026c6f21bdd9eb6685222c5451214275aa4de?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/336c83cbd3a5ee1efd09b58b72f026c6f21bdd9eb6685222c5451214275aa4de?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/336c83cbd3a5ee1efd09b58b72f026c6f21bdd9eb6685222c5451214275aa4de?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/336c83cbd3a5ee1efd09b58b72f026c6f21bdd9eb6685222c5451214275aa4de?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/336c83cbd3a5ee1efd09b58b72f026c6f21bdd9eb6685222c5451214275aa4de?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">ZeroAviation</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-1177">2014/02/03 at 18:07</a></div>

		<div class="comment-body"><p>What kind of FIFO settings were you missing? I&#8217;m facing a similar problem.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=1177#respond" data-commentid="1177" data-postid="1419" data-belowelement="comment-1177" data-respondelement="respond" data-replyto="Reply to ZeroAviation" aria-label="Reply to ZeroAviation">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-915">
		<div id="comment-915">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Arnold&#039;s avatar' src='https://0.gravatar.com/avatar/65ca04aa9bb890ab84ba8f276ece33330060ac6c40cfabdc0b45f46cab083d23?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/65ca04aa9bb890ab84ba8f276ece33330060ac6c40cfabdc0b45f46cab083d23?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/65ca04aa9bb890ab84ba8f276ece33330060ac6c40cfabdc0b45f46cab083d23?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/65ca04aa9bb890ab84ba8f276ece33330060ac6c40cfabdc0b45f46cab083d23?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/65ca04aa9bb890ab84ba8f276ece33330060ac6c40cfabdc0b45f46cab083d23?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/65ca04aa9bb890ab84ba8f276ece33330060ac6c40cfabdc0b45f46cab083d23?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">Arnold</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-915">2013/11/12 at 17:16</a></div>

		<div class="comment-body"><p>Hello.</p>
<p>Question: Can all cars engine be started by the OBD-2 Conector using CAN bus protocol?</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=915#respond" data-commentid="915" data-postid="1419" data-belowelement="comment-915" data-respondelement="respond" data-replyto="Reply to Arnold" aria-label="Reply to Arnold">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-917">
		<div id="comment-917">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-917">2013/11/12 at 20:42</a></div>

		<div class="comment-body"><p>Hi Arnold, I think quite the opposite: *maybe* some car can be started with some can packet! Most cars probably still have a dedicated ignition circuit, and that&#8217;s even without accounting for some key authentication, immobilizer etc&#8230; :)</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=917#respond" data-commentid="917" data-postid="1419" data-belowelement="comment-917" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1" id="li-comment-947">
		<div id="comment-947">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Sam Crooks&#039;s avatar' src='https://1.gravatar.com/avatar/7b993656d4c9cda83ddce9bfb5610b721696ff0e7c18d8928395318082588e06?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/7b993656d4c9cda83ddce9bfb5610b721696ff0e7c18d8928395318082588e06?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/7b993656d4c9cda83ddce9bfb5610b721696ff0e7c18d8928395318082588e06?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/7b993656d4c9cda83ddce9bfb5610b721696ff0e7c18d8928395318082588e06?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/7b993656d4c9cda83ddce9bfb5610b721696ff0e7c18d8928395318082588e06?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/7b993656d4c9cda83ddce9bfb5610b721696ff0e7c18d8928395318082588e06?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">Sam Crooks</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-947">2013/11/23 at 21:52</a></div>

		<div class="comment-body"><p>Fabio:</p>
<p>You might consider using a Beagle Bone Black with a CAN cape.  You can then directly wire into the CAN networks in the car permanently (all of them) and dump continuously, automate data collection, and also not block the OBD-II port&#8230; Useful if you want to sniff out what dealer diagnostic tools are sending on the network, or ECU flash programmers.  See my website for my project notes on taking this approach</p>
<p><a href="http://the8thlayerof.net" rel="nofollow ugc">http://the8thlayerof.net</a></p>
<p>Sam</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=947#respond" data-commentid="947" data-postid="1419" data-belowelement="comment-947" data-respondelement="respond" data-replyto="Reply to Sam Crooks" aria-label="Reply to Sam Crooks">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-948">
		<div id="comment-948">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-948">2013/11/23 at 22:15</a></div>

		<div class="comment-body"><p>Sure thing!  The BBB is a great board for this kind of hacks and has a very capable CPU and a good design in general as you would expect from TI.</p>
<p>I actually worked in the past with the standard BB and with the AM335x CPU in general, and I still think that it&#8217;s one of the best general purpose board/CPU available.</p>
<p>Thanks for the link! :-)</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=948#respond" data-commentid="948" data-postid="1419" data-belowelement="comment-948" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-1054">
		<div id="comment-1054">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Chad Gibbons&#039;s avatar' src='https://1.gravatar.com/avatar/a0e262ead57e6652559c577e46daf29bce8c99d4455676d22bca56b768b44492?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/a0e262ead57e6652559c577e46daf29bce8c99d4455676d22bca56b768b44492?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/a0e262ead57e6652559c577e46daf29bce8c99d4455676d22bca56b768b44492?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/a0e262ead57e6652559c577e46daf29bce8c99d4455676d22bca56b768b44492?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/a0e262ead57e6652559c577e46daf29bce8c99d4455676d22bca56b768b44492?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/a0e262ead57e6652559c577e46daf29bce8c99d4455676d22bca56b768b44492?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://gravatar.com/dcgibbons" class="url" rel="ugc external nofollow">Chad Gibbons</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-1054">2013/12/30 at 00:29</a></div>

		<div class="comment-body"><p>Great post and information. You inspired me to do something similar to my Jeep and the results re here: <a href="http://chadgibbons.com/2013/12/29/hacking-the-jeep-interior-can-bus/" rel="nofollow ugc">http://chadgibbons.com/2013/12/29/hacking-the-jeep-interior-can-bus/</a></p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=1054#respond" data-commentid="1054" data-postid="1419" data-belowelement="comment-1054" data-respondelement="respond" data-replyto="Reply to Chad Gibbons" aria-label="Reply to Chad Gibbons">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-1055">
		<div id="comment-1055">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-1055">2013/12/30 at 00:47</a></div>

		<div class="comment-body"><p>Thanks&#8230; and nice job on your Wrangler! :-)</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=1055#respond" data-commentid="1055" data-postid="1419" data-belowelement="comment-1055" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1" id="li-comment-1156">
		<div id="comment-1156">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='javad&#039;s avatar' src='https://2.gravatar.com/avatar/e33e1a625f5dd38965b44cd38839b02e7cc728bdec73f9377894718ab8703f70?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/e33e1a625f5dd38965b44cd38839b02e7cc728bdec73f9377894718ab8703f70?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/e33e1a625f5dd38965b44cd38839b02e7cc728bdec73f9377894718ab8703f70?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/e33e1a625f5dd38965b44cd38839b02e7cc728bdec73f9377894718ab8703f70?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/e33e1a625f5dd38965b44cd38839b02e7cc728bdec73f9377894718ab8703f70?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/e33e1a625f5dd38965b44cd38839b02e7cc728bdec73f9377894718ab8703f70?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">javad</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-1156">2014/02/02 at 10:57</a></div>

		<div class="comment-body"><p>hi fabio<br />
I want send and recieve can data, but when this command &#8221; ip link set can0 type can&#8221; is ok but when I run this command &#8220;ip set link can0 type can listen-onl on&#8221; , operatiopn nor supporeted :-(<br />
 can you help me?</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=1156#respond" data-commentid="1156" data-postid="1419" data-belowelement="comment-1156" data-respondelement="respond" data-replyto="Reply to javad" aria-label="Reply to javad">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-1161">
		<div id="comment-1161">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-1161">2014/02/02 at 16:03</a></div>

		<div class="comment-body"><p>Hi, looks like the device you are using does not support listen-only mode.  That&#8217;s implemented in the driver so you need an updated version or to do your own implementation.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=1161#respond" data-commentid="1161" data-postid="1419" data-belowelement="comment-1161" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-1493">
		<div id="comment-1493">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Sarthak&#039;s avatar' src='https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">Sarthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-1493">2014/02/21 at 11:47</a></div>

		<div class="comment-body"><p>Hey Fabio,</p>
<p>How you doing? The work you have done is fantastic and exciting. Actually, I am trying to get access to the CAN packets transferred among different ECUs. I am not sure what hardware you are exactly using. From the blog, I guess that you are using an OBD to DB9 cable, a laptop but what to connect the laptop and cable. Is it RJ45 port of the laptop you are using ? Please help !!<br />
Thank you !!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=1493#respond" data-commentid="1493" data-postid="1419" data-belowelement="comment-1493" data-respondelement="respond" data-replyto="Reply to Sarthak" aria-label="Reply to Sarthak">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-1519">
		<div id="comment-1519">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-1519">2014/02/22 at 21:09</a></div>

		<div class="comment-body"><p>Hi Sarthak, that&#8217;s explained in the post, my specific setup is a laptop, a custom usb-to-canbus interface and a modified OBD cable that fits my CAN interface (which happens to have an 8P8C connector but of course is not Ethernet).  The software part is just the socketcan and my test application.</p>
<p>You need to grab a CAN interface of some kind (USB are common nowadays) and an OBD cable, and modify the cable to fit the CAN interface pinout.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=1519#respond" data-commentid="1519" data-postid="1419" data-belowelement="comment-1519" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1" id="li-comment-1536">
		<div id="comment-1536">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Sarthak&#039;s avatar' src='https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">Sarthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-1536">2014/02/24 at 14:20</a></div>

		<div class="comment-body"><p>Yes, I am using an OBD-II UART board, FTDI Basic, Laptop and a standard OBD to DB9 cable. But I am not able to figure out that when I will connect the USB port to the laptop, then how will I link the USB port i.e.COM1(for ex) with the the commands you mentioned in your blog to start the  session. Please suggest.</p>
<p>Thank You !</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=1536#respond" data-commentid="1536" data-postid="1419" data-belowelement="comment-1536" data-respondelement="respond" data-replyto="Reply to Sarthak" aria-label="Reply to Sarthak">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-1549">
		<div id="comment-1549">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-1549">2014/02/24 at 23:10</a></div>

		<div class="comment-body"><p>I think you have an ELM327 based board, that&#8217;s actualy designed to handle the OBD protocol on-chip and communicate with the host PC using AT commands.  I think that some version is able to inject raw CAN frames, but AFAIK it does not work with SocketCAN, so it&#8217;s totally a different thing from what I cover in the post.</p>
<p>If you are looking into OBD you should search for some ELM327 specific tutorial, but if you are interested into raw CAN stuff and socketcan you should get a different CAN interface.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=1549#respond" data-commentid="1549" data-postid="1419" data-belowelement="comment-1549" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-2525">
		<div id="comment-2525">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Yousef&#039;s avatar' src='https://2.gravatar.com/avatar/e33e1a625f5dd38965b44cd38839b02e7cc728bdec73f9377894718ab8703f70?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/e33e1a625f5dd38965b44cd38839b02e7cc728bdec73f9377894718ab8703f70?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/e33e1a625f5dd38965b44cd38839b02e7cc728bdec73f9377894718ab8703f70?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/e33e1a625f5dd38965b44cd38839b02e7cc728bdec73f9377894718ab8703f70?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/e33e1a625f5dd38965b44cd38839b02e7cc728bdec73f9377894718ab8703f70?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/e33e1a625f5dd38965b44cd38839b02e7cc728bdec73f9377894718ab8703f70?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">Yousef</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-2525">2014/04/05 at 14:41</a></div>

		<div class="comment-body"><p>Hi Fabio<br />
I work with &#8220;PEAK-SYSTEM- CAN card &#8221; , I can connect two can interface, I generate CAN data in one can interface and dump can data in other inteface.<br />
 but I want reverse engineering on PLD engine controller and dump can data in this  controller. you can find specific of this controller in this link<br />
 (<a href="http://www.scribd.com/doc/57350358/PLD-Manual-MERCEDES-INJECTORS-FUEL-SYSTEM" rel="nofollow ugc">http://www.scribd.com/doc/57350358/PLD-Manual-MERCEDES-INJECTORS-FUEL-SYSTEM</a>)<br />
   but I can not receive any data with my interface! however I can connect it with  car diagnostic and receive CAN data! I try to determine output  signal with oscilloscope and saw voltage level of this controller are 9 V &amp; 12 V for CAN-H and CAN-L . but in my interface output level are -1.5 and +1.5 V . if I can connect this controller with my interface ?  how I should connect this controller physically? if I should run specific command for connect and dump CAN data without &#8220;candump can0&#8221;? please help me :-)<br />
thanks a lot.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=2525#respond" data-commentid="2525" data-postid="1419" data-belowelement="comment-2525" data-respondelement="respond" data-replyto="Reply to Yousef" aria-label="Reply to Yousef">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-2564">
		<div id="comment-2564">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-2564">2014/04/07 at 19:15</a></div>

		<div class="comment-body"><p>Hi Yousef,</p>
<p>there are many things you should check to troubleshoot the problem: first make sure that you are able to display error messages from the CAN interface (candump has some specific flags), then it may be possible that the bus you are using generates data only when triggered (check for activity with the scope). It may be useful for you to build a split cable to connect the diagnostic tool and your CAN interface at the same time, so that you can check if you receive the same data from both.</p>
<p>For the voltage level, is actually quite high and may be saturating the transceiver.  You should check which transceiver p/n is used in your CAN interface, and make sure it works with common mode voltage as high as ~10V.  Ideally you would also use an isolated interface (if you are on a laptop using it from the battery may be enough).</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=2564#respond" data-commentid="2564" data-postid="1419" data-belowelement="comment-2564" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment odd alt depth-3" id="li-comment-3217">
		<div id="comment-3217">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Yousef&#039;s avatar' src='https://2.gravatar.com/avatar/e33e1a625f5dd38965b44cd38839b02e7cc728bdec73f9377894718ab8703f70?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/e33e1a625f5dd38965b44cd38839b02e7cc728bdec73f9377894718ab8703f70?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/e33e1a625f5dd38965b44cd38839b02e7cc728bdec73f9377894718ab8703f70?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/e33e1a625f5dd38965b44cd38839b02e7cc728bdec73f9377894718ab8703f70?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/e33e1a625f5dd38965b44cd38839b02e7cc728bdec73f9377894718ab8703f70?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/e33e1a625f5dd38965b44cd38839b02e7cc728bdec73f9377894718ab8703f70?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">Yousef</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-3217">2014/04/29 at 08:20</a></div>

		<div class="comment-body"><p>Hi Fabio<br />
thanks a lot for you answers. I want connect to Mercedes Benz BUS and read CAN data from diagnostic connector. In your opinion are there difference between  CAN bus configuration of Buses and cars? can I receive CAN data similar way ?<br />
thanks a lot.<br />
Yousef</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="li-comment-2630">
		<div id="comment-2630">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='jon&#039;s avatar' src='https://1.gravatar.com/avatar/4df9cdc27936105cd698141ff009c5d70cb6b29baecdc87fd76a3a1ebad7dbfb?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/4df9cdc27936105cd698141ff009c5d70cb6b29baecdc87fd76a3a1ebad7dbfb?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/4df9cdc27936105cd698141ff009c5d70cb6b29baecdc87fd76a3a1ebad7dbfb?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/4df9cdc27936105cd698141ff009c5d70cb6b29baecdc87fd76a3a1ebad7dbfb?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/4df9cdc27936105cd698141ff009c5d70cb6b29baecdc87fd76a3a1ebad7dbfb?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/4df9cdc27936105cd698141ff009c5d70cb6b29baecdc87fd76a3a1ebad7dbfb?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">jon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-2630">2014/04/09 at 23:49</a></div>

		<div class="comment-body"><p>How could I control the climate in my Lexus Lx470? I am a beginner with Can-bus and not sure where to begin.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=2630#respond" data-commentid="2630" data-postid="1419" data-belowelement="comment-2630" data-respondelement="respond" data-replyto="Reply to jon" aria-label="Reply to jon">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2" id="li-comment-2631">
		<div id="comment-2631">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-2631">2014/04/10 at 00:06</a></div>

		<div class="comment-body"><p>Well, that&#8217;s a long shot, I would not suggest you to wire up stuff to your car unless you know what your are doing. :-)</p>
<p>That said, it&#8217;s hard to say, if you can equip with the proper tools you would have to find the correct bus, decode some control data and &#8211; if the protocol design allows &#8211; try to reinject it to control what you need.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=2631#respond" data-commentid="2631" data-postid="1419" data-belowelement="comment-2631" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1" id="li-comment-4179">
		<div id="comment-4179">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='marius&#039;s avatar' src='https://0.gravatar.com/avatar/9a85823f2a021587d14ea25092d01f5e48562627a11aba9575c32a21232203bf?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/9a85823f2a021587d14ea25092d01f5e48562627a11aba9575c32a21232203bf?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/9a85823f2a021587d14ea25092d01f5e48562627a11aba9575c32a21232203bf?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/9a85823f2a021587d14ea25092d01f5e48562627a11aba9575c32a21232203bf?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/9a85823f2a021587d14ea25092d01f5e48562627a11aba9575c32a21232203bf?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/9a85823f2a021587d14ea25092d01f5e48562627a11aba9575c32a21232203bf?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">marius</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-4179">2014/05/29 at 06:57</a></div>

		<div class="comment-body"><p>Firstly, what a great post.  Thanks very much!  I have quite a bit of experience with CAN, and always get the question how to read fuel consumption from many different manufacturer&#8217;s CAN bus.  Yet, this signal is very difficult to reverse-engineer, I find, because many other signals (engine torque for example) look very similar.  I see you have fuel usage identified on the toyota.  How could you be sure it is the right signal? Any tips will be greatly appreciated! :-)  Again, thanks very much for an excellent article.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=4179#respond" data-commentid="4179" data-postid="1419" data-belowelement="comment-4179" data-respondelement="respond" data-replyto="Reply to marius" aria-label="Reply to marius">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2" id="li-comment-4224">
		<div id="comment-4224">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-4224">2014/05/30 at 15:55</a></div>

		<div class="comment-body"><p>Hello Marius!</p>
<p>Thanks for the comment, I agree that most of this is very hard to reverse engineer&#8230; Even after you isolated some counter, everything spins up as soon as you rev up the engine! :-)</p>
<p>For the fuel consumption I&#8217;m afraid I found a hint on some other website for similar projects on other Toyotas, and the value seems to change together with the instant consumption on the dashboard. My first idea would be to try to see if the those two updates together but if that doesn&#8217;t work I guess you should compare with some other car diagnostic tool.</p>
<p>Cheers!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=4224#respond" data-commentid="4224" data-postid="1419" data-belowelement="comment-4224" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-entropy512 even depth-3" id="li-comment-19597">
		<div id="comment-19597">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='entropy512&#039;s avatar' src='https://2.gravatar.com/avatar/27c260a860f0255b188d40468217ad650f33e12d3a19aeb7321563a364b27894?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/27c260a860f0255b188d40468217ad650f33e12d3a19aeb7321563a364b27894?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/27c260a860f0255b188d40468217ad650f33e12d3a19aeb7321563a364b27894?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/27c260a860f0255b188d40468217ad650f33e12d3a19aeb7321563a364b27894?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/27c260a860f0255b188d40468217ad650f33e12d3a19aeb7321563a364b27894?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/27c260a860f0255b188d40468217ad650f33e12d3a19aeb7321563a364b27894?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">entropy512</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19597">2017/01/03 at 01:32</a></div>

		<div class="comment-body"><p>Hey, out of curiosity &#8211; what other sites did you see discussion of Toyota CANbus traffic on?</p>
<p>I have a 2006 Sienna and while some of the CAN-IDs are the same as yours (and in fact have identical information for 1-2 of them), there are quite a few differences.</p>
<p>Well actually it&#8217;s the family&#8217;s Sienna &#8211; I&#8217;ve traded with my 2009 Outback for a few weeks for various reasons.</p>
<p>For example I&#8217;ve found a single vehicle speed value (appears to be km/h*256), but no individual wheelspeed values (likely due to older vehicle without stability control).</p>
<p>I&#8217;ve found an oddball signal that seems to be approximately RPM*2 most of the time, but varies from that value.  (Usually gradually increases above RPM, but occasionally drops to 0)</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-3" id="li-comment-19613">
		<div id="comment-19613">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19613">2017/01/07 at 21:45</a></div>

		<div class="comment-body"><p>Hi! From what I remember the only external reference I had when I wrote this was a report from some university group on another Toyota car. I remember observing something similar to what you described: some frame IDs matched but the content was slightly different, which probably reflect some different evolution of the various ECUs and the communication protocols used, or just different requirements on what data needs to be shared between ECUs.</p>
<p>The lack of individual wheel speed may mean that the ABS unit obtains the information by some other mean other than the CANBUS. No clue about the RPM*2 one&#8230; maybe some other control signal loosely related to the engine speed.</p>
<p>Are you going to try and do some test on the Outback? Would be curious to see what you find&#8230; I would expect that car to be quite more sophisticated and have multiple buses though. :-)</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-3" id="li-comment-19614">
		<div id="comment-19614">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19614">2017/01/07 at 21:49</a></div>

		<div class="comment-body"><p>&#8230;it may have been this one <a href="http://tucrrc.utulsa.edu/ToyotaCAN.html" rel="nofollow ugc">http://tucrrc.utulsa.edu/ToyotaCAN.html</a> (first hit on Google&#8230; oh well :-)</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1" id="li-comment-5411">
		<div id="comment-5411">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Per&#039;s avatar' src='https://0.gravatar.com/avatar/fabc15e9c586cc262ecc39513f53adee143b23c660e33d02ca5fd8f12019f883?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/fabc15e9c586cc262ecc39513f53adee143b23c660e33d02ca5fd8f12019f883?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/fabc15e9c586cc262ecc39513f53adee143b23c660e33d02ca5fd8f12019f883?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/fabc15e9c586cc262ecc39513f53adee143b23c660e33d02ca5fd8f12019f883?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/fabc15e9c586cc262ecc39513f53adee143b23c660e33d02ca5fd8f12019f883?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/fabc15e9c586cc262ecc39513f53adee143b23c660e33d02ca5fd8f12019f883?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">Per</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-5411">2014/06/27 at 11:27</a></div>

		<div class="comment-body"><p>Nice job on decoding the CAN-frames. </p>
<p>Now that you have a CAN-OBD-interface it would be really simple to add functionality to also log supported OBD-PIDS for your vehicle</p>
<p>Have a look at <a href="http://en.wikipedia.org/wiki/OBD-II_PIDs" rel="nofollow ugc">http://en.wikipedia.org/wiki/OBD-II_PIDs</a> for a very nice guide. Basically, for the supported PIDS of your vehicle you just send a CAN-message and wait for respeonse. The list of supported PIDS is obtained by simpy asking, which is always supported (for non-electric vehicle).</p>
<p>Example:</p>
<p>Supported PIDs are obtained by sending a can message with [02,01,00,0,0,0,0,0], respone contains PIDS-supported. </p>
<p>Lets say PID=0x0A (fuel pressure) is supported, just send  [02,01,0A,0,0,0,0,0] and wait for response. Response should be something like: CAN-Sender-ID=0x7E8 (message from main ecu), [numBytes, 0x41,  PID=0x0A, A, B, C ,D, E, &#8230;] and actual fuel pressure is A*3 according to wikipedia.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=5411#respond" data-commentid="5411" data-postid="1419" data-belowelement="comment-5411" data-respondelement="respond" data-replyto="Reply to Per" aria-label="Reply to Per">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-5425">
		<div id="comment-5425">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-5425">2014/06/27 at 20:09</a></div>

		<div class="comment-body"><p>Hi Per!</p>
<p>You&#8217;re right, I was more interested into reversing some vehicle specific data but at this point it would be cool to have a socket-can based OBD scanner like you described&#8230; Only problem with that: in the meantime I moved to Ireland and I don&#8217;t have a car anymore! :)</p>
<p>Thanks for the followup though, feel free to drop a link if you have a chance of writing something for socketcan + OBD, I&#8217;m not aware of any free software to do that and it would be great to start one!</p>
<p>Cheers,<br />
Fabio</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=5425#respond" data-commentid="5425" data-postid="1419" data-belowelement="comment-5425" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-8530">
		<div id="comment-8530">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Micheal Dada&#039;s avatar' src='https://0.gravatar.com/avatar/3cc8f7d6be88df5b6c4087c4b88c3ff7af4a483ca17fdc514b01352b52f63bd5?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/3cc8f7d6be88df5b6c4087c4b88c3ff7af4a483ca17fdc514b01352b52f63bd5?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/3cc8f7d6be88df5b6c4087c4b88c3ff7af4a483ca17fdc514b01352b52f63bd5?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/3cc8f7d6be88df5b6c4087c4b88c3ff7af4a483ca17fdc514b01352b52f63bd5?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/3cc8f7d6be88df5b6c4087c4b88c3ff7af4a483ca17fdc514b01352b52f63bd5?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/3cc8f7d6be88df5b6c4087c4b88c3ff7af4a483ca17fdc514b01352b52f63bd5?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://www.sattraktelematics.com" class="url" rel="ugc external nofollow">Micheal Dada</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-8530">2014/09/12 at 20:29</a></div>

		<div class="comment-body"><p>Great job! really like your project. I have a project i&#8217;m actually working on, it&#8217;s all about acquiring odometer protocols from canbus, was able to acquire protocols for some vehicles but still have problem getting from vehicles like toyota hilux, toyota hiace, mistibushi l200, mistibushi lancer, ford ranger and other ford series. Kindly help with tips on resolving these.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=8530#respond" data-commentid="8530" data-postid="1419" data-belowelement="comment-8530" data-respondelement="respond" data-replyto="Reply to Micheal Dada" aria-label="Reply to Micheal Dada">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-8532">
		<div id="comment-8532">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-8532">2014/09/12 at 21:41</a></div>

		<div class="comment-body"><p>Sweet! You are welcome! :-)</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=8532#respond" data-commentid="8532" data-postid="1419" data-belowelement="comment-8532" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1" id="li-comment-8732">
		<div id="comment-8732">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Bill K&#039;s avatar' src='https://2.gravatar.com/avatar/ec9d2541cc101c8cdbd53d1ef332b31488e8b92777399597224f34cdc106478f?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/ec9d2541cc101c8cdbd53d1ef332b31488e8b92777399597224f34cdc106478f?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/ec9d2541cc101c8cdbd53d1ef332b31488e8b92777399597224f34cdc106478f?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/ec9d2541cc101c8cdbd53d1ef332b31488e8b92777399597224f34cdc106478f?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/ec9d2541cc101c8cdbd53d1ef332b31488e8b92777399597224f34cdc106478f?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/ec9d2541cc101c8cdbd53d1ef332b31488e8b92777399597224f34cdc106478f?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">Bill K</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-8732">2014/09/16 at 20:34</a></div>

		<div class="comment-body"><p>Thank you for this informative post. Although as a medical diagnostic imaging engineer I am familiar with CAN bus, what I am working with is pretty much presented by the manufacturers in hardware and software, as is the case with OBD II and OBD II readers. Your presentation differs in that it probes down to the signal level, which then may determine if a component is actually bad or if the signal is just bad. Am I right?<br />
I wish you had described a step by step use of the &#8220;socket can&#8221; for us who are less familiar with programming.<br />
Have you done any work into hacking the other CAN bus in cars, namely the Navigation-Radio-CD changer-Telephone-etc. can bus? From following the various automotive forums there seems to be an awful lot of problems in that area. I wonder why the power train CAN is so reliable and the entertainment CAN is not.  (Greater product liability?)</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=8732#respond" data-commentid="8732" data-postid="1419" data-belowelement="comment-8732" data-respondelement="respond" data-replyto="Reply to Bill K" aria-label="Reply to Bill K">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-8733">
		<div id="comment-8733">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-8733">2014/09/16 at 22:46</a></div>

		<div class="comment-body"><p>Hi Bill! Yes you are just about right, I would not really say &#8220;signal&#8221; though as I did not really put too much effort on electrical signals but rather at the lowest digital layer &#8211; the raw transmission and receiving of CAN frames, such as if they were IP packets.</p>
<p>The socketcan part is actually easy if you get familiar with normal &#8220;internet&#8221; sockets before, and that is just the API used to interface applications with TCP and UDP (and more!) streams. SocketCAN is just an extension of that to use CAN frames with the well-known socket API, and it&#8217;s actually a huge step forward compared to previous implementation of low level CAN APIs in Linux, which would not do too much other than exposing the controller to the application.</p>
<p>I did not really do much in cars other than what I described here, and I think CAN it&#8217;s used for infotrainment devices just because &#8220;it&#8217;s already there&#8221;&#8230; One problem is that there is still low interoperability between devices, since even if they share the bus they still implement vendor specific protocols on top of it (think of after-market stereo or dashboards).</p>
<p>If you hear about reliability problems it&#8217;s probably juts because those are just less important busses and receive less attention to reliable design as a consequence&#8230; Maybe the cables and connectors are lower quality (gauge, twisting&#8230;), have longer trunks (worse signal integrity), moves through hinges and other stuff. I&#8217;m sure the drivetrain bus receive more attention and there&#8217;s much more than the protocol itself in designing a reliable field bus system.</p>
<p>Cheers!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=8733#respond" data-commentid="8733" data-postid="1419" data-belowelement="comment-8733" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-9990">
		<div id="comment-9990">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='xarxer&#039;s avatar' src='https://1.gravatar.com/avatar/aeb3559a2b37cb2bea5a8509c5fa8cdea9c06cc758725400805345c2bde77f31?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/aeb3559a2b37cb2bea5a8509c5fa8cdea9c06cc758725400805345c2bde77f31?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/aeb3559a2b37cb2bea5a8509c5fa8cdea9c06cc758725400805345c2bde77f31?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/aeb3559a2b37cb2bea5a8509c5fa8cdea9c06cc758725400805345c2bde77f31?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/aeb3559a2b37cb2bea5a8509c5fa8cdea9c06cc758725400805345c2bde77f31?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/aeb3559a2b37cb2bea5a8509c5fa8cdea9c06cc758725400805345c2bde77f31?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">xarxer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-9990">2014/10/16 at 09:20</a></div>

		<div class="comment-body"><p>Hi Fabio,</p>
<p>I just ordered an OBD-II to DE-9 cable to do some car hacking, but I&#8217;d like to get started right away, so I was wondering if maybe you still have your recorded data? If so, I could use it to get the basics done of an application that utilizes it!</p>
<p>Thanks in advance!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=9990#respond" data-commentid="9990" data-postid="1419" data-belowelement="comment-9990" data-respondelement="respond" data-replyto="Reply to xarxer" aria-label="Reply to xarxer">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-9999">
		<div id="comment-9999">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-9999">2014/10/16 at 20:17</a></div>

		<div class="comment-body"><p>Hi Xarxer&#8230; I don&#8217;t have the dump anymore! :-) Sorry!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=9999#respond" data-commentid="9999" data-postid="1419" data-belowelement="comment-9999" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment odd alt depth-3" id="li-comment-11820">
		<div id="comment-11820">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='mck1117&#039;s avatar' src='https://1.gravatar.com/avatar/d315f0c0e463bc7d80140a8400e9cdfa439f168253338dc9467ed6c0c514c848?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/d315f0c0e463bc7d80140a8400e9cdfa439f168253338dc9467ed6c0c514c848?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/d315f0c0e463bc7d80140a8400e9cdfa439f168253338dc9467ed6c0c514c848?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/d315f0c0e463bc7d80140a8400e9cdfa439f168253338dc9467ed6c0c514c848?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/d315f0c0e463bc7d80140a8400e9cdfa439f168253338dc9467ed6c0c514c848?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/d315f0c0e463bc7d80140a8400e9cdfa439f168253338dc9467ed6c0c514c848?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">mck1117</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-11820">2014/12/10 at 07:40</a></div>

		<div class="comment-body"><p>Could you grab another one? I&#8217;m also interested in a working dump.  Surely you still have the car!</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-3" id="li-comment-11846">
		<div id="comment-11846">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-11846">2014/12/10 at 20:06</a></div>

		<div class="comment-body"><p>Nope, I moved shortly after writing this post and I don&#8217;t have a car anymore. :-)</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1" id="li-comment-12541">
		<div id="comment-12541">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='SpoderMan&#039;s avatar' src='https://2.gravatar.com/avatar/2809c741578c1998c5dfcb89fcdb85a5bce0dd4aa471c15239c19cc773da45e4?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/2809c741578c1998c5dfcb89fcdb85a5bce0dd4aa471c15239c19cc773da45e4?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/2809c741578c1998c5dfcb89fcdb85a5bce0dd4aa471c15239c19cc773da45e4?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/2809c741578c1998c5dfcb89fcdb85a5bce0dd4aa471c15239c19cc773da45e4?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/2809c741578c1998c5dfcb89fcdb85a5bce0dd4aa471c15239c19cc773da45e4?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/2809c741578c1998c5dfcb89fcdb85a5bce0dd4aa471c15239c19cc773da45e4?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://seven-labs.com" class="url" rel="ugc external nofollow">SpoderMan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-12541">2015/01/03 at 07:30</a></div>

		<div class="comment-body"><p>Hello Fabio,</p>
<p>Very nice work! I am quite interested in this project, and very impressed by this write-up. I am wondering if you have messed with writing to the ECU to add any special &#8220;tunes&#8221; or performance mods? I am wanting to take this approach to learn more about some newer diesel trucks, and what signals/data are running on the CAN bus, perhaps write some performance tunes in a C# program where they can then be uploaded via OBD.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=12541#respond" data-commentid="12541" data-postid="1419" data-belowelement="comment-12541" data-respondelement="respond" data-replyto="Reply to SpoderMan" aria-label="Reply to SpoderMan">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-12549">
		<div id="comment-12549">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-12549">2015/01/03 at 19:24</a></div>

		<div class="comment-body"><p>Hi! Not really, I&#8217;m afraid all the information on how to change stuff on the ECU is model specific and non standard, and I haven&#8217;t tried to write anything on the bus. The idea should work, you can get some CAN interface with C# APIs and write stuff to the various ECUs, but you need to get or reverse the programming documentation first.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=12549#respond" data-commentid="12549" data-postid="1419" data-belowelement="comment-12549" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-12631">
		<div id="comment-12631">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='sarthak7386&#039;s avatar' src='https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://gravatar.com/sarthak7386" class="url" rel="ugc external nofollow">sarthak7386</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-12631">2015/01/07 at 15:18</a></div>

		<div class="comment-body"><p>Hey Fabio,</p>
<p>Hi! I am Sarthak Jain. I was currently analysing the CAN bus via ELM327. I captured some packets for window up and down. But when I replay those packets using ELM327, then I do not see any action other than flickering of &#8216;check engine light&#8217;. After asking some people, I came to know that the speed of ELM may be slow which is causing conflicts on the CAN bus.<br />
I came across this module &#8211; <a href="http://www.8devices.com/usb2can" rel="nofollow ugc">http://www.8devices.com/usb2can</a>. I need to know if I send those packets using this hardware, I would not get the same problem of speed as with ELM. Can you please comment upon this?<br />
There is one more module &#8211; &#8216;ECOM&#8217; cable which is being used for hacking the CAN bus. Are you aware of this?</p>
<p>Thank you!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=12631#respond" data-commentid="12631" data-postid="1419" data-belowelement="comment-12631" data-respondelement="respond" data-replyto="Reply to sarthak7386" aria-label="Reply to sarthak7386">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-12637">
		<div id="comment-12637">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-12637">2015/01/07 at 22:19</a></div>

		<div class="comment-body"><p>Hi Sarthak! I have no experience with ELM327 but the speed explanation sound awkward (speed of what btw? the micro that the elm is based on? its CAN interface?). If you are using the ELM correctly I think you could get the same result&#8230; but having a second device to crosscheck would not hurt for sure. Never heard for this ECOM thing.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=12637#respond" data-commentid="12637" data-postid="1419" data-belowelement="comment-12637" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1" id="li-comment-12659">
		<div id="comment-12659">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='sarthak7386in&#039;s avatar' src='https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://gravatar.com/sarthak7386" class="url" rel="ugc external nofollow">sarthak7386in</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-12659">2015/01/08 at 17:32</a></div>

		<div class="comment-body"><p>Hey,</p>
<p>The speed is that of the CAN packets which I am sending via &#8216;pyserial&#8217; package.<br />
Actually I am using OBD-II UART board which provides a serial interface to send and receive packets to the OBD-II bus. I used ELM 327 AT commands to analyse the traffic, reverse-engineered some of the packets, found the ones which change when, say window go up or down. But when I replay those packets using &#8216;pyserial&#8217;, all I get is &#8216;flickering of check engine light&#8217;.<br />
By the way, USB2CAN device provides a serial interface or some other?</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=12659#respond" data-commentid="12659" data-postid="1419" data-belowelement="comment-12659" data-respondelement="respond" data-replyto="Reply to sarthak7386in" aria-label="Reply to sarthak7386in">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-12696">
		<div id="comment-12696">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-12696">2015/01/10 at 16:25</a></div>

		<div class="comment-body"><p>Right, so if the OBD adapter is passing through a standard UART to communicate with the host, it may be saturating that link. I think that&#8217;s a poor design in general, but it&#8217;s particularly bad if it&#8217;s using a real UART and a converter, limited to a specific bit rate, rather than a &#8220;virtual serial&#8221; implemented directly on the USB controller. In the case of the ELM controller I guess that the design made sense since you are supposed to use it to communicate with the ELM chip  using AT commands (let&#8217;s call it legacy), and that link should not require much bandwidth, but if you try to turn that into a CAN interface you are surely going to get very poor performances. None of the devices I listed in this post are implemented like that AFAIK, and all are using proper USB endpoints (and works with socketcan).</p>
<p>That said, I doubt that&#8217;s the problem that leads to your &#8220;check engine flickering&#8221; thing, you are more likely sending wrong data or just sending something that gets quickly overridden by some other periodic frame on the bus.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=12696#respond" data-commentid="12696" data-postid="1419" data-belowelement="comment-12696" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-sarthak7386 odd alt depth-3" id="li-comment-12838">
		<div id="comment-12838">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='sarthak7386&#039;s avatar' src='https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://sarthak7386.wordpress.com" class="url" rel="ugc external nofollow">sarthak7386</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-12838">2015/01/17 at 20:24</a></div>

		<div class="comment-body"><p>Hey, yeah you are right that my data is being overridden by some other frames.</p>
<p>I have one more question. The OBD-II UART board is having MCP2551 CAN transreceiver and STN1110 as its controller. Clearly STN1110 is ELM based and is not CAN controller.<br />
But we can select CAN as one of its protocols and then we can talk to ecu and get sensors data. Right?<br />
It means it can talk to the CAN bus without any problem. But I guess the only issue is that of speed of the serial port which is causing trouble.<br />
I hope this trouble goes away by using USB2CAN device?</p>
<p>Thank you!</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-3" id="li-comment-12840">
		<div id="comment-12840">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-12840">2015/01/17 at 23:00</a></div>

		<div class="comment-body"><p>Well, the fact that you only have a CAN transceiver on the board means that the STN1110 does have a hardware CAN interface (it&#8217;s probably some commercial microcontroller pre-programmed and custom branded), and the controller can surely operate on a full-speed bus (that&#8217;s 1Mbps), but that does not immediately translate in the fact that you can use it as a generic CAN interface and transfer the whole data stream of the bus on the control interface (your serial). The serial port speed is surely the first concern on that, but that&#8217;s far from being the only limitations. CAN based micros are designed with some kind of frame filter to be able to silently discard most data present on the bus, and only activate the CPU to process the essential frames. If you use the micro as a bus sniffer, thus opening the filters to grab the whole data stream, the micro may not even have enough power to unqueue the frames fast enough to prevent overrun, and that may even happen if the bus is lightly loaded but bursty.</p>
<p>Those ODB chips are nice in that they can implement the OBD protocols (on top of CAN and other busses), but they are not designed to be used as a raw CAN sniffer device (access the full bus data even in heavy load or bursty conditions &#8211; which as I understand is what you are trying to achieve here). If that is what you want to do you would surely have better results with something like the USB2CAN.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment byuser comment-author-sarthak7386 odd alt thread-odd thread-alt depth-1" id="li-comment-12848">
		<div id="comment-12848">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='sarthak7386&#039;s avatar' src='https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/b56a03242db78301f4419f13885562c2ad16398b43fa1182d5eef5e66550c690?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://sarthak7386.wordpress.com" class="url" rel="ugc external nofollow">sarthak7386</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-12848">2015/01/18 at 09:05</a></div>

		<div class="comment-body"><p>Okay, I hope UsB2CAN solve the problem! By the way do you know what transreceiver and controller USB2CAN is using? I did not find any information on their website.</p>
<p>One more thing &#8211; If let say I replay the packets responsible for door lock , will I actually see the doors unlocking themselves? If you have some literature on how ECUs communicate, I would be really thankful to you if share the same.</p>
<p>Thank you!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=12848#respond" data-commentid="12848" data-postid="1419" data-belowelement="comment-12848" data-respondelement="respond" data-replyto="Reply to sarthak7386" aria-label="Reply to sarthak7386">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-12853">
		<div id="comment-12853">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-12853">2015/01/18 at 16:49</a></div>

		<div class="comment-body"><p>They give complete schematics on the website: <a href="http://www.8devices.com/usb2can" rel="nofollow ugc">http://www.8devices.com/usb2can</a>, the setup is an MCP2551 + STR750FV2.</p>
<p>On the lock question, hard to say, it depends how the information on the frames is interpreted&#8230; it may not be that easy, and you are still racing with the frames sent by the original controller on the bus, and injecting/replying frames may or may not work depending on how the protocol is designed. The very fact that your check engine light blinks when you send stuff is telling you that something is detecting an erroneous condition on the bus (checksum? sequencing?&#8230;) which then resolves with the normal traffic.</p>
<p>I don&#8217;t have any literature for that, you may find something about the OBD stuff (which AFAIK is a request-response based protocol implemented on top of a pair of CAN IDs), but everything else is proprietary, vendor and model specific stuff&#8230; If you find something is either leaked or reverse engineered (well, this post is about reverse engineering it after all&#8230;).</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=12853#respond" data-commentid="12853" data-postid="1419" data-belowelement="comment-12853" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment odd alt depth-3" id="li-comment-13946">
		<div id="comment-13946">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Sarthak Jain&#039;s avatar' src='https://graph.facebook.com/v2.2/100001472121713/picture?type=large&#038;_md5=60b07190750cf49e75a73c21d0cfa8d7' srcset='https://graph.facebook.com/v2.2/100001472121713/picture?type=large&#038;_md5=60b07190750cf49e75a73c21d0cfa8d7 1x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large&#038;_md5=60b07190750cf49e75a73c21d0cfa8d7 1.5x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large&#038;_md5=60b07190750cf49e75a73c21d0cfa8d7 2x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large&#038;_md5=60b07190750cf49e75a73c21d0cfa8d7 3x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large&#038;_md5=60b07190750cf49e75a73c21d0cfa8d7 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://www.facebook.com/100001472121713" class="url" rel="ugc external nofollow">Sarthak Jain</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13946">2015/04/05 at 18:38</a></div>

		<div class="comment-body"><p>Hey,</p>
<p>Some time back, we had a discussion about ELM327 speed issues. Now, I purchased an USB2CAN converter from 8devices. After configuring the CAN interface, when I tried to use candump command, I got nothing from the car.</p>
<p>I also noticed some unusual change in the dashboard lights and data as soon as I am connecting the USB2CAN converter to the OBD-II port without even connecting it to the laptop.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-3" id="li-comment-13956">
		<div id="comment-13956">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13956">2015/04/06 at 19:30</a></div>

		<div class="comment-body"><p>Hey, dashboard errors are a clear indication of something wrong, it happened to me when I was fiddling with that on my Bravo, I had the wrong bitrate and did not se the listen-only option, and I think the interface was spamming error frames all over the place, causing some error indication to turn on. It should not happen when the device is not powered though, CAN transceivers should be designed to support that state and not interfeer with the bus. Are you sure you wired the CAN port correctly?</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1" id="li-comment-13319">
		<div id="comment-13319">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Akshay&#039;s avatar' src='https://1.gravatar.com/avatar/198c7585fa6c03d9009d3ad62898e5a4fa4e5526d9d083843a7090275876d04d?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/198c7585fa6c03d9009d3ad62898e5a4fa4e5526d9d083843a7090275876d04d?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/198c7585fa6c03d9009d3ad62898e5a4fa4e5526d9d083843a7090275876d04d?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/198c7585fa6c03d9009d3ad62898e5a4fa4e5526d9d083843a7090275876d04d?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/198c7585fa6c03d9009d3ad62898e5a4fa4e5526d9d083843a7090275876d04d?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/198c7585fa6c03d9009d3ad62898e5a4fa4e5526d9d083843a7090275876d04d?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">Akshay</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13319">2015/02/13 at 11:02</a></div>

		<div class="comment-body"><p>Hello sir , i would like your help in deciphering the following code </p>
<p>Bus speed: 500000 kbit/s H, Sampling point: 75%, SJW 2</p>
<p>18DAF130 X | 8 | 02 7E 00 55 55 55 55 55 |       5076<br />
18DAF128 X | 8 | 02 7E 00 55 55 55 55 55 |       1506<br />
18DAF110 X | 8 | 02 7E 00 55 55 55 55 55 |       1620<br />
18DAF153 X | 8 | 02 7E 00 55 55 55 55 55 |       8639<br />
18DAF160 X | 8 | 02 7E 00 55 55 55 55 55 |        797<br />
18DA30F1 X | 8 | 03 22 48 00 00 00 00 00 |     417576<br />
18DAF130 X | 8 | 10 3B 62 48 00 00 00 F8 |       4435<br />
18DA30F1 X | 8 | 30 00 00 00 00 00 00 00 |        484<br />
18DAF130 X | 8 | 21 C0 00 00 00 00 52 14 |       1483<br />
18DAF130 X | 8 | 22 11 21 01 00 00 00 08 |       1466</p>
<p>Can you explain me what the above data corresponds to in-terms of<br />
1: Start of frame<br />
2: Arbitration Field<br />
3: Control Field<br />
4: Data Field<br />
5: CRC Field<br />
6: ACK Field<br />
7: End of frame</p>
<p>If you can provide me with a  brief understanding on how to read the above mentioned data it would be very helpful.</p>
<p>The above mentioned CAN bus packet data  was gathered from a<br />
Honda City ,1.5L i-Vtec, Petrol Injection.<br />
Communication with the Engine Control Module was observed in<br />
ISO15765 CAN HIGH ( Pin no 6)<br />
ISO 15765 CAN LOW ( Pin no 14)</p>
<p>Your help will be much appreciated sir.<br />
Thank you<br />
With Regards<br />
Akshay</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=13319#respond" data-commentid="13319" data-postid="1419" data-belowelement="comment-13319" data-respondelement="respond" data-replyto="Reply to Akshay" aria-label="Reply to Akshay">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-13330">
		<div id="comment-13330">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13330">2015/02/13 at 21:01</a></div>

		<div class="comment-body"><p>Hi Askshay, I think you are overestimating my abilities to see through the matrix, I can barely tell that those are extended CAN frames but that&#8217;s about it. :-)</p>
<p>Anyway, the details you asked are not really related to that dump, those are part of the CAN framing, and does not really show up at application level. What you dumped are basically just the ID, the DLC (always 8 in your case) and the data &#8212; not sure about the last number.</p>
<p>I don&#8217;t really have any documentation for reading *that* specific data (the frame specs are ECU specific), though if you are interested in CANBUS in general there is plenty of literature on manufacturer websites, just Google it.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=13330#respond" data-commentid="13330" data-postid="1419" data-belowelement="comment-13330" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment odd alt depth-2" id="li-comment-14760">
		<div id="comment-14760">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='David&#039;s avatar' src='https://0.gravatar.com/avatar/052a70150e824b16b33fedc3d9c6ef0c752541afc3730ef47075da8d67574560?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/052a70150e824b16b33fedc3d9c6ef0c752541afc3730ef47075da8d67574560?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/052a70150e824b16b33fedc3d9c6ef0c752541afc3730ef47075da8d67574560?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/052a70150e824b16b33fedc3d9c6ef0c752541afc3730ef47075da8d67574560?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/052a70150e824b16b33fedc3d9c6ef0c752541afc3730ef47075da8d67574560?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/052a70150e824b16b33fedc3d9c6ef0c752541afc3730ef47075da8d67574560?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">David</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14760">2015/06/26 at 00:57</a></div>

		<div class="comment-body"><p>Akshay,</p>
<p>I know this is a long time from your original post but I just got into Toyota&#8217;s and found this site courtesy of Google.</p>
<p>The CAN traffic you posted is very typical of the interaction between a tester(something like a dealer scan tool, ELM327&#8230;etc) and one or more modules.  I think for what your looking for you don&#8217;t need to worry so much about all those things you numbered off.  The things you are interested in are the Id and the data.</p>
<p>Using your first line as an example:</p>
<p>18DAF130 X | 8 | 02 7E 00 55 55 55 55 55 | 5076</p>
<p>The Id is 18DAF130.  The 18DA is a standard identifier for physically addressed signals(the tool is asking one module for a response). You may also see 18DB which is a way for one tool to ask all of the modules for data(functionally addressed). F1 lets you know a &#8220;tester&#8221; is asking for this information as opposed to another module onboard.  30 is the destination address.  This could be any module on that particular bus(engine, trans, body, HVAC&#8230;..). The X is just to let you know this is an extended message(29 bit identifier).</p>
<p>8 is the length of the message data to follow.</p>
<p>This is the data that you actually care about:<br />
02 7E 00 55 55 55 55 55</p>
<p>02 is the length of the data in this message that is significant(not counting itself)</p>
<p>7E is a standard identifier indicating a &#8220;tester present&#8221; message</p>
<p>00 is the &#8220;mode&#8221; for lack of a better term.  There are a bunch of different modes that do different things mainly it indicates whether or not this message should be acknowledged by the receiving module.  In this case it appears 00 means it does not require acknowledgement.</p>
<p>The rest of the 55&#8217;s are just padding.  I know that because the 02 in the first byte told me there was only two bytes of significant data.</p>
<p>Long story short, this message was just a signal from some tool on the bus to a specific module to let it know it was there. Not too exciting&#8230;&#8230;There are 5 different modules this tool to talking to (30, 28, 10, 53 and 60).  I don&#8217;t know which modules those numbers correspond to but you can probably figure it out with enough internet searching.</p>
<p>This is the interesting message:</p>
<p>18DA30F1 X | 8 | 03 22 48 00 00 00 00 00 | 417576</p>
<p>This is the tester asking module 30 for some Mode$22 data from PID 4800. Module $30 then responded with 59 bytes of significant data. Who knows what information is contained within this message(it is proprietary but again you may be able to figure it out with some internet searches) but something in your car is asking for it.</p>
<p>Clear as mud?</p>
<p>Dave</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14760#respond" data-commentid="14760" data-postid="1419" data-belowelement="comment-14760" data-respondelement="respond" data-replyto="Reply to David" aria-label="Reply to David">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment even depth-3" id="li-comment-14761">
		<div id="comment-14761">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='David&#039;s avatar' src='https://0.gravatar.com/avatar/052a70150e824b16b33fedc3d9c6ef0c752541afc3730ef47075da8d67574560?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/052a70150e824b16b33fedc3d9c6ef0c752541afc3730ef47075da8d67574560?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/052a70150e824b16b33fedc3d9c6ef0c752541afc3730ef47075da8d67574560?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/052a70150e824b16b33fedc3d9c6ef0c752541afc3730ef47075da8d67574560?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/052a70150e824b16b33fedc3d9c6ef0c752541afc3730ef47075da8d67574560?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/052a70150e824b16b33fedc3d9c6ef0c752541afc3730ef47075da8d67574560?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">David</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14761">2015/06/26 at 01:11</a></div>

		<div class="comment-body"><p>After I posted this, I realized I screwed it up.  I swapped the sender and receiver in my head. It should read:</p>
<p>&#8220;The Id is 18DAF130. The 18DA is a standard identifier for physically addressed signals(the tool is asking one module for a response). You may also see 18DB which is a way for one tool to ask all of the modules for data(functionally addressed). F1 lets you know a “tester” is receiving this information as opposed to another module onboard. 30 is the sender&#8217;s address. This could be any module on that particular bus(engine, trans, body, HVAC…..). The X is just to let you know this is an extended message(29 bit identifier).</p>
<p>8 is the length of the message data to follow.</p>
<p>This is the data that you actually care about:<br />
02 7E 00 55 55 55 55 55</p>
<p>02 is the length of the data in this message that is significant(not counting itself)</p>
<p>7E is a standard identifier indicating a “tester present acknowledged” message</p>
<p>00 is the “mode” for lack of a better term. There are a bunch of different modes that can be sent from the tester which do different things. Mainly it indicates whether or not this message should be acknowledged by the receiving module. In this case The tester did require an acknowledgement.</p>
<p>The rest of the 55’s are just padding. I know that because the 02 in the first byte told me there was only two bytes of significant data.</p>
<p>Long story short, this message was just a response from some module on the bus to the tester in response to its original tester present message(not included in your data dump). Not too exciting……There are 5 different modules responding to the tester&#8217;s message (30, 28, 10, 53 and 60). I don’t know which modules those numbers correspond to but you can probably figure it out with enough internet searching.&#8221;</p>
<p>Sorry about that, its been a long day&#8230;..</p>
<p>Dave</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment odd alt depth-3" id="li-comment-20045">
		<div id="comment-20045">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Akshay Acharya&#039;s avatar' src='https://graph.facebook.com/v2.2/10213127878335760/picture?type=large&#038;_md5=ec4f8bb4505065e8a431206fa1accd4e' srcset='https://graph.facebook.com/v2.2/10213127878335760/picture?type=large&#038;_md5=ec4f8bb4505065e8a431206fa1accd4e 1x, https://graph.facebook.com/v2.2/10213127878335760/picture?type=large&#038;_md5=ec4f8bb4505065e8a431206fa1accd4e 1.5x, https://graph.facebook.com/v2.2/10213127878335760/picture?type=large&#038;_md5=ec4f8bb4505065e8a431206fa1accd4e 2x, https://graph.facebook.com/v2.2/10213127878335760/picture?type=large&#038;_md5=ec4f8bb4505065e8a431206fa1accd4e 3x, https://graph.facebook.com/v2.2/10213127878335760/picture?type=large&#038;_md5=ec4f8bb4505065e8a431206fa1accd4e 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://www.facebook.com/app_scoped_user_id/10213127878335760/" class="url" rel="ugc external nofollow">Akshay Acharya</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-20045">2017/04/26 at 06:30</a></div>

		<div class="comment-body"><p>Dear Dave,</p>
<p>Thank a lot for your reply, i was toying with the idea of decoding the data packet earlier and once again i am approaching it as it has become a necessity. I have understood what you have explained in the above post and would like to thank you for explaining it in such detail.</p>
<p>Considerin&#8217;g the above the data dump, you have clearly explained what 18DAF130 refers to and also about &#8220;DB&#8221; . Clearly there are several notations which i need to be aware of if i have to understand the lines of data. are their any literature where one could read through the different sets of identifiers.</p>
<p>18DA10F1 X | 8 | 30 00 00 00 00 00 00 00 |        384</p>
<p>18DA10F1 refer to 18DA being the standard identifier and what does 10 refers to? F1 refers to the tester present.  whereas 30 refer to length of the data am i right ?</p>
<p>Also can you please elaborate what exactly you meant by the following &#8221; this message was just a response from some module on the bus to the tester in response to its original tester present message(not included in your data dump).&#8221;</p>
<p>Thank you<br />
Warm Regards<br />
Akshay</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-jzkhankakar even depth-3" id="li-comment-32260">
		<div id="comment-32260">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='jzkhankakar&#039;s avatar' src='https://1.gravatar.com/avatar/dcd50bc6b5e3dace356a51077b6804e2c82f2fc312822acd5b00c47ade033732?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/dcd50bc6b5e3dace356a51077b6804e2c82f2fc312822acd5b00c47ade033732?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/dcd50bc6b5e3dace356a51077b6804e2c82f2fc312822acd5b00c47ade033732?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/dcd50bc6b5e3dace356a51077b6804e2c82f2fc312822acd5b00c47ade033732?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/dcd50bc6b5e3dace356a51077b6804e2c82f2fc312822acd5b00c47ade033732?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/dcd50bc6b5e3dace356a51077b6804e2c82f2fc312822acd5b00c47ade033732?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://jzkhankakar.wordpress.com" class="url" rel="ugc external nofollow">jzkhankakar</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-32260">2023/07/02 at 23:08</a></div>

		<div class="comment-body"><p>hi, thankyou for your project i learned a lot. I know its been quite some time since you have done it but i have a very simple question which is very confusing for me.<br />
I have a toyota mark x with engine 2500 CC (4gr-fse) and i am trying to read the data from the can H and can L.<br />
I am using ESP32 (Arduino) and Mcp2515 (canbus module) to read the data and i have successfully read the data.<br />
The problem i am facing is my data looks like this:<br />
Standard ID: 0x2C6       DLC: 5  Data: 0x00 0x00 0x00 0x00 0xCD<br />
Standard ID: 0x2C5       DLC: 4  Data: 0x00 0x05 0x76 0x46<br />
Standard ID: 0x2C4       DLC: 8  Data: 0x00 0x00 0x04 0x1F 0x04 0x80 0x70 0xE5<br />
I am using Mcp_can library from the popular author coryjfowler on github:<br />
<a href="https://github.com/coryjfowler/MCP_CAN_lib/tree/master" rel="nofollow ugc">https://github.com/coryjfowler/MCP_CAN_lib/tree/master</a><br />
The problem is i know that 2c4 is my rpm but i am only getting very few ids even after starting my car those are: 2C1, 2C4, 2C5, 2C6, 2D0, 4CE, 340 thats it. and when i read the wikipedia for the PIDS these are not pids these are ID&#8217;s which are coming from the code i know.<br />
My questions:</p>
<p>Why i dont see the PID&#8217;s those are easy to extract the values and have more data?<br />
Why i see only these ids and not see the total length of ids equal to pids for example if there are 100 pids why i only see few ids?<br />
Is it because PIDS come in different protocols and my car has different protocol which gives me IDS instead of PIDS? or i have to send some data to ecu in order to get the data in terms of PIDS and not IDS?<br />
Can you please please spend some time to write me back as i am really learning things and don&#8217;t want to stop my self.<br />
Thanks</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-13349">
		<div id="comment-13349">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Akshay&#039;s avatar' src='https://1.gravatar.com/avatar/198c7585fa6c03d9009d3ad62898e5a4fa4e5526d9d083843a7090275876d04d?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/198c7585fa6c03d9009d3ad62898e5a4fa4e5526d9d083843a7090275876d04d?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/198c7585fa6c03d9009d3ad62898e5a4fa4e5526d9d083843a7090275876d04d?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/198c7585fa6c03d9009d3ad62898e5a4fa4e5526d9d083843a7090275876d04d?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/198c7585fa6c03d9009d3ad62898e5a4fa4e5526d9d083843a7090275876d04d?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/198c7585fa6c03d9009d3ad62898e5a4fa4e5526d9d083843a7090275876d04d?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">Akshay</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13349">2015/02/16 at 05:47</a></div>

		<div class="comment-body"><p>Thank you for the reply sir, The reason i asked you is that i am trying to understand the data dump. i have gone through few notes and pdf&#8217;s on the net and with respect to CANBUS they have mentioned<br />
Arbitration Data , CRC,ACK etc i am just starting to get my head around it, but there is  no success. </p>
<p>Also the packet data that i have collected, how do i identify what they correspond to?<br />
For example : I have my throttle wide open and i am seeing bits of data streaming across my screen and i would like to identify which among those streams of data does my vehicle RPM correspond to ?</p>
<p>Now sir please tell me is this the right way decipher the data dump or is their any other way ??</p>
<p>and what does the Bit 8 refer to in the following </p>
<p>18DAF160 X | 8 | 02 7E 00 55 55 55 55 55 | 797</p>
<p>Last thing is Sir could you suggest me some literature that has an in depth explanation of CANBUS protocols and other K line , K-L line protocols and also how to reverse engineer the data dump?? </p>
<p>Thank you<br />
With Regards<br />
Akshay</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=13349#respond" data-commentid="13349" data-postid="1419" data-belowelement="comment-13349" data-respondelement="respond" data-replyto="Reply to Akshay" aria-label="Reply to Akshay">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-13369">
		<div id="comment-13369">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13369">2015/02/18 at 21:10</a></div>

		<div class="comment-body"><p>Right, so what you are looking at is just the frame identifier (18DAF160) and the payload (02 7E 00 55 55 55 55 55), CRC, ACK and other framing stuff shows up at a lower level and you don&#8217;t really care. What you need to do is figure out a way of understand the meaning of the data, and how to do it is up to you. What I did was taking one frame id at a time, observe how the data changed and try to correlate with the event in the car (from the video recording). That&#8217;s what this post is about.</p>
<p>The &#8220;8&#8221; digit is probably the DLC, which is a just fancy name for the size of the payload (8 bytes).</p>
<p>I don&#8217;t really have any in-depth literature on CANBUS, the protocol is not that complicated to understand, especially if you only care about application level stuff (i.e. you are not writing a driver or implementing a controller or a circuit board). For how to reverse it&#8230; up to you, this post contains a description of my process already&#8230;</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=13369#respond" data-commentid="13369" data-postid="1419" data-belowelement="comment-13369" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1" id="li-comment-13522">
		<div id="comment-13522">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Sam&#039;s avatar' src='https://2.gravatar.com/avatar/edf680996ef702d60814b875921a2dd7c0b817259969349acf19fc53af2ca346?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/edf680996ef702d60814b875921a2dd7c0b817259969349acf19fc53af2ca346?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/edf680996ef702d60814b875921a2dd7c0b817259969349acf19fc53af2ca346?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/edf680996ef702d60814b875921a2dd7c0b817259969349acf19fc53af2ca346?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/edf680996ef702d60814b875921a2dd7c0b817259969349acf19fc53af2ca346?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/edf680996ef702d60814b875921a2dd7c0b817259969349acf19fc53af2ca346?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">Sam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13522">2015/03/05 at 06:01</a></div>

		<div class="comment-body"><p>Thank you for sharing this great knowledge!</p>
<p>I have question sir.<br />
I&#8217;m using c# for my project (reading &amp; writing data to serial port; OBDII).<br />
How can I disable/hide certain pids from reading?</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=13522#respond" data-commentid="13522" data-postid="1419" data-belowelement="comment-13522" data-respondelement="respond" data-replyto="Reply to Sam" aria-label="Reply to Sam">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-13537">
		<div id="comment-13537">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13537">2015/03/06 at 00:31</a></div>

		<div class="comment-body"><p>Hey Sam, that depends on the interface and driver you are using, it may not even expose any filtering API. That said if you are connected to a computer and the interface can handle the full traffic you can filter those in software. Acceptance filters and mailboxes allows to use a fast bus with slow microcontrollers, but for a general purpose computer that&#8217;s unnecessary.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=13537#respond" data-commentid="13537" data-postid="1419" data-belowelement="comment-13537" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-13957">
		<div id="comment-13957">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Sarthak Jain&#039;s avatar' src='https://graph.facebook.com/v2.2/100001472121713/picture?type=large' srcset='https://graph.facebook.com/v2.2/100001472121713/picture?type=large 1x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large 1.5x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large 2x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large 3x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://www.facebook.com/100001472121713" class="url" rel="ugc external nofollow">Sarthak Jain</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13957">2015/04/06 at 20:30</a></div>

		<div class="comment-body"><p>Hi, I am not able to reply on the above thread.</p>
<p>But here we are. As I told you, I used an USB2CAN converter. As soon as I connected this to the OBD-II port without actually powering it, I saw an unusual change in the dashboard lights and data. The cable which I used is OBD-II to DB-9 cable which you also suggested in your blog.<br />
I tried various baud rates &#8211; 500, 250, 50 kbps and also set the listen-only mode on, but as soon as tried the &#8220;candump&#8221; command, I did not get anything.</p>
<p>Can it be a problem of device itself?</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=13957#respond" data-commentid="13957" data-postid="1419" data-belowelement="comment-13957" data-respondelement="respond" data-replyto="Reply to Sarthak Jain" aria-label="Reply to Sarthak Jain">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-13968">
		<div id="comment-13968">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13968">2015/04/07 at 04:58</a></div>

		<div class="comment-body"><p>Right, so, the fact the both that cable and the CAN interface have a DE9 connector does not mean that they are meant to be plugged together. In fact they are not, that cable (<a href="https://www.sparkfun.com/products/10087" rel="nofollow ugc">https://www.sparkfun.com/products/10087</a>) is using some pinout commonly found in OBD scanners (I think..), but the 8-devices converter (<a href="http://www.8devices.com/media/files/usb2can.pdf" rel="nofollow ugc">http://www.8devices.com/media/files/usb2can.pdf</a>) is using the standardized CiA D-sub pinout (<a href="https://www.phoenixcontact.com/assets/downloads_ed/global/web_dwl_technical_info/CANopen.pdf" rel="nofollow ugc">https://www.phoenixcontact.com/assets/downloads_ed/global/web_dwl_technical_info/CANopen.pdf</a> page 9), which is what you expect in automation devices.</p>
<p>You should cut the end of the cable and rewire it (which is what I did as well, I had a custom connector in my USB interface). What you did shorted some random signal together, hence the error lights on the dashboard. It probably did not blow anything but be careful with that, as far as I remember the OBD connector has a +12V line straight from the battery, which is probably  limited by a 10A fuse or something. That&#8217;s potentially lethal to any non protected signal transceiver. :-)</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=13968#respond" data-commentid="13968" data-postid="1419" data-belowelement="comment-13968" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment odd alt depth-3" id="li-comment-13977">
		<div id="comment-13977">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Sarthak Jain&#039;s avatar' src='https://graph.facebook.com/v2.2/100001472121713/picture?type=large' srcset='https://graph.facebook.com/v2.2/100001472121713/picture?type=large 1x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large 1.5x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large 2x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large 3x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://www.facebook.com/100001472121713" class="url" rel="ugc external nofollow">Sarthak Jain</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13977">2015/04/07 at 11:51</a></div>

		<div class="comment-body"><p>Yes, you are absolutely right. The pin connections do not match.</p>
<p>Basically, I have to connect these pins CAN-H (6-4), CAN-L(14-3), GND(5-5) of DB-9 and USB2CAN respectively.</p>
<p>Since I also test on OBD-II port, is there a way so that without cutting the DB-9 connector, I can connect these through wires. I know I am not good in hardware connections. :P</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment even depth-3" id="li-comment-13978">
		<div id="comment-13978">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Sarthak Jain&#039;s avatar' src='https://graph.facebook.com/v2.2/100001472121713/picture?type=large' srcset='https://graph.facebook.com/v2.2/100001472121713/picture?type=large 1x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large 1.5x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large 2x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large 3x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://www.facebook.com/100001472121713" class="url" rel="ugc external nofollow">Sarthak Jain</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13978">2015/04/07 at 12:59</a></div>

		<div class="comment-body"><p>Oh I am sorry for my wrong pin connections which I mentioned in my earlier post. Now I got the right one.<br />
But is there any you can suggest me to connect the pins of DB-9 and USB2CAN respectively without cutting DB-9 ?</p>
<p>Thank you.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-3" id="li-comment-13997">
		<div id="comment-13997">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13997">2015/04/08 at 05:30</a></div>

		<div class="comment-body"><p>Well if you don&#8217;t want to cut the connector you could make an adapter&#8230; I guess you could splice an serial extension cable. Just match the CANH, CANL and (signal) ground pins.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="li-comment-13992">
		<div id="comment-13992">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='treadlite&#039;s avatar' src='https://2.gravatar.com/avatar/2bcd944ddee4915a331f19dcdc04ae38b5fbfe4f5c1c85175fcd8977c43ae0aa?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/2bcd944ddee4915a331f19dcdc04ae38b5fbfe4f5c1c85175fcd8977c43ae0aa?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/2bcd944ddee4915a331f19dcdc04ae38b5fbfe4f5c1c85175fcd8977c43ae0aa?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/2bcd944ddee4915a331f19dcdc04ae38b5fbfe4f5c1c85175fcd8977c43ae0aa?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/2bcd944ddee4915a331f19dcdc04ae38b5fbfe4f5c1c85175fcd8977c43ae0aa?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/2bcd944ddee4915a331f19dcdc04ae38b5fbfe4f5c1c85175fcd8977c43ae0aa?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://gravatar.com/toyssan1" class="url" rel="ugc external nofollow">treadlite</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13992">2015/04/07 at 22:26</a></div>

		<div class="comment-body"><p>I have been working on a similar project and I have been using the STM32F.  I have this working with the 105 series, and 407 series.  I am working on an OBD2 simulator and was able to get it working with very little code at least for proof of concept.</p>
<p>My goal is to have a fully open source OBD2 simulator with all protocols.  CAN was pretty easy using the MCP2551 chips,  but now I need to develop the others, specifically 9141 LIN protocol.</p>
<p>I am using the SN65HVDA195-Q1 lin transiever, which I have also succsesfuly got working on my own LIN network.  Next goal is to get it working with the 5 baud init then switch to the 10500, but I have run into a problem with time.</p>
<p>Would anyone be interested in working on the ISO 9141 OBD protocol?</p>
<p>BTW, I have been using the STM32F discovery boards.  They use the STM32F407 and they are only $15 from digikey.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=13992#respond" data-commentid="13992" data-postid="1419" data-belowelement="comment-13992" data-respondelement="respond" data-replyto="Reply to treadlite" aria-label="Reply to treadlite">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2" id="li-comment-13999">
		<div id="comment-13999">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13999">2015/04/08 at 05:38</a></div>

		<div class="comment-body"><p>Is it an open source project? Link the code! :-) Why do you care about ISO 9141? It&#8217;s basically gone in new cars anyway&#8230;</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=13999#respond" data-commentid="13999" data-postid="1419" data-belowelement="comment-13999" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-toyssan1 even depth-3" id="li-comment-14008">
		<div id="comment-14008">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='treadlite&#039;s avatar' src='https://2.gravatar.com/avatar/2bcd944ddee4915a331f19dcdc04ae38b5fbfe4f5c1c85175fcd8977c43ae0aa?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/2bcd944ddee4915a331f19dcdc04ae38b5fbfe4f5c1c85175fcd8977c43ae0aa?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/2bcd944ddee4915a331f19dcdc04ae38b5fbfe4f5c1c85175fcd8977c43ae0aa?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/2bcd944ddee4915a331f19dcdc04ae38b5fbfe4f5c1c85175fcd8977c43ae0aa?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/2bcd944ddee4915a331f19dcdc04ae38b5fbfe4f5c1c85175fcd8977c43ae0aa?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/2bcd944ddee4915a331f19dcdc04ae38b5fbfe4f5c1c85175fcd8977c43ae0aa?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">toyssan1</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14008">2015/04/08 at 17:58</a></div>

		<div class="comment-body"><p>I will create a git repo and link it here in the next few days.  It is very minimal code though, but helping others with a jumping off point would be great&#8230;I myself am not much of a developer.</p>
<p>Still a lot of cars on the road that are not CAN and will be for quite some time.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-14054">
		<div id="comment-14054">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Mirsat Murutoglu&#039;s avatar' src='https://0.gravatar.com/avatar/f97da7e7103806fffd88609dc8b99b94d74688c9880e29ada1132c15b3712518?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/f97da7e7103806fffd88609dc8b99b94d74688c9880e29ada1132c15b3712518?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/f97da7e7103806fffd88609dc8b99b94d74688c9880e29ada1132c15b3712518?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/f97da7e7103806fffd88609dc8b99b94d74688c9880e29ada1132c15b3712518?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/f97da7e7103806fffd88609dc8b99b94d74688c9880e29ada1132c15b3712518?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/f97da7e7103806fffd88609dc8b99b94d74688c9880e29ada1132c15b3712518?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">Mirsat Murutoglu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14054">2015/04/11 at 17:00</a></div>

		<div class="comment-body"><p>Hi,</p>
<p>Thanks for your assistance to let us know more about CAN. I have used a phyton sniffer and arduino can-bus shiled to analyse the data. Im trying to figure out how aircon works. I have found all the related CAN-BUS ids and datas for the aircon. When i send them back it doesn’t care my data it keeps sending its own data. I used this way to lock unlock the doors, open the windows, move the seats, lights and so on. i used the aircon id and  data for same brand car but different model it worked. I wonder that it maybe LIN-BUS or something else? here is my id and sample data for fan level and temperature:<br />
CAN ID: 856, data: 0, 0, 0, 0, 21, 21, 153, 17<br />
CAN ID: 856, data: 0, 0, 0, 0, 21, 21, 153, 34<br />
CAN ID: 856, data: 0, 0, 0, 0, 21, 21, 153, 51</p>
<p>17,34 and 51 are for fan level and 21 is for temperature<br />
The car is 2015 Model.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14054#respond" data-commentid="14054" data-postid="1419" data-belowelement="comment-14054" data-respondelement="respond" data-replyto="Reply to Mirsat Murutoglu" aria-label="Reply to Mirsat Murutoglu">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-14079">
		<div id="comment-14079">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14079">2015/04/12 at 23:18</a></div>

		<div class="comment-body"><p>Hi Mirsat, no idea how to help you, CAN connected ECU typically works by sending the data on the bus periodically, so the one you are injecting is probably being immediately overwritten by the original one. It may work if the data is not periodic, so it may be that the same frame is used in different way in different versions of the ECU (maybe in one version is periodic and some other is not).</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14079#respond" data-commentid="14079" data-postid="1419" data-belowelement="comment-14079" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1" id="li-comment-14083">
		<div id="comment-14083">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Mirsat Murutoglu&#039;s avatar' src='https://0.gravatar.com/avatar/f97da7e7103806fffd88609dc8b99b94d74688c9880e29ada1132c15b3712518?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/f97da7e7103806fffd88609dc8b99b94d74688c9880e29ada1132c15b3712518?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/f97da7e7103806fffd88609dc8b99b94d74688c9880e29ada1132c15b3712518?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/f97da7e7103806fffd88609dc8b99b94d74688c9880e29ada1132c15b3712518?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/f97da7e7103806fffd88609dc8b99b94d74688c9880e29ada1132c15b3712518?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/f97da7e7103806fffd88609dc8b99b94d74688c9880e29ada1132c15b3712518?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">Mirsat Murutoglu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14083">2015/04/13 at 07:03</a></div>

		<div class="comment-body"><p>Actually both cars send the same data and same id periodically but one is responding my data other one is keep sending its own data and do its way. Even i send my data more than the original one.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14083#respond" data-commentid="14083" data-postid="1419" data-belowelement="comment-14083" data-respondelement="respond" data-replyto="Reply to Mirsat Murutoglu" aria-label="Reply to Mirsat Murutoglu">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-14099">
		<div id="comment-14099">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14099">2015/04/14 at 20:12</a></div>

		<div class="comment-body"><p>That&#8217;s awkward&#8230; no idea what&#8217;s going on there.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14099#respond" data-commentid="14099" data-postid="1419" data-belowelement="comment-14099" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment odd alt depth-3" id="li-comment-14108">
		<div id="comment-14108">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Mirsat Murutoglu&#039;s avatar' src='https://0.gravatar.com/avatar/f97da7e7103806fffd88609dc8b99b94d74688c9880e29ada1132c15b3712518?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/f97da7e7103806fffd88609dc8b99b94d74688c9880e29ada1132c15b3712518?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/f97da7e7103806fffd88609dc8b99b94d74688c9880e29ada1132c15b3712518?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/f97da7e7103806fffd88609dc8b99b94d74688c9880e29ada1132c15b3712518?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/f97da7e7103806fffd88609dc8b99b94d74688c9880e29ada1132c15b3712518?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/f97da7e7103806fffd88609dc8b99b94d74688c9880e29ada1132c15b3712518?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">Mirsat Murutoglu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14108">2015/04/15 at 09:14</a></div>

		<div class="comment-body"><p>Yepp thats what i am trying to do ,I will let you know if i do it. Thanks</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1" id="li-comment-14179">
		<div id="comment-14179">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Sarthak Jain&#039;s avatar' src='https://graph.facebook.com/v2.2/100001472121713/picture?type=large&#038;_md5=d790d6833f6711148435e7b4d9617c76' srcset='https://graph.facebook.com/v2.2/100001472121713/picture?type=large&#038;_md5=d790d6833f6711148435e7b4d9617c76 1x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large&#038;_md5=d790d6833f6711148435e7b4d9617c76 1.5x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large&#038;_md5=d790d6833f6711148435e7b4d9617c76 2x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large&#038;_md5=d790d6833f6711148435e7b4d9617c76 3x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large&#038;_md5=d790d6833f6711148435e7b4d9617c76 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://www.facebook.com/100001472121713" class="url" rel="ugc external nofollow">Sarthak Jain</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14179">2015/04/21 at 05:28</a></div>

		<div class="comment-body"><p>Hey,</p>
<p>I was able to get the data from the car via USB2CAN converter.</p>
<p>&#8216;candump&#8217; is working fine but when I use &#8216;cansend&#8217; in a while loop, it is showing an error &#8211; &#8220;write:no buffer space&#8221;.</p>
<p>Can you comment on this?</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14179#respond" data-commentid="14179" data-postid="1419" data-belowelement="comment-14179" data-respondelement="respond" data-replyto="Reply to Sarthak Jain" aria-label="Reply to Sarthak Jain">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2" id="li-comment-14200">
		<div id="comment-14200">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14200">2015/04/23 at 18:26</a></div>

		<div class="comment-body"><p>That happens if no devices on the bus are acknowledging a frame in the tx queue. Are you transmitting on the car bus or on a loopback interface?</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14200#respond" data-commentid="14200" data-postid="1419" data-belowelement="comment-14200" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="li-comment-14206">
		<div id="comment-14206">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Sarthak Jain&#039;s avatar' src='https://graph.facebook.com/v2.2/100001472121713/picture?type=large&#038;_md5=d790d6833f6711148435e7b4d9617c76' srcset='https://graph.facebook.com/v2.2/100001472121713/picture?type=large&#038;_md5=d790d6833f6711148435e7b4d9617c76 1x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large&#038;_md5=d790d6833f6711148435e7b4d9617c76 1.5x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large&#038;_md5=d790d6833f6711148435e7b4d9617c76 2x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large&#038;_md5=d790d6833f6711148435e7b4d9617c76 3x, https://graph.facebook.com/v2.2/100001472121713/picture?type=large&#038;_md5=d790d6833f6711148435e7b4d9617c76 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://www.facebook.com/100001472121713" class="url" rel="ugc external nofollow">Sarthak Jain</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14206">2015/04/24 at 14:01</a></div>

		<div class="comment-body"><p>Yes, I am transmitting on the can bus itself.</p>
<p>I actually first recorded some packets responsible for some action. And then I replayed the same packet but reducing the ID by 8.<br />
For ex &#8211; If the packet is &#8216;3E8 F5&#8217;, then I will send &#8216;3E0 F5&#8217; because when a controller transmits some packets, it does it by adding 8 to its identifier. So the actual ID in the previous case is not &#8216;3E8&#8217; but &#8216;3E0&#8217;.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14206#respond" data-commentid="14206" data-postid="1419" data-belowelement="comment-14206" data-respondelement="respond" data-replyto="Reply to Sarthak Jain" aria-label="Reply to Sarthak Jain">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2" id="li-comment-14231">
		<div id="comment-14231">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14231">2015/04/26 at 14:30</a></div>

		<div class="comment-body"><p>Ok, in that case it may be that none of the nodes in the bus are acknowledging that frame ID.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14231#respond" data-commentid="14231" data-postid="1419" data-belowelement="comment-14231" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1" id="li-comment-14992">
		<div id="comment-14992">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Chris&#039;s avatar' src='https://0.gravatar.com/avatar/f3aa8881e47dfbc3761f97ddbf39c29f76a1077c0e664ee91b29343cb5a5f3fc?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/f3aa8881e47dfbc3761f97ddbf39c29f76a1077c0e664ee91b29343cb5a5f3fc?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/f3aa8881e47dfbc3761f97ddbf39c29f76a1077c0e664ee91b29343cb5a5f3fc?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/f3aa8881e47dfbc3761f97ddbf39c29f76a1077c0e664ee91b29343cb5a5f3fc?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/f3aa8881e47dfbc3761f97ddbf39c29f76a1077c0e664ee91b29343cb5a5f3fc?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/f3aa8881e47dfbc3761f97ddbf39c29f76a1077c0e664ee91b29343cb5a5f3fc?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">Chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14992">2015/07/17 at 16:01</a></div>

		<div class="comment-body"><p>Hi.</p>
<p>My friend is trying to build a device (rasberry pi) that will act as a go-between for two different cam buses that run at different speed.  He simply wants to pass the cambus data from one to the other, with possibly some translation of the codes inbetween.  Is this easily possible or do you know of any code or device that will do it?<br />
Thanks!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14992#respond" data-commentid="14992" data-postid="1419" data-belowelement="comment-14992" data-respondelement="respond" data-replyto="Reply to Chris" aria-label="Reply to Chris">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment odd alt depth-2" id="li-comment-14993">
		<div id="comment-14993">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Chris&#039;s avatar' src='https://0.gravatar.com/avatar/f3aa8881e47dfbc3761f97ddbf39c29f76a1077c0e664ee91b29343cb5a5f3fc?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/f3aa8881e47dfbc3761f97ddbf39c29f76a1077c0e664ee91b29343cb5a5f3fc?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/f3aa8881e47dfbc3761f97ddbf39c29f76a1077c0e664ee91b29343cb5a5f3fc?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/f3aa8881e47dfbc3761f97ddbf39c29f76a1077c0e664ee91b29343cb5a5f3fc?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/f3aa8881e47dfbc3761f97ddbf39c29f76a1077c0e664ee91b29343cb5a5f3fc?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/f3aa8881e47dfbc3761f97ddbf39c29f76a1077c0e664ee91b29343cb5a5f3fc?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">Chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14993">2015/07/17 at 16:02</a></div>

		<div class="comment-body"><p>Canbus, not cambus!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14993#respond" data-commentid="14993" data-postid="1419" data-belowelement="comment-14993" data-respondelement="respond" data-replyto="Reply to Chris" aria-label="Reply to Chris">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-14998">
		<div id="comment-14998">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14998">2015/07/17 at 19:38</a></div>

		<div class="comment-body"><p>Hey Chris, I think that cars with multiple bus commonly include that functionality in some node. You want to make sure to not overrun on the slow bus write queue.</p>
<p>I would suggest you to avoid using a rPI for this, unless you can connect a CAN interface that can handle the two busses at full speed. It&#8217;s tempting to use an SPI controller (the MCP2515 is very common), but that has terrible performances on highly loaded fast busses, and you will end up with problem such as RX buffer underruns and out-of-order frames. You should look into SoCs with two embedded controllers, the AM335x used in the BeagleBone Black with an appropriate cape may be ok &#8211; but whatever design you take make sure to load test it.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14998#respond" data-commentid="14998" data-postid="1419" data-belowelement="comment-14998" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment odd alt depth-3" id="li-comment-14999">
		<div id="comment-14999">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Chris&#039;s avatar' src='https://0.gravatar.com/avatar/f3aa8881e47dfbc3761f97ddbf39c29f76a1077c0e664ee91b29343cb5a5f3fc?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/f3aa8881e47dfbc3761f97ddbf39c29f76a1077c0e664ee91b29343cb5a5f3fc?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/f3aa8881e47dfbc3761f97ddbf39c29f76a1077c0e664ee91b29343cb5a5f3fc?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/f3aa8881e47dfbc3761f97ddbf39c29f76a1077c0e664ee91b29343cb5a5f3fc?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/f3aa8881e47dfbc3761f97ddbf39c29f76a1077c0e664ee91b29343cb5a5f3fc?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/f3aa8881e47dfbc3761f97ddbf39c29f76a1077c0e664ee91b29343cb5a5f3fc?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">Chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14999">2015/07/17 at 22:57</a></div>

		<div class="comment-body"><p>Thanks for that info fabio.</p>
<p>He says he&#8217;s bought a can-bus shield for the pi that can support two canbus inputs.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment byuser comment-author-toyssan1 even depth-2" id="li-comment-19169">
		<div id="comment-19169">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='treadlite&#039;s avatar' src='https://2.gravatar.com/avatar/2bcd944ddee4915a331f19dcdc04ae38b5fbfe4f5c1c85175fcd8977c43ae0aa?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/2bcd944ddee4915a331f19dcdc04ae38b5fbfe4f5c1c85175fcd8977c43ae0aa?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/2bcd944ddee4915a331f19dcdc04ae38b5fbfe4f5c1c85175fcd8977c43ae0aa?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/2bcd944ddee4915a331f19dcdc04ae38b5fbfe4f5c1c85175fcd8977c43ae0aa?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/2bcd944ddee4915a331f19dcdc04ae38b5fbfe4f5c1c85175fcd8977c43ae0aa?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/2bcd944ddee4915a331f19dcdc04ae38b5fbfe4f5c1c85175fcd8977c43ae0aa?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">treadlite</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19169">2016/07/12 at 02:22</a></div>

		<div class="comment-body"><p>Yes, you can do this.  I have actually built hardware specifically for this purpose using stm32 processors.  I added Bluetooth, wifi and some on board memory  in order to make it configurable without re-coding</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=19169#respond" data-commentid="19169" data-postid="1419" data-belowelement="comment-19169" data-respondelement="respond" data-replyto="Reply to treadlite" aria-label="Reply to treadlite">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1" id="li-comment-15116">
		<div id="comment-15116">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='andrea canestrari&#039;s avatar' src='https://0.gravatar.com/avatar/9a5634010c092762147b7ee23df1cf66abf31a636337f808edab60808e9a066a?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/9a5634010c092762147b7ee23df1cf66abf31a636337f808edab60808e9a066a?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/9a5634010c092762147b7ee23df1cf66abf31a636337f808edab60808e9a066a?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/9a5634010c092762147b7ee23df1cf66abf31a636337f808edab60808e9a066a?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/9a5634010c092762147b7ee23df1cf66abf31a636337f808edab60808e9a066a?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/9a5634010c092762147b7ee23df1cf66abf31a636337f808edab60808e9a066a?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">andrea canestrari</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-15116">2015/07/24 at 11:50</a></div>

		<div class="comment-body"><p>Hi Fabio, we are practically working with the same project I have two raspberry b + with the card pican, works can send messages and read them to each other with instructions and cansend candump, but are raw hexadecimal values.</p>
<p>my problem is to create a code for raspian to show me just a parameter for example, this implementation will have to be installed in a vehicle and would like to show to the screen for example, only the position of the accelerator pedal, I looked at your project and what I would do too I but of raspberry, you are able to create this? You have resources where I can read up.</p>
<p>grazie per quello che hai postato fino ad ora è stato veramente utile chiaro e puntuale.</p>
<p>a presto</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=15116#respond" data-commentid="15116" data-postid="1419" data-belowelement="comment-15116" data-respondelement="respond" data-replyto="Reply to andrea canestrari" aria-label="Reply to andrea canestrari">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-15260">
		<div id="comment-15260">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-15260">2015/08/05 at 20:47</a></div>

		<div class="comment-body"><p>Hey Andrea, the code I posted as an example does something similar and should build fine on any architecture&#8230; You may use that as a starting point. :-)</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=15260#respond" data-commentid="15260" data-postid="1419" data-belowelement="comment-15260" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-18507">
		<div id="comment-18507">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Daksh Vasistha&#039;s avatar' src='https://2.gravatar.com/avatar/2d346e2f1df5b64bfc120e1334e594a0873ea1bc1d9d7df96ad53085977e1871?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/2d346e2f1df5b64bfc120e1334e594a0873ea1bc1d9d7df96ad53085977e1871?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/2d346e2f1df5b64bfc120e1334e594a0873ea1bc1d9d7df96ad53085977e1871?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/2d346e2f1df5b64bfc120e1334e594a0873ea1bc1d9d7df96ad53085977e1871?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/2d346e2f1df5b64bfc120e1334e594a0873ea1bc1d9d7df96ad53085977e1871?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/2d346e2f1df5b64bfc120e1334e594a0873ea1bc1d9d7df96ad53085977e1871?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">Daksh Vasistha</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-18507">2016/03/21 at 03:58</a></div>

		<div class="comment-body"><p>Great Work, one question, can we also see acknowledgement information in the logs?<br />
Like when ECU sends negative ACK or positive ACK to sender after receiving packet.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=18507#respond" data-commentid="18507" data-postid="1419" data-belowelement="comment-18507" data-respondelement="respond" data-replyto="Reply to Daksh Vasistha" aria-label="Reply to Daksh Vasistha">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-18554">
		<div id="comment-18554">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-18554">2016/03/25 at 00:30</a></div>

		<div class="comment-body"><p>Hey Daksh, sort of. First, there&#8217;s no such thing as a negative ACK as far as I&#8217;m aware of: once a frame is on the wire it either gets ACKed from at least one of the other nodes or not (see the note about ACK slot in the frame format I posted).</p>
<p>ACKs in CANBUS are weird, depending on how transmitter and receiver nodes are configured you may have different things happening:<br />
&#8211; the receiver ACKs anything that matches the acceptance filter unless it&#8217;s in listen-only mode. I don&#8217;t know if any CAN controller can go into listen-only mode and expose whether a frame has been ACKed by some other node or not, but the MCP2515, the SJA1000 and socketcan itself does not seem to support this.<br />
&#8211; if the transmitter is sending in one-shot mode, it&#8217;s just going to put the frame on the wire and stop regardless of the fact that any other node acknowledged or not.<br />
&#8211; if the transmitter is in normal mode and no other node ACKs a frame, the frame gets re-sent indefinitely (you can see this happening on a listen-only node).</p>
<p>Either way, to get the information on what&#8217;s going on with the ACKs on the bus I think you may need to use a logic analyzer that supports CANBUS decoding, so that you can tap into a live bus and see if anything is transmitting dominant bits on the ACK slot.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=18554#respond" data-commentid="18554" data-postid="1419" data-belowelement="comment-18554" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1" id="li-comment-18654">
		<div id="comment-18654">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='xavier M&#039;s avatar' src='https://0.gravatar.com/avatar/30da564bab5f9c6e98b2ff045c22ddf253390e8d67d4b29f04562a8600492523?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/30da564bab5f9c6e98b2ff045c22ddf253390e8d67d4b29f04562a8600492523?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/30da564bab5f9c6e98b2ff045c22ddf253390e8d67d4b29f04562a8600492523?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/30da564bab5f9c6e98b2ff045c22ddf253390e8d67d4b29f04562a8600492523?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/30da564bab5f9c6e98b2ff045c22ddf253390e8d67d4b29f04562a8600492523?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/30da564bab5f9c6e98b2ff045c22ddf253390e8d67d4b29f04562a8600492523?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">xavier M</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-18654">2016/03/30 at 01:40</a></div>

		<div class="comment-body"><p>Hi Fabio,</p>
<p>Is it possible to run this c program on my i.mx6 board? How would I compile the code and run it on my embedded device? I&#8217;m very new to linux and just need a point in the right direction.</p>
<p>Thanks</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=18654#respond" data-commentid="18654" data-postid="1419" data-belowelement="comment-18654" data-respondelement="respond" data-replyto="Reply to xavier M" aria-label="Reply to xavier M">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-18678">
		<div id="comment-18678">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-18678">2016/03/31 at 22:30</a></div>

		<div class="comment-body"><p>Hey Xavier, yeah totally, as you can see from the code this has very few dependencies. Basically you need the compiler (native or cross), the kernel headers for the userspace (that&#8217;s needed for the various #include &lt;linux/&#8230;&gt;), and the ncurses libraries and headers (for the #include &lt;curses.h&gt;. For the former, from how I&#8217;ve set up the makefile you need to have ncurses5-config in the PATH).</p>
<p>If you have everything give it a &#8220;make&#8221; and it should build. If you are cross compiling make sure to specify the cross compiler, something like &#8220;CC=arm-linux-gnueabi-gcc make&#8221;.</p>
<p>Cheers!<br />
Fabio</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=18678#respond" data-commentid="18678" data-postid="1419" data-belowelement="comment-18678" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-19165">
		<div id="comment-19165">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Daniel Kowalsky&#039;s avatar' src='https://0.gravatar.com/avatar/379fe769950f7294dd05ad56452e2471d194da72d20917131a0786abd1734c6e?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/379fe769950f7294dd05ad56452e2471d194da72d20917131a0786abd1734c6e?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/379fe769950f7294dd05ad56452e2471d194da72d20917131a0786abd1734c6e?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/379fe769950f7294dd05ad56452e2471d194da72d20917131a0786abd1734c6e?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/379fe769950f7294dd05ad56452e2471d194da72d20917131a0786abd1734c6e?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/379fe769950f7294dd05ad56452e2471d194da72d20917131a0786abd1734c6e?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://gravatar.com/dkowalsky7" class="url" rel="ugc external nofollow">Daniel Kowalsky</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19165">2016/07/11 at 23:04</a></div>

		<div class="comment-body"><p>First off this is an awesome post. I have been putting this method to work on a few cars at home. I am doing an experiment with a VW E-Golf and I need the % charge of the battery, which is unfortunately not available through OBD2.</p>
<p>I have been successfully in decoding some CAN data on other cars, however on the E-Golf, only one pid is returned every couple of second. I thought it could be and error frame (only because I had not seen any of these yet). The values of the frame stay the same and are 20 01 00 00 00 00 00 80. I tried hitting buttons and driving and they didn&#8217;t change. I tried to print just the error frames using the 0~0 on socketcan and still nothing.</p>
<p>Is it possible that I need to access another CANBUS on the car? Or does this seem odd to you as well. I would think (from what I have seen and read) that there should be more than one pid on the system. I had set the bitrate to 500,000 and thought maybe I had that setting wrong. I tried the other standard rates 10k,20k,100k,125k,250k,800k,1000k and they all print nothing. A VW manual for the BUS system stated that 500k was used for high speed data rates.</p>
<p>If you could shed any light on the matter, it would be greatly appreciated.</p>
<p>Best,<br />
Dan</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=19165#respond" data-commentid="19165" data-postid="1419" data-belowelement="comment-19165" data-respondelement="respond" data-replyto="Reply to Daniel Kowalsky" aria-label="Reply to Daniel Kowalsky">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-19168">
		<div id="comment-19168">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19168">2016/07/12 at 02:07</a></div>

		<div class="comment-body"><p>Hey Dan, that&#8217;s a nice modern car packed with electronics&#8230; I would not be surprised if the CAN on the OBD connector is for OBD only and there are one or two other dedicated busses for high speed critical stuff. I&#8217;ve actually read of other cars with this setup (some Volvo). If you want to be sure you can check the signal with a scope but since you are getting something reasonable it may be indeed all that is in that bus.</p>
<p>The charge status and other information should be sent to the central dashboard somehow. I would start by taking that off the console and look for a twisted pair on the data connector on its back. Then you can either figure if that also ends on the OBD port in some of the vendor specific pins, or just splice a tap from there and start looking for your number.</p>
<p>Good luck with that! Can&#8217;t wait to hear the progress. :-)</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=19168#respond" data-commentid="19168" data-postid="1419" data-belowelement="comment-19168" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-dkowalsky7 odd alt depth-3" id="li-comment-19172">
		<div id="comment-19172">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='dkowalsky7&#039;s avatar' src='https://0.gravatar.com/avatar/379fe769950f7294dd05ad56452e2471d194da72d20917131a0786abd1734c6e?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/379fe769950f7294dd05ad56452e2471d194da72d20917131a0786abd1734c6e?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/379fe769950f7294dd05ad56452e2471d194da72d20917131a0786abd1734c6e?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/379fe769950f7294dd05ad56452e2471d194da72d20917131a0786abd1734c6e?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/379fe769950f7294dd05ad56452e2471d194da72d20917131a0786abd1734c6e?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/379fe769950f7294dd05ad56452e2471d194da72d20917131a0786abd1734c6e?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://dkowalsky7.wordpress.com" class="url" rel="ugc external nofollow">dkowalsky7</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19172">2016/07/12 at 05:14</a></div>

		<div class="comment-body"><p>I think your 100% right this guy was saying something similar about the bus connected to the obd2 only being used to send information. He used the back of the radio, not sure if this will work from me, but it can display similar information as the dash. I cannot go around splicing wires because the car is lease so if i can use a harness to splice wires, I think i will be safer. I appreciate the reply I will post with the results!</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-dkowalsky7 even depth-3" id="li-comment-19173">
		<div id="comment-19173">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='dkowalsky7&#039;s avatar' src='https://0.gravatar.com/avatar/379fe769950f7294dd05ad56452e2471d194da72d20917131a0786abd1734c6e?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/379fe769950f7294dd05ad56452e2471d194da72d20917131a0786abd1734c6e?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/379fe769950f7294dd05ad56452e2471d194da72d20917131a0786abd1734c6e?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/379fe769950f7294dd05ad56452e2471d194da72d20917131a0786abd1734c6e?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/379fe769950f7294dd05ad56452e2471d194da72d20917131a0786abd1734c6e?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/379fe769950f7294dd05ad56452e2471d194da72d20917131a0786abd1734c6e?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://dkowalsky7.wordpress.com" class="url" rel="ugc external nofollow">dkowalsky7</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19173">2016/07/12 at 05:15</a></div>

		<div class="comment-body"><p><a href="http://chadgibbons.com/2013/12/29/hacking-the-jeep-interior-can-bus/comment-page-2/#comment-43746" rel="nofollow ugc">http://chadgibbons.com/2013/12/29/hacking-the-jeep-interior-can-bus/comment-page-2/#comment-43746</a></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment byuser comment-author-kurtdaveting odd alt thread-even depth-1" id="li-comment-19274">
		<div id="comment-19274">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='kurt&#039;s avatar' src='https://1.gravatar.com/avatar/d50cff5d58d7b3dc57144b0c05f0f11bde5c20ed333c72a696063c7b1a661912?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/d50cff5d58d7b3dc57144b0c05f0f11bde5c20ed333c72a696063c7b1a661912?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/d50cff5d58d7b3dc57144b0c05f0f11bde5c20ed333c72a696063c7b1a661912?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/d50cff5d58d7b3dc57144b0c05f0f11bde5c20ed333c72a696063c7b1a661912?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/d50cff5d58d7b3dc57144b0c05f0f11bde5c20ed333c72a696063c7b1a661912?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/d50cff5d58d7b3dc57144b0c05f0f11bde5c20ed333c72a696063c7b1a661912?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://coolkidkurt.wordpress.com" class="url" rel="ugc external nofollow">kurt</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19274">2016/08/28 at 10:40</a></div>

		<div class="comment-body"><p>Currently I&#8217;ve been trying to reprogram my instrument cluster for information display changes.My current project is on a Toyota Corolla 2014. Current information display have the following options available to the user:</p>
<p>Average Fuel Consumption<br />
Cruising Range until empty<br />
Trip Elapsed Time<br />
Average Speed<br />
Realtime Fuel Consuption<br />
Setting (for brightness etc)<br />
The display cluster is controlled by a single button for switching displays. My project consists of changing ( or possibly ) adding a menu. For the displays that is subject to change, I want to replace the Average Speed display to Current Speed. Also, if possible, I want to add a menu for displaying Engine Load and Voltage Meter.</p>
<p>How can I reprogram the instrument cluster? Can i do it via OBD2? Also, what tools do i need? Any feedback would be greatly appreciated. Thank you.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=19274#respond" data-commentid="19274" data-postid="1419" data-belowelement="comment-19274" data-respondelement="respond" data-replyto="Reply to kurt" aria-label="Reply to kurt">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-19275">
		<div id="comment-19275">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19275">2016/08/28 at 16:21</a></div>

		<div class="comment-body"><p>Hey Kurt, hard to say if and how that can be done. Sounds like you need to identify the device controlling the menu, dump the firmware, and hack it or rewrite it from scratch to add what you need. A good starting point may be to take the instrument cluster apart and reverse engineer it&#8230; assuming that it&#8217;s not just a dumb display and the actual data is generated from the car radio or some other ECU.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=19275#respond" data-commentid="19275" data-postid="1419" data-belowelement="comment-19275" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-19604">
		<div id="comment-19604">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='San&#039;s avatar' src='https://2.gravatar.com/avatar/5885b882fcacd86adb5a793842b7fe50b3c320affef71c402649205961c9dbec?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/5885b882fcacd86adb5a793842b7fe50b3c320affef71c402649205961c9dbec?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/5885b882fcacd86adb5a793842b7fe50b3c320affef71c402649205961c9dbec?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/5885b882fcacd86adb5a793842b7fe50b3c320affef71c402649205961c9dbec?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/5885b882fcacd86adb5a793842b7fe50b3c320affef71c402649205961c9dbec?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/5885b882fcacd86adb5a793842b7fe50b3c320affef71c402649205961c9dbec?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">San</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19604">2017/01/05 at 11:20</a></div>

		<div class="comment-body"><p>Ciao Fabio,<br />
complimenti per l&#8217;articolo. Un bel lavoro da parte tua e molto interessante. Sto facendo varie ricerche per poter fare il dump del firmware della mia auto (Fiat Tipo 2016) che ha come sistema uConnect (basato su qnx). Hai mai provato su questa auto? Qualche dritta hw/sw da utilizzare per poter fare il dump ed un possibile reverse engineering? L&#8217;auto in questione ovviamente ha OBD2, porta USB e BT.<br />
Grazie.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=19604#respond" data-commentid="19604" data-postid="1419" data-belowelement="comment-19604" data-respondelement="respond" data-replyto="Reply to San" aria-label="Reply to San">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2" id="li-comment-19615">
		<div id="comment-19615">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19615">2017/01/07 at 21:55</a></div>

		<div class="comment-body"><p>Ciao! Nessuna esperienza diretta ma da quanto so i comandi per accedere al firmware vanno sbloccati in qualche modo&#8230; challange authentication e altri meccanismi. Ti consiglio di guardare questo talk registrato al CCC qualche settimana fa, parla esattamente di dump firmware e memoria via CAN: <a href="https://media.ccc.de/v/33c3-7904-software_defined_emissions#video" rel="nofollow ugc">https://media.ccc.de/v/33c3-7904-software_defined_emissions#video</a> :-)</p>
<p>TL;DR in english: this is about accessing the ECU firmware via CANBUS, there are some cool details about that in this lecture from 33C3: <a href="https://media.ccc.de/v/33c3-7904-software_defined_emissions#video" rel="nofollow ugc">https://media.ccc.de/v/33c3-7904-software_defined_emissions#video</a></p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=19615#respond" data-commentid="19615" data-postid="1419" data-belowelement="comment-19615" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment odd alt depth-3" id="li-comment-19619">
		<div id="comment-19619">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='san&#039;s avatar' src='https://2.gravatar.com/avatar/5885b882fcacd86adb5a793842b7fe50b3c320affef71c402649205961c9dbec?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/5885b882fcacd86adb5a793842b7fe50b3c320affef71c402649205961c9dbec?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/5885b882fcacd86adb5a793842b7fe50b3c320affef71c402649205961c9dbec?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/5885b882fcacd86adb5a793842b7fe50b3c320affef71c402649205961c9dbec?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/5885b882fcacd86adb5a793842b7fe50b3c320affef71c402649205961c9dbec?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/5885b882fcacd86adb5a793842b7fe50b3c320affef71c402649205961c9dbec?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">san</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19619">2017/01/09 at 09:08</a></div>

		<div class="comment-body"><p>Hi Fabio,<br />
Thanks for reply. I will inform to you about my research.</p>
<p>Best Regards,<br />
San</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="li-comment-19964">
		<div id="comment-19964">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='lalli&#039;s avatar' src='https://2.gravatar.com/avatar/896513f3d63f4cc571512b3eb9fa9b32222ab0fd4da59a046d841859a2bdcf57?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/896513f3d63f4cc571512b3eb9fa9b32222ab0fd4da59a046d841859a2bdcf57?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/896513f3d63f4cc571512b3eb9fa9b32222ab0fd4da59a046d841859a2bdcf57?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/896513f3d63f4cc571512b3eb9fa9b32222ab0fd4da59a046d841859a2bdcf57?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/896513f3d63f4cc571512b3eb9fa9b32222ab0fd4da59a046d841859a2bdcf57?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/896513f3d63f4cc571512b3eb9fa9b32222ab0fd4da59a046d841859a2bdcf57?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">lalli</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19964">2017/04/12 at 14:25</a></div>

		<div class="comment-body"><p>In my project, I need to read CAN data and place that data onto another tool which is developed under Linux. As of my research I came across that Linux kernel supports socket CAN stack. Is it possible to read/write CAN data using Socket CAN stack and place that data on to the tool that is developed under Linux?</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=19964#respond" data-commentid="19964" data-postid="1419" data-belowelement="comment-19964" data-respondelement="respond" data-replyto="Reply to lalli" aria-label="Reply to lalli">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2" id="li-comment-19996">
		<div id="comment-19996">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19996">2017/04/19 at 18:40</a></div>

		<div class="comment-body"><p>Hi! I guess it is as long as you have an API for that tool to inject the data. Is it a public? Just curious of what that is. :-)</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=19996#respond" data-commentid="19996" data-postid="1419" data-belowelement="comment-19996" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment byuser comment-author-manu144x even thread-odd thread-alt depth-1" id="li-comment-20463">
		<div id="comment-20463">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='manu144x&#039;s avatar' src='https://1.gravatar.com/avatar/708c3eabcc48eb9ba2ebbbe675f724502c915b1dea1e9b01fa50f67d8f1d3b1f?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/708c3eabcc48eb9ba2ebbbe675f724502c915b1dea1e9b01fa50f67d8f1d3b1f?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/708c3eabcc48eb9ba2ebbbe675f724502c915b1dea1e9b01fa50f67d8f1d3b1f?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/708c3eabcc48eb9ba2ebbbe675f724502c915b1dea1e9b01fa50f67d8f1d3b1f?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/708c3eabcc48eb9ba2ebbbe675f724502c915b1dea1e9b01fa50f67d8f1d3b1f?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/708c3eabcc48eb9ba2ebbbe675f724502c915b1dea1e9b01fa50f67d8f1d3b1f?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://www.kloampa.net/" class="url" rel="ugc external nofollow">manu144x</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-20463">2017/06/06 at 19:08</a></div>

		<div class="comment-body"><p>I got inspired by your project, studied around and finally got to purchase a USB2CAN interface (<a href="http://shop.8devices.com/index.php?route=product/product&#038;product_id=54" rel="nofollow ugc">http://shop.8devices.com/index.php?route=product/product&#038;product_id=54</a>) and a an OBD to DB9 cable however as soon as I initialize the interface, everything goes crazy in the car. I get every possible error, and usually after I take the interface out and restart the car all is good.</p>
<p>My car is a Peugeot 508, and I found out it&#8217;s using 11bit 500kbps CAN protocol. I assume I am doing something wrong? The interface supports up to 1Mbit buses, and everybody was praising it. I wanted to use it to capture information, and mostly just learn since it&#8217;s also a hybrid liek your toyota :)</p>
<p>If you have any hints or things I should try, let me know. Thank you.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=20463#respond" data-commentid="20463" data-postid="1419" data-belowelement="comment-20463" data-respondelement="respond" data-replyto="Reply to manu144x" aria-label="Reply to manu144x">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2" id="li-comment-20480">
		<div id="comment-20480">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-20480">2017/06/08 at 23:08</a></div>

		<div class="comment-body"><p>Hi! I would start by verifying that the cable is wired correctly for the device. From what I remember the OBD-DB9 wiring on common cables was different from the DB9 CANBUS wiring commonly used in industrial applications (which is surely the one for the 8devices adapter). I&#8217;ve always used a custom cable for my tests (terminated on a 8P8C actually). If you are confident that the wiring is correct, make sure to put the interface in listen-only mode. That way even if you get the wrong bitrate, it should not make noise on the bus. Keep us posted!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=20480#respond" data-commentid="20480" data-postid="1419" data-belowelement="comment-20480" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-manu144x even depth-3" id="li-comment-20538">
		<div id="comment-20538">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='manu144x&#039;s avatar' src='https://1.gravatar.com/avatar/708c3eabcc48eb9ba2ebbbe675f724502c915b1dea1e9b01fa50f67d8f1d3b1f?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/708c3eabcc48eb9ba2ebbbe675f724502c915b1dea1e9b01fa50f67d8f1d3b1f?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/708c3eabcc48eb9ba2ebbbe675f724502c915b1dea1e9b01fa50f67d8f1d3b1f?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/708c3eabcc48eb9ba2ebbbe675f724502c915b1dea1e9b01fa50f67d8f1d3b1f?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/708c3eabcc48eb9ba2ebbbe675f724502c915b1dea1e9b01fa50f67d8f1d3b1f?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/708c3eabcc48eb9ba2ebbbe675f724502c915b1dea1e9b01fa50f67d8f1d3b1f?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="http://www.kloampa.net/" class="url" rel="ugc external nofollow">manu144x</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-20538">2017/06/17 at 15:41</a></div>

		<div class="comment-body"><p>Well you were right, that&#8217;s what I suspected too, that the cable is wrong, and I ordered a different one.</p>
<p>Now works perfectly, I initialized it and works, I can see the entire bus :)</p>
<p>Now I don&#8217;t know what bus is exposed on the OBD port, I do know it runs at 500kbps. Mostly I want to enter the comfort bus and learn it, but of course, the big dissapointment now will be identifying the packets.</p>
<p>I found a very interesting provider, they claim to sell CAN packet databases for different brands, I will see if I can get something, even if I have to buy it, I don&#8217;t mind, I want to build a better navigator.</p>
<p>Here is the site btw: <a href="https://www.beijer.com/en/services-solutions/can-solutions/the-beijer-can-database/" rel="nofollow ugc">https://www.beijer.com/en/services-solutions/can-solutions/the-beijer-can-database/</a></p>
<p>Of course if you know a place I could find something, unfortunately since it&#8217;s a french care I am aware I may have to learn french :)</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-3" id="li-comment-20547">
		<div id="comment-20547">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-20547">2017/06/18 at 18:10</a></div>

		<div class="comment-body"><p>Hey well done! 500kbps is fairly fast, the bus is probably not going too far, but who knows&#8230; The list on that website is pretty interesting, gives you some motivation to identify all of those by yourself. I&#8217;m not aware of any public database unfortunately&#8230; bug good luck with the &#8220;french for automotive&#8221; lessons if you find some! :-)</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="li-comment-20537">
		<div id="comment-20537">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Paolo&#039;s avatar' src='https://1.gravatar.com/avatar/736f9613b81cfa42378a4b0baa926789a1c9b7424a209a820e351c32c4135e04?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/736f9613b81cfa42378a4b0baa926789a1c9b7424a209a820e351c32c4135e04?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/736f9613b81cfa42378a4b0baa926789a1c9b7424a209a820e351c32c4135e04?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/736f9613b81cfa42378a4b0baa926789a1c9b7424a209a820e351c32c4135e04?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/736f9613b81cfa42378a4b0baa926789a1c9b7424a209a820e351c32c4135e04?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/736f9613b81cfa42378a4b0baa926789a1c9b7424a209a820e351c32c4135e04?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">Paolo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-20537">2017/06/17 at 15:05</a></div>

		<div class="comment-body"><p>Hello, Any chance to control internal devices such as window or lights in a new Fiat 500 through the canbus ? I made this on a BMW.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=20537#respond" data-commentid="20537" data-postid="1419" data-belowelement="comment-20537" data-respondelement="respond" data-replyto="Reply to Paolo" aria-label="Reply to Paolo">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2" id="li-comment-20546">
		<div id="comment-20546">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-20546">2017/06/18 at 18:05</a></div>

		<div class="comment-body"><p>No idea without trying&#8230; I played a bit with this on a Fiat Bravo, the lights signals were on the bus they may be there only for showing up on the dashboard and not for controlling the actual light. Keep us posted if you do some test!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=20546#respond" data-commentid="20546" data-postid="1419" data-belowelement="comment-20546" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1" id="li-comment-20559">
		<div id="comment-20559">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='George&#039;s avatar' src='https://0.gravatar.com/avatar/0cf17c5eba80de6c0ac757e9120367df9ef27560e8312b90c4d1bb2851eaec60?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/0cf17c5eba80de6c0ac757e9120367df9ef27560e8312b90c4d1bb2851eaec60?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/0cf17c5eba80de6c0ac757e9120367df9ef27560e8312b90c4d1bb2851eaec60?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/0cf17c5eba80de6c0ac757e9120367df9ef27560e8312b90c4d1bb2851eaec60?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/0cf17c5eba80de6c0ac757e9120367df9ef27560e8312b90c4d1bb2851eaec60?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/0cf17c5eba80de6c0ac757e9120367df9ef27560e8312b90c4d1bb2851eaec60?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">George</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-20559">2017/06/21 at 14:37</a></div>

		<div class="comment-body"><p>Hi there, great job at experimenting with the Yaris.<br />
I have a question though; I have a spare instrument cluster (the electronic one just like yours since I changed to the analogue cluster in my 2007 yaris), and I want to find a way to drive the cluster, by information from racing simulators on PC. I have seen videos doing that with an arduino but with German vehicles&#8217; clusters. I was lucky enough to stumble upon your video with the exact same instrument cluster as mine.<br />
Do you by any chance have any idea on how to tackle this? I want the RPM, speed and other data synced with the game&#8217;s on screen speed RPM etc.</p>
<p>How possible do you think it is with this particular cluster?</p>
<p>Cheers from Greece, George.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=20559#respond" data-commentid="20559" data-postid="1419" data-belowelement="comment-20559" data-respondelement="respond" data-replyto="Reply to George" aria-label="Reply to George">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2" id="li-comment-20623">
		<div id="comment-20623">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-20623">2017/07/02 at 20:24</a></div>

		<div class="comment-body"><p>Hi George! Yeah it&#8217;s definitely doable, I did an external custom gear indicator and shiftlight myself for LFS many years ago. You need to figure how to power up and inject the data on the real display, so get a power supply, a CANBUS interface, and try putting some valid speed and rpm frame on the bus (you have the format from my software). If you can get that working you need to find the documentation for external display for your racing simulator and just glue the two together. For LFS it was a simple UDP based interface, you tell the game where to send the data to and your application would get periodic status updates, look for OutGauge in <a href="https://en.lfsmanual.net/wiki/InSim.txt" rel="nofollow ugc">https://en.lfsmanual.net/wiki/InSim.txt</a>. Any other game, I&#8217;ve no idea. :-) Keep us posted!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=20623#respond" data-commentid="20623" data-postid="1419" data-belowelement="comment-20623" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="li-comment-20822">
		<div id="comment-20822">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='J. Zegers&#039;s avatar' src='https://2.gravatar.com/avatar/bb6b0c5200a0ea5e45339da44b81328d02b31b26dd99804559cfbc146c553616?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/bb6b0c5200a0ea5e45339da44b81328d02b31b26dd99804559cfbc146c553616?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/bb6b0c5200a0ea5e45339da44b81328d02b31b26dd99804559cfbc146c553616?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/bb6b0c5200a0ea5e45339da44b81328d02b31b26dd99804559cfbc146c553616?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/bb6b0c5200a0ea5e45339da44b81328d02b31b26dd99804559cfbc146c553616?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/bb6b0c5200a0ea5e45339da44b81328d02b31b26dd99804559cfbc146c553616?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">J. Zegers</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-20822">2017/08/09 at 14:21</a></div>

		<div class="comment-body"><p>Hi,</p>
<p>I am trying to find a way to control the blinker (turn indicator light) of a Toyota Prius (2009). Does anyone know if this a signal on the vehicle&#8217;s CAN bus?<br />
I heard from someone that this signal is not on the CAN bus, but I cannot find anything about this on the internet.</p>
<p>I hope someone can give me some more information on this. Thanks in advance!</p>
<p>Kind regards,<br />
J. Zegers</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=20822#respond" data-commentid="20822" data-postid="1419" data-belowelement="comment-20822" data-respondelement="respond" data-replyto="Reply to J. Zegers" aria-label="Reply to J. Zegers">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2" id="li-comment-20841">
		<div id="comment-20841">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-20841">2017/08/14 at 22:13</a></div>

		<div class="comment-body"><p>Hi! Hard to say&#8230; if you can dump the traffic you should turn the turn indicator on and see if you can find some bit on some frame somewhere that toggles with the control or with the light. You may also try look for some service manual for the instrument cluster and figure if there is a dedicated wiring for it. If that&#8217;s the case, there&#8217;s probably no signal on the bus.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=20841#respond" data-commentid="20841" data-postid="1419" data-belowelement="comment-20841" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1" id="li-comment-21343">
		<div id="comment-21343">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Kevin Buckham&#039;s avatar' src='https://2.gravatar.com/avatar/e0a9c6da06069432a4e2d59b19f9aa0b12e4e929fb47f44b37803f0703fd590f?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/e0a9c6da06069432a4e2d59b19f9aa0b12e4e929fb47f44b37803f0703fd590f?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/e0a9c6da06069432a4e2d59b19f9aa0b12e4e929fb47f44b37803f0703fd590f?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/e0a9c6da06069432a4e2d59b19f9aa0b12e4e929fb47f44b37803f0703fd590f?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/e0a9c6da06069432a4e2d59b19f9aa0b12e4e929fb47f44b37803f0703fd590f?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/e0a9c6da06069432a4e2d59b19f9aa0b12e4e929fb47f44b37803f0703fd590f?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">Kevin Buckham</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-21343">2017/10/26 at 00:18</a></div>

		<div class="comment-body"><p>Would you be willing to share one of your CAN dumps?  I&#8217;m trying to hack the electrical power steering from a similar Toyota into my car and I&#8217;m curious to see if I can convince the power steering ECU that is talking to a car by just playing some data back.   With a little hacking I should be able to modify the wheelspeed CAN messages and maybe (hopefully) have the steering assist change.</p>
<p>The motor I&#8217;ll be using is from a 2007 Yaris, but I&#8217;m still missing the Yaris steering control ECU (should be acquired shortly).</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=21343#respond" data-commentid="21343" data-postid="1419" data-belowelement="comment-21343" data-respondelement="respond" data-replyto="Reply to Kevin Buckham" aria-label="Reply to Kevin Buckham">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2" id="li-comment-21349">
		<div id="comment-21349">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='fabiobaltieri&#039;s avatar' src='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/19dc52d39c0abd25505df4eb4edebc078c725e397f8787bc10208733e5c8f9e2?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com" class="url" rel="ugc external nofollow">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-21349">2017/10/26 at 22:42</a></div>

		<div class="comment-body"><p>Hey Kevin, unfortunately I never committed the dumps from that demo and they are long gone, and I also don&#8217;t have the car anymore.</p>
<p>You should be able to simulate some frame from the source code though&#8230; maybe that&#8217;s enough.</p>
<p>Good luck!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=21349#respond" data-commentid="21349" data-postid="1419" data-belowelement="comment-21349" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment even depth-3" id="li-comment-21353">
		<div id="comment-21353">
		<div class="comment-author vcard">
			<img referrerpolicy="no-referrer" alt='Kevin Buckham&#039;s avatar' src='https://2.gravatar.com/avatar/e0a9c6da06069432a4e2d59b19f9aa0b12e4e929fb47f44b37803f0703fd590f?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/e0a9c6da06069432a4e2d59b19f9aa0b12e4e929fb47f44b37803f0703fd590f?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/e0a9c6da06069432a4e2d59b19f9aa0b12e4e929fb47f44b37803f0703fd590f?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/e0a9c6da06069432a4e2d59b19f9aa0b12e4e929fb47f44b37803f0703fd590f?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/e0a9c6da06069432a4e2d59b19f9aa0b12e4e929fb47f44b37803f0703fd590f?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/e0a9c6da06069432a4e2d59b19f9aa0b12e4e929fb47f44b37803f0703fd590f?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />			<cite class="fn">Kevin Buckham</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-21353">2017/10/27 at 17:30</a></div>

		<div class="comment-body"><p>No problem, thanks for responding!  I&#8217;ll see if I can find a car to borrow for a bit.  :)</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	</ol>


	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://fabiobaltieri.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">


<div class="comment-form__verbum transparent"></div><div class="verbum-form-meta"><input type='hidden' name='comment_post_ID' value='1419' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />

			<input type="hidden" name="highlander_comment_nonce" id="highlander_comment_nonce" value="e4bc36c9db" />
			<input type="hidden" name="verbum_show_subscription_modal" value="" /></div><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="841be1d163" /></p><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="154"/><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
	
</div><!-- #comments -->
	</div>

<div id="sidebar">
			<div id="atatags-262211713-68265cc238589"></div>
			
			<script>
				__ATA.cmd.push(function() {
					__ATA.initDynamicSlot({
						id: 'atatags-262211713-68265cc238589',
						location: 140,
						formFactor: '003',
						label: {
							text: 'Advertisements',
						},
						creative: {
							reportAd: {
								text: 'Report this ad',
							},
							privacySettings: {
								text: 'Privacy',
								
							}
						}
					});
				});
			</script>
	<div id="search-2" class="widget widget_search"><form role="search" method="get" id="searchform" class="searchform" action="https://fabiobaltieri.com/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form></div><div id="categories-3" class="widget widget_categories"><h4>Categories</h4>
			<ul>
					<li class="cat-item cat-item-38819914"><a href="https://fabiobaltieri.com/category/avr-2/">AVR</a> (11)
</li>
	<li class="cat-item cat-item-79"><a href="https://fabiobaltieri.com/category/hardware/">Hardware</a> (23)
</li>
	<li class="cat-item cat-item-34922710"><a href="https://fabiobaltieri.com/category/linux-2/">Linux</a> (14)
</li>
	<li class="cat-item cat-item-7426"><a href="https://fabiobaltieri.com/category/networking/">Networking</a> (15)
</li>
			</ul>

			</div>
		<div id="recent-posts-3" class="widget widget_recent_entries">
		<h4>Recent Posts</h4>
		<ul>
											<li>
					<a href="https://fabiobaltieri.com/2019/09/21/design-analysis-of-a-petzl-actik-core-headlamp/">Design Analysis of a Petzl ACTIK CORE&nbsp;Headlamp</a>
									</li>
											<li>
					<a href="https://fabiobaltieri.com/2014/06/22/lna/">LNA for RTL Based SDR&nbsp;Receivers</a>
									</li>
											<li>
					<a href="https://fabiobaltieri.com/2014/06/15/sensor-breakout/">Breakout Board for Wireless Devices Using the Nordic&nbsp;nRF24L01+</a>
									</li>
											<li>
					<a href="https://fabiobaltieri.com/2013/12/29/power-over-ethernet-flashlight/">Power over Ethernet&nbsp;Flashlight</a>
									</li>
											<li>
					<a href="https://fabiobaltieri.com/2013/11/18/halogen-led/">LED Light Replacement for AC Halogen&nbsp;Lamps</a>
									</li>
											<li>
					<a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/" aria-current="page">Hacking into a Vehicle CAN bus (Toyothack and&nbsp;SocketCAN)</a>
									</li>
											<li>
					<a href="https://fabiobaltieri.com/2013/07/10/inside-a-hantek-dso-2090-usb-oscilloscope/">Inside a Hantek DSO-2090 USB&nbsp;Oscilloscope</a>
									</li>
											<li>
					<a href="https://fabiobaltieri.com/2013/05/26/usb-to-100base-fx-optical-fiber-network-card/">USB to 100BASE-FX Optical Fiber Network&nbsp;Card</a>
									</li>
											<li>
					<a href="https://fabiobaltieri.com/2013/03/22/power-manager/">Power Manager: Soft Power Control of USB and Low Voltage&nbsp;Devices</a>
									</li>
											<li>
					<a href="https://fabiobaltieri.com/2013/02/14/hp-wi-fi-direct-mouse-on-linux/">HP Wi-Fi Direct Mouse on&nbsp;Linux</a>
									</li>
					</ul>

		</div><div id="linkcat-1356" class="widget widget_links"><h4>Blogroll</h4>
	<ul class='xoxo blogroll'>
<li><a href="http://www.davideccher.com/" rel="noopener" title="David Eccher, Photos and iPhone Apps." target="_blank">David Eccher</a></li>
<li><a href="http://www.youtube.com/user/thebrabus">ElectroYou Vlog (Italian)</a></li>
<li><a href="http://www.mariaplaias.com/" title="Maria Plaias Photography">Maria Plaias Photography</a></li>
<li><a href="http://www.sandrobernardinellophotography.it/" title="Sandro Bernardinello Photography &#8211; Photoblog">Sandro Bernardinello Photography</a></li>
<li><a href="https://www.facebook.com/theladyingreen">The Lady in Green</a></li>

	</ul>
</div>
<div id="linkcat-62844121" class="widget widget_links"><h4>Me, but somewhere else</h4>
	<ul class='xoxo blogroll'>
<li><a href="http://github.com/fabiobaltieri" title="Fabio Baltieri – GitHub">GitHub</a></li>
<li><a href="http://it.linkedin.com/in/fabiobaltieri">LinkedIn</a></li>

	</ul>
</div>
<div id="text-2" class="widget widget_text"><h4>License</h4>			<div class="textwidget"><a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"><img alt="Creative Commons License" style="border-width:0;" src="https://i0.wp.com/i.creativecommons.org/l/by-sa/3.0/88x31.png" /></a>

<br />
<br />

<small>Unless otherwise stated, this work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike 3.0 License</a>.</small></div>
		</div>			<div id="atatags-262211713-68265cc239756"></div>
			
			<script>
				__ATA.cmd.push(function() {
					__ATA.initDynamicSlot({
						id: 'atatags-262211713-68265cc239756',
						location: 140,
						formFactor: '003',
						label: {
							text: 'Advertisements',
						},
						creative: {
							reportAd: {
								text: 'Report this ad',
							},
							privacySettings: {
								text: 'Privacy',
								
							}
						}
					});
				});
			</script>
</div>
</div>


<div id="footer">
	<div class="footerleft">
		<p><a href="https://wordpress.com/?ref=footer_blog" rel="nofollow">Blog at WordPress.com.</a></p>
    </div>
    <div class="footerright">
	        </div>
</div>

</div>

<!--  -->
<script type="speculationrules">
{"prefetch":[{"source":"document","where":{"and":[{"href_matches":"\/*"},{"not":{"href_matches":["\/wp-*.php","\/wp-admin\/*","\/files\/*","\/wp-content\/*","\/wp-content\/plugins\/*","\/wp-content\/themes\/pub\/enterprise\/*","\/*\\?(.+)"]}},{"not":{"selector_matches":"a[rel~=\"nofollow\"]"}},{"not":{"selector_matches":".no-prefetch, .no-prefetch a"}}]},"eagerness":"conservative"}]}
</script>
<script type="text/javascript" src="//0.gravatar.com/js/hovercards/hovercards.min.js?ver=20252017d2298fc173af206bd9f65440008ab9e1ee2bd896241083289a9e27bd0efc7c" id="grofiles-cards-js"></script>
<script type="text/javascript" id="wpgroho-js-extra">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s2.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1610363240i'></script>

	<script>
		// Initialize and attach hovercards to all gravatars
		( function() {
			function init() {
				if ( typeof Gravatar === 'undefined' ) {
					return;
				}

				if ( typeof Gravatar.init !== 'function' ) {
					return;
				}

				Gravatar.profile_cb = function ( hash, id ) {
					WPGroHo.syncProfileData( hash, id );
				};

				Gravatar.my_hash = WPGroHo.my_hash;
				Gravatar.init(
					'body',
					'#wp-admin-bar-my-account',
					{
						i18n: {
							'Edit your profile →': 'Edit your profile →',
							'View profile →': 'View profile →',
							'Contact': 'Contact',
							'Send money': 'Send money',
							'Sorry, we are unable to load this Gravatar profile.': 'Sorry, we are unable to load this Gravatar profile.',
							'Gravatar not found.': 'Gravatar not found.',
							'Too Many Requests.': 'Too Many Requests.',
							'Internal Server Error.': 'Internal Server Error.',
							'Is this you?': 'Is this you?',
							'Claim your free profile.': 'Claim your free profile.',
							'Email': 'Email',
							'Home Phone': 'Home Phone',
							'Work Phone': 'Work Phone',
							'Cell Phone': 'Cell Phone',
							'Contact Form': 'Contact Form',
							'Calendar': 'Calendar',
						},
					}
				);
			}

			if ( document.readyState !== 'loading' ) {
				init();
			} else {
				document.addEventListener( 'DOMContentLoaded', init );
			}
		} )();
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-987f5d113a7febaefc63f44c2dec28c3">
	</div>
	<div class="grofile-hash-map-fdf2e3488a4dced3545eaa3d2bb5bf79">
	</div>
	<div class="grofile-hash-map-9316867f55badf12db1d3da5ee59e93d">
	</div>
	<div class="grofile-hash-map-dc63801b2623d9536ebd914d2c8c0303">
	</div>
	<div class="grofile-hash-map-dc63801b2623d9536ebd914d2c8c0303">
	</div>
	<div class="grofile-hash-map-b85633fd663b6632cd367194b913b039">
	</div>
	<div class="grofile-hash-map-8c71610a4ea707eac74c88900a5192d6">
	</div>
	<div class="grofile-hash-map-9a8607456a3fdc3935d9a9ac28d1109f">
	</div>
	<div class="grofile-hash-map-279ca63896e5b8b7cdea19fea55424c5">
	</div>
	<div class="grofile-hash-map-2b094ee9d5a4e7c3f600ceac72caafb0">
	</div>
	<div class="grofile-hash-map-53b5891397ddda04ffd8ee491bd3bc33">
	</div>
	<div class="grofile-hash-map-fcc6cfe36a974ba59beaff244ada564d">
	</div>
	<div class="grofile-hash-map-ef816d9ad1d42ffe83554a54d3de888b">
	</div>
	<div class="grofile-hash-map-1ba6286e0632c0a8c6c0dccb373ca6e0">
	</div>
	<div class="grofile-hash-map-fe6cc3ecc9797820432120337aa416ae">
	</div>
	<div class="grofile-hash-map-4a84c9084bcff51d334878a2ca363362">
	</div>
	<div class="grofile-hash-map-a1aa9b8ec2852869b5d15419902c3048">
	</div>
	<div class="grofile-hash-map-0a1bde5fa75da899b1ebe56139c58c21">
	</div>
	<div class="grofile-hash-map-d085147dcf7abd5263798ae3f0b938f5">
	</div>
	<div class="grofile-hash-map-b70da50706a8c3cffba65bc53324058f">
	</div>
	<div class="grofile-hash-map-53b5891397ddda04ffd8ee491bd3bc33">
	</div>
	<div class="grofile-hash-map-d91a0d9e9b07b48b694a4c19711cba88">
	</div>
	<div class="grofile-hash-map-413431c238662735db83694b4fca0d7d">
	</div>
	<div class="grofile-hash-map-50f473e275ccb39a36b223b654f9ca4f">
	</div>
	<div class="grofile-hash-map-5070b67412b9ad38d9adeb67ea9066ac">
	</div>
	<div class="grofile-hash-map-0a01ec5250adee8238506af65d5ce3c7">
	</div>
	<div class="grofile-hash-map-8892d47c8160275265776c6830b23193">
	</div>
	<div class="grofile-hash-map-8892d47c8160275265776c6830b23193">
	</div>
	<div class="grofile-hash-map-3d8f672a2abaf8e0fa0be51217db2642">
	</div>
	<div class="grofile-hash-map-58e5b642022a7428edc71ee3f18d0524">
	</div>
	<div class="grofile-hash-map-02aee08881b9b76fad56400ab2ad78ff">
	</div>
	<div class="grofile-hash-map-01d78393eac95f400738a59e087b6b4b">
	</div>
	<div class="grofile-hash-map-49314ada5ce97e95929c7d04fcf04ae3">
	</div>
	<div class="grofile-hash-map-851a570e1c6ea73b599b6a1a87b675f7">
	</div>
	<div class="grofile-hash-map-851a570e1c6ea73b599b6a1a87b675f7">
	</div>
	<div class="grofile-hash-map-ad16af586130dc83f74e9c973e6bfc92">
	</div>
	<div class="grofile-hash-map-cde9d51eb04a453905b091975848016d">
	</div>
	<div class="grofile-hash-map-da19e019aa6d6fb72ee05078babbcf72">
	</div>
	<div class="grofile-hash-map-c434e8c158924e6d6763eb091221af91">
	</div>
	<div class="grofile-hash-map-f248cf3c1869a023587fada421787b0f">
	</div>
	<div class="grofile-hash-map-95528cbbc1a28cc5673e1ed978f99761">
	</div>
	<div class="grofile-hash-map-ad726c8f95e3c44087f0430d1ef9427b">
	</div>
	<div class="grofile-hash-map-32d9072fc222c85a7f0b3d9eef210964">
	</div>
	</div>
		<script type="text/javascript">
		( function() {
			function init() {
				document.body.addEventListener( 'is.post-load', function() {
					if ( typeof __ATA.insertInlineAds === 'function' ) {
						__ATA.insertInlineAds();
					}
				} );
			}

			if ( document.readyState !== 'loading' ) {
				init();
			} else {
				document.addEventListener( 'DOMContentLoaded', init );
			}
		} )();
		</script>		<div id="actionbar" dir="ltr" style="display: none;"
			class="actnbr-pub-enterprise actnbr-has-follow actnbr-has-actions">
		<ul>
								<li class="actnbr-btn actnbr-hidden">
						<a class="actnbr-action actnbr-actn-comment" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comments">
							<svg class="gridicon gridicons-comment" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M12 16l-5 5v-5H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2v9c0 1.1-.9 2-2 2h-7z"/></g></svg>							<span>Comment						</span>
						</a>
					</li>
									<li class="actnbr-btn actnbr-hidden">
						<a class="actnbr-action actnbr-actn-reblog" href="">
							<svg class="gridicon gridicons-reblog" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M22.086 9.914L20 7.828V18c0 1.105-.895 2-2 2h-7v-2h7V7.828l-2.086 2.086L14.5 8.5 19 4l4.5 4.5-1.414 1.414zM6 16.172V6h7V4H6c-1.105 0-2 .895-2 2v10.172l-2.086-2.086L.5 15.5 5 20l4.5-4.5-1.414-1.414L6 16.172z"/></g></svg><span>Reblog</span>
						</a>
					</li>
									<li class="actnbr-btn actnbr-hidden">
								<a class="actnbr-action actnbr-actn-follow " href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z"  fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
							<div class="actnbr-popover tip tip-top-left actnbr-notice" id="follow-bubble">
							<div class="tip-arrow"></div>
							<div class="tip-inner actnbr-follow-bubble">
															<ul>
											<li class="actnbr-sitename">
			<a href="https://fabiobaltieri.com">
				<img loading='lazy' alt='' src='https://s2.wp.com/i/logo/wpcom-gray-white.png' srcset='https://s2.wp.com/i/logo/wpcom-gray-white.png 1x' class='avatar avatar-50' height='50' width='50' />				fabiobaltieri			</a>
		</li>
										<div class="actnbr-message no-display"></div>
									<form method="post" action="https://subscribe.wordpress.com" accept-charset="utf-8" style="display: none;">
																						<div class="actnbr-follow-count">Join 73 other subscribers</div>
																					<div>
										<input type="email" name="email" placeholder="Enter your email address" class="actnbr-email-field" aria-label="Enter your email address" />
										</div>
										<input type="hidden" name="action" value="subscribe" />
										<input type="hidden" name="blog_id" value="26221171" />
										<input type="hidden" name="source" value="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/" />
										<input type="hidden" name="sub-type" value="actionbar-follow" />
										<input type="hidden" id="_wpnonce" name="_wpnonce" value="1173afeb6d" />										<div class="actnbr-button-wrap">
											<button type="submit" value="Sign me up">
												Sign me up											</button>
										</div>
									</form>
									<li class="actnbr-login-nudge">
										<div>
											Already have a WordPress.com account? <a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Ffabiobaltieri.com%252F2013%252F07%252F23%252Fhacking-into-a-vehicle-can-bus-toyothack-and-socketcan%252F">Log in now.</a>										</div>
									</li>
								</ul>
															</div>
						</div>
					</li>
							<li class="actnbr-ellipsis actnbr-hidden">
				<svg class="gridicon gridicons-ellipsis" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M7 12c0 1.104-.896 2-2 2s-2-.896-2-2 .896-2 2-2 2 .896 2 2zm12-2c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm-7 0c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2z"/></g></svg>				<div class="actnbr-popover tip tip-top-left actnbr-more">
					<div class="tip-arrow"></div>
					<div class="tip-inner">
						<ul>
								<li class="actnbr-sitename">
			<a href="https://fabiobaltieri.com">
				<img loading='lazy' alt='' src='https://s2.wp.com/i/logo/wpcom-gray-white.png' srcset='https://s2.wp.com/i/logo/wpcom-gray-white.png 1x' class='avatar avatar-50' height='50' width='50' />				fabiobaltieri			</a>
		</li>
								<li class="actnbr-folded-follow">
										<a class="actnbr-action actnbr-actn-follow " href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z"  fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
								</li>
														<li class="actnbr-signup"><a href="https://wordpress.com/start/">Sign up</a></li>
							<li class="actnbr-login"><a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Ffabiobaltieri.com%252F2013%252F07%252F23%252Fhacking-into-a-vehicle-can-bus-toyothack-and-socketcan%252F">Log in</a></li>
																<li class="actnbr-shortlink">
										<a href="https://wp.me/p1M1k7-mT">
											<span class="actnbr-shortlink__text">Copy shortlink</span>
											<span class="actnbr-shortlink__icon"><svg class="gridicon gridicons-checkmark" height="16" width="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M9 19.414l-6.707-6.707 1.414-1.414L9 16.586 20.293 5.293l1.414 1.414"/></g></svg></span>
										</a>
									</li>
																<li class="flb-report">
									<a href="https://wordpress.com/abuse/?report_url=https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/" target="_blank" rel="noopener noreferrer">
										Report this content									</a>
								</li>
															<li class="actnbr-reader">
									<a href="https://wordpress.com/reader/blogs/26221171/posts/1419">
										View post in Reader									</a>
								</li>
															<li class="actnbr-subs">
									<a href="https://subscribe.wordpress.com/">Manage subscriptions</a>
								</li>
																<li class="actnbr-fold"><a href="">Collapse this bar</a></li>
														</ul>
					</div>
				</div>
			</li>
		</ul>
	</div>
	
<script>
window.addEventListener( "load", function( event ) {
	var link = document.createElement( "link" );
	link.href = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.css?v=20250116";
	link.type = "text/css";
	link.rel = "stylesheet";
	document.head.appendChild( link );

	var script = document.createElement( "script" );
	script.src = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.js?v=20250204";
	script.defer = true;
	document.body.appendChild( script );
} );
</script>

	
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/fabiobaltieri.com\/2013\/07\/23\/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan\/":1419};
	</script>
				<script crossorigin='anonymous' type='text/javascript'  src='https://s1.wp.com/_static/??-eJzTLy/QTc7PK0nNK9EvyClNz8wr1i+uzCtJrMjITM/IAeKS1CJMEWP94uSizIISoOIM5/yiVL2sYh19yo1yKioFmldQADTOPtfW0MzQ1MTczNLYKAsAjy0/rA=='></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://s1.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.head.appendChild( corecss );
		var themecssurl = "https://s2.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?m=1363304414i&amp;ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		document.head.appendChild( themecss );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();

	// Infinite scroll support
	document.addEventListener( 'is.post-load', function () {
		SyntaxHighlighter.highlight();
	} );
</script>
<script type="text/javascript" src="https://s1.wp.com/wp-content/js/mobile-useragent-info.js?m=1609849039i&amp;ver=20241018" id="mobile-useragent-info-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" id="verbum-settings-js-before">
/* <![CDATA[ */
window.VerbumComments = {"Log in or provide your name and email to leave a reply.":"Log in or provide your name and email to leave a reply.","Log in or provide your name and email to leave a comment.":"Log in or provide your name and email to leave a comment.","Receive web and mobile notifications for posts on this site.":"Receive web and mobile notifications for posts on this site.","Name":"Name","Email (address never made public)":"Email (address never made public)","Website (optional)":"Website (optional)","Leave a reply. (log in optional)":"Leave a reply. (log in optional)","Leave a comment. (log in optional)":"Leave a comment. (log in optional)","Log in to leave a reply.":"Log in to leave a reply.","Log in to leave a comment.":"Log in to leave a comment.","Logged in via %s":"Logged in via %s","Log out":"Log out","Email":"Email","(Address never made public)":"(Address never made public)","Instantly":"Instantly","Daily":"Daily","Reply":"Reply","Comment":"Comment","WordPress":"WordPress","Weekly":"Weekly","Notify me of new posts":"Notify me of new posts","Email me new posts":"Email me new posts","Email me new comments":"Email me new comments","Cancel":"Cancel","Write a comment...":"Write a comment...","Write a reply...":"Write a reply...","Website":"Website","Optional":"Optional","We'll keep you in the loop!":"We'll keep you in the loop!","Loading your comment...":"Loading your comment...","Discover more from":"Discover more from fabiobaltieri","Subscribe now to keep reading and get access to the full archive.":"Subscribe now to keep reading and get access to the full archive.","Continue reading":"Continue reading","Never miss a beat!":"Never miss a beat!","Interested in getting blog post updates? Simply click the button below to stay in the loop!":"Interested in getting blog post updates? Simply click the button below to stay in the loop!","Enter your email address":"Enter your email address","Subscribe":"Subscribe","Comment sent successfully":"Comment sent successfully","Save my name, email, and website in this browser for the next time I comment.":"Save my name, email, and website in this browser for the next time I comment.","hovercardi18n":{"Edit your profile \u2192":"Edit your profile \u2192","View profile \u2192":"View profile \u2192","Contact":"Contact","Send money":"Send money","Profile not found.":"Profile not found.","Too Many Requests.":"Too Many Requests.","Internal Server Error.":"Internal Server Error.","Sorry, we are unable to load this Gravatar profile.":"Sorry, we are unable to load this Gravatar profile."},"siteId":26221171,"postId":1419,"mustLogIn":false,"requireNameEmail":true,"commentRegistration":false,"connectURL":"https:\/\/fabiobaltieri.wordpress.com\/public.api\/connect\/?action=request&domain=fabiobaltieri.com","logoutURL":"https:\/\/fabiobaltieri.wordpress.com\/wp-login.php?action=logout&_wpnonce=ba22c74fdd","homeURL":"https:\/\/fabiobaltieri.com\/","subscribeToBlog":true,"subscribeToComment":true,"isJetpackCommentsLoggedIn":false,"jetpackUsername":"","jetpackUserId":0,"jetpackSignature":"","jetpackAvatar":"https:\/\/0.gravatar.com\/avatar\/?s=96&amp;d=identicon&amp;r=G","enableBlocks":true,"enableSubscriptionModal":true,"currentLocale":"en","isJetpackComments":false,"allowedBlocks":["core\/paragraph","core\/list","core\/code","core\/list-item","core\/quote","core\/image","core\/embed","core\/quote","core\/code"],"embedNonce":"dc96985f90","verbumBundleUrl":"https:\/\/s2.wp.com\/wp-content\/mu-plugins\/jetpack-mu-wpcom-plugin\/sun\/jetpack_vendor\/automattic\/jetpack-mu-wpcom\/src\/features\/verbum-comments\/dist\/index.js","isRTL":false,"vbeCacheBuster":1738686361,"iframeUniqueId":0,"colorScheme":false}
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s0.wp.com/_static/??/wp-content/blog-plugins/wordads-classes/js/watl.js,/wp-content/mu-plugins/likes/queuehandler.js?m=1746710196j'></script>
<script type="text/javascript" src="https://s1.wp.com/wp-content/mu-plugins/jetpack-mu-wpcom-plugin/sun/jetpack_vendor/automattic/jetpack-mu-wpcom/src/build/verbum-comments/assets/dynamic-loader.js?m=1741800217i&amp;minify=false&amp;ver=74baca08b8baf473b8a0" id="verbum-dynamic-loader-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s1.wp.com/_static/??-eJx9TksOwiAQvZAwNrXtyngUg4B1KDMlDMT09pLauHT3/nnwTgrZxuq8QBCwK5HnorJPcdOErIOcoIXsyqUZQFWlWGdkAbOgkC+q12e4t5Gf8Mx72P3pBl+SscvBQSp/Jx4VowN5meydcW7bIfJ8XLnRtZsufTcO0zCGDxMKROQ='></script>
<script type="text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>

	<script type="text/javascript">
		(function () {
			var wpcom_reblog = {
				source: 'toolbar',

				toggle_reblog_box_flair: function (obj_id, post_id) {

					// Go to site selector. This will redirect to their blog if they only have one.
					const postEndpoint = `https://wordpress.com/post`;

					// Ideally we would use the permalink here, but fortunately this will be replaced with the 
					// post permalink in the editor.
					const originalURL = `${ document.location.href }?page_id=${ post_id }`; 
					
					const url =
						postEndpoint +
						'?url=' +
						encodeURIComponent( originalURL ) +
						'&is_post_share=true' +
						'&v=5';

					const redirect = function () {
						if (
							! window.open( url, '_blank' )
						) {
							location.href = url;
						}
					};

					if ( /Firefox/.test( navigator.userAgent ) ) {
						setTimeout( redirect, 0 );
					} else {
						redirect();
					}
				},
			};

			window.wpcom_reblog = wpcom_reblog;
		})();
	</script>
	<iframe src='https://widgets.wp.com/likes/master.html?ver=20250515#ver=20250515' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
	<div id='likes-other-gravatars' role="dialog" aria-hidden="true" tabindex="-1"><div class="likes-text"><span>%d</span></div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
	<script src="//stats.wp.com/w.js?68" defer></script> <script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'26221171','blog_tz':'1','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'26221171','v':'wpcom','tz':'1','user_id':'0','post':'1419','subd':'fabiobaltieri'}]);
_stq.push(['extra', {'crypt':'UE5VTUIlVktzQVNtcFdrRlVoJUNsa2NPNURmfG5zSmhZMEN8bjdYNV02WDYrNmtkdiVqc3ovVmNzejJLRSU5Qz81TWhOTz1NUzE0JV92Nk8rYXF5T19dWzk/dlJYKyxVRnFJLUdOa3BkZ0lQaTBqclVpST9MNyx2YlFrc1pWT0Vbeix3bEVBSF05eHA0MHQuWzhRSmJ6QnQ1aSxMN1tvLXxBam54V3E2emp4azFYJUYrS1NsM19ncjJLdjRhXWxMfj1qT3JUSm8zNC8vciZScCw3TFNTJnV0ekE2TS5tbHcrU1ZWR0VYTk9bfm51eFFXRWd5ZndBLkgs'}]);
_stq.push([ 'clickTrackerInit', '26221171', '1419' ]);
</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:1px;width:1px;overflow:hidden;position:absolute;bottom:1px;" alt="" /></noscript>
<script defer id="bilmur" data-customproperties="{&quot;logged_in&quot;:&quot;0&quot;,&quot;wptheme&quot;:&quot;pub\/enterprise&quot;,&quot;wptheme_is_block&quot;:&quot;0&quot;}" data-provider="wordpress.com" data-service="simple" data-site-tz="Etc/GMT-1"   src="/wp-content/js/bilmur-4.min.js?i=12&m=202520"></script><script>
( function() {
	function getMobileUserAgentInfo() {
		if ( typeof wpcom_mobile_user_agent_info === 'object' ) {
			wpcom_mobile_user_agent_info.init();
			var mobileStatsQueryString = '';

			if ( wpcom_mobile_user_agent_info.matchedPlatformName !== false ) {
				mobileStatsQueryString += '&x_' + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
			}

			if ( wpcom_mobile_user_agent_info.matchedUserAgentName !== false ) {
				mobileStatsQueryString += '&x_' + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
			}

			if ( wpcom_mobile_user_agent_info.isIPad() ) {
				mobileStatsQueryString += '&x_' + 'ipad_views' + '=' + 'views';
			}

			if ( mobileStatsQueryString != '' ) {
				new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
			}
		}
	}

	document.addEventListener( 'DOMContentLoaded', getMobileUserAgentInfo );
} )();
</script>
<script>
(function() {
	'use strict';

	const fetches = {};
	const promises = {};
	const urls = {
		'wp-polyfill': 'https://s1.wp.com/wp-includes/js/dist/vendor/wp-polyfill.min.js?m=1744646400i&ver=3.15.0',
		'verbum': 'https://s2.wp.com/wp-content/mu-plugins/jetpack-mu-wpcom-plugin/sun/jetpack_vendor/automattic/jetpack-mu-wpcom/src/build/verbum-comments/verbum-comments.js?m=1746618905i&minify=false&ver=e7eb4580fccc06e8771c'
	};
	const loaders = {
		'verbum': () => {
			fetchExternalScript('wp-polyfill');
			fetchExternalScript('verbum');
			promises['wp-polyfill'] = promises['wp-polyfill'] || loadWPScript('wp-polyfill');
			promises['verbum'] = promises['verbum'] || promises['wp-polyfill'].then( () => loadWPScript('verbum') );
			return promises['verbum'];
		},
		
	};
	const scriptExtras = {
		
	};

	window.WP_Enqueue_Dynamic_Script = {
		loadScript: (handle) => {
			if (!loaders[handle]) {
				console.error('WP_Enqueue_Dynamic_Script: unregistered script `' + handle + '`.');
			}
			return loaders[handle]();
		}
	};

	function fetchExternalScript(handle) {
		if (!urls[handle]) {
			return Promise.resolve();
		}

		fetches[handle] = fetches[handle] || fetch(urls[handle], { mode: 'no-cors' });
		return fetches[handle];
	}

	function runExtraScript(handle, type, index) {
		const id = 'wp-enqueue-dynamic-script:' + handle + ':' + type + ':' + (index + 1);
		const template = document.getElementById(id);
		if (!template) {
			return Promise.reject();
		}

		const script = document.createElement( 'script' );
		script.innerHTML = template.innerHTML;
		document.body.appendChild( script );
		return Promise.resolve();
	}

	function loadExternalScript(handle) {
		if (!urls[handle]) {
			return Promise.resolve();
		}

		return fetches[handle].then(() => {
			return new Promise((resolve, reject) => {
				const script = document.createElement('script');
				script.onload = () => resolve();
				script.onerror = (e) => reject(e);
				script.src = urls[handle];
				document.body.appendChild(script);
			});
		});
	}

	function loadExtra(handle, pos) {
		const count = (scriptExtras[handle] && scriptExtras[handle][pos]) || 0;
		let promise = Promise.resolve();

		for (let i = 0; i < count; i++) {
			promise = promise.then(() => runExtraScript(handle, pos, i));
		}

		return promise;
	}

	function loadWPScript(handle) {
		// Core loads scripts in this order. See: https://github.com/WordPress/WordPress/blob/a59eb9d39c4fcba834b70c9e8dfd64feeec10ba6/wp-includes/class-wp-scripts.php#L428.
		return loadExtra(handle, 'translations')
			.then(() => loadExtra(handle, 'before'))
			.then(() => loadExternalScript(handle))
			.then(() => loadExtra(handle, 'after'));
	}
} )();
</script>

</body>
</html>