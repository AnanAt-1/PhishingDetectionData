<html>
<head>
<meta name="description" content="Penetrator MegaBlaster is a kernel module that 
detects & stops overflow attacks, which aim to get an interactive access to the 
system (for example, open a new shell)."> 
<meta name="keywords" content="free, MegaBlaster, megablaster, penetrator, Boris Litvak, overflow, security, CV">
<title> Penetrator MegaBlaster - against overflow attacks</title>
</head>
<body bgcolor="fuchsia" text="black" link="#0000ff" alink="#000000" vlink="#800080" BACKGROUND="images/background.gif"><!--'"</title></head>-->

<script type="text/javascript">
//OwnerIQ
var __oiq_pct = 50;
if( __oiq_pct>=100 || Math.floor(Math.random()*100/(100-__oiq_pct)) > 0 ) {
var _oiqq = _oiqq || [];
_oiqq.push(['oiq_addPageBrand','Lycos']);
_oiqq.push(['oiq_addPageCat','Internet > Websites']);
_oiqq.push(['oiq_addPageLifecycle','Intend']);
_oiqq.push(['oiq_doTag']);
(function() {
var oiq = document.createElement('script'); oiq.type = 'text/javascript'; oiq.async = true;
oiq.src = document.location.protocol + '//px.owneriq.net/stas/s/lycosn.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(oiq, s);
})();
}

/////// Google Analytics
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-21402695-21']);
_gaq.push(['_setDomainName', 'angelfire.com']);
_gaq.push(['_setCustomVar', 1, 'member_name', 'linux/borisl', 3]);
_gaq.push(['_trackPageview']);
(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

////// Lycos Initialization /////////////////////
var lycos_ad = Array();
var lycos_search_query = "";
var lycos_onload_timer;

var cm_role = "live";
var cm_host = "angelfire.lycos.com";
var cm_taxid = "/memberembedded";
var angelfire_member_name = "linux/borisl";
var angelfire_member_page = "linux/borisl/MegaBlaster.html";
var angelfire_ratings_hash = "1747345164:579363472d1436d823440dbe55c34c76";

var lycos_ad_category = {"dmoz":"science\/employment","ontarget":"&CAT=career&L2CAT=science","find_what":"firewalls for the computer"};

var lycos_ad_remote_addr = "209.202.244.9";
var lycos_ad_www_server = "www.angelfire.lycos.com";
var edit_site_url = "www.angelfire.lycos.com/landing/landing.tmpl?utm_source=house&utm_medium=landingpage&utm_campaign=toolbarlink";

</script>
<script type="text/javascript" src="https://scripts.lycos.com/catman/init.js"></script>

<script type='text/javascript'>
 var googletag = googletag || {};
 googletag.cmd = googletag.cmd || [];
 (function() {
   var gads = document.createElement('script');
   gads.async = true;
   gads.type = 'text/javascript';
   var useSSL = 'https:' == document.location.protocol;
   gads.src = (useSSL ? 'https:' : 'http:') +
     '//www.googletagservices.com/tag/js/gpt.js';
   var node = document.getElementsByTagName('script')[0];
   node.parentNode.insertBefore(gads, node);
 })();
</script>


<script type='text/javascript'>
 googletag.cmd.push(function() {
   googletag.defineSlot('/95963596/ANG_300x250_dfp', [300, 250], 'div-gpt-ad-1450207484070-0').addService(googletag.pubads());
   googletag.enableServices();
 });
</script>

<script type='text/javascript'>
 googletag.cmd.push(function() {
   googletag.defineSlot('/95963596/ANG_above_728x90_dfp', [728, 90], 'div-gpt-ad-1450207484070-1').addService(googletag.pubads());
   googletag.enableServices();
 });
</script>

<script type='text/javascript'>
 googletag.cmd.push(function() {
   googletag.defineSlot('/95963596/ANG_below_728X90_dfp', [728, 90], 'div-gpt-ad-1450207484070-2').addService(googletag.pubads());
   googletag.enableServices();
 });
</script>


<script type="text/javascript">
(function(isV) {
    if (!isV) {
        return;
    }

    //this.lycos_search_query = lycos_get_search_referrer();
    var adMgr = new AdManager();
    var lycos_prod_set = adMgr.chooseProductSet();
    var slots = ["leaderboard", "leaderboard2", "toolbar_image", "toolbar_text", "smallbox", "top_promo", "footer2","slider"];
    var adCat = this.lycos_ad_category;
    adMgr.setForcedParam('page', (adCat && adCat.dmoz) ? adCat.dmoz : 'member');

    if (this.lycos_search_query) {
        adMgr.setForcedParam("keyword", this.lycos_search_query);
    } 
    else if (adCat && adCat.find_what) {
        adMgr.setForcedParam('keyword', adCat.find_what);
    }

    for (var s in slots) {
        var slot = slots[s];
        if (adMgr.isSlotAvailable(slot)) {
            this.lycos_ad[slot] = adMgr.getSlot(slot);
        }
    }


    adMgr.renderHeader();
    adMgr.renderFooter();
}((function() {
    var w = 0, h = 0, minimumThreshold = 300;
    if (top == self) {
        return true;
    }

    if (typeof(window.innerWidth) == 'number' ) {
        w = window.innerWidth;
        h = window.innerHeight;
    }
    else if (document.documentElement && (document.documentElement.clientWidth || document.documentElement.clientHeight)) {
        w = document.documentElement.clientWidth;
        h = document.documentElement.clientHeight;
    }
    else if (document.body && (document.body.clientWidth || document.body.clientHeight)) {
        w = document.body.clientWidth;
        h = document.body.clientHeight;
    }

    return ((w > minimumThreshold) && (h > minimumThreshold));
}())));



window.onload = function() {
    var f = document.getElementById("lycosFooterAd");
    var b = document.getElementsByTagName("body")[0];
    b.appendChild(f);
    f.style.display = "block";
    document.getElementById('lycosFooterAdiFrame').src = '/adm/ad/footerAd.iframe.html';

    // Slider Injection
    (function() {
        var e = document.createElement('iframe');
        e.style.border = '0';
        e.style.margin = 0;
        e.style.display = 'block';
        e.style.cssFloat = 'right';
        e.style.height = '254px';
        e.style.overflow = 'hidden';
        e.style.padding = 0;
        e.style.width = '300px';
    })();


    // Bottom Ad Injection
    ( function() {
        var b = document.getElementsByTagName("body")[0];

        var iif = document.createElement('iframe');
        iif.style.border = '0';
        iif.style.margin = 0;
        iif.style.display = 'block';
        iif.style.cssFloat = 'right';
        iif.style.height = '254px';
        iif.style.overflow = 'hidden';
        iif.style.padding = 0;
        iif.style.width = '300px';
        iif.src = '/adm/ad/injectAd.iframe.html';
        
        var cdiv = document.createElement('div');
        cdiv.style = "width:300px;margin:10px auto;";
        cdiv.appendChild( iif );
        if( b )
        {
            b.insertBefore(cdiv, b.lastChild);
        }
    })();

}


</script>

<style>
#body .adCenterClass {
  margin:0 auto;
  display:block !important;
  overflow:hidden;
  width:100%;
}
#body .adCenterClass #ad_container {
  display:block !important;
  float:left;
  width:728px;
}
@media (min-width: 768px) {
  <!-- For 300px or less ads ONLY -->
  #body .adCenterClass #ad_container {
    width: calc(100% - 372px);
  }
}
@media (min-width: 1110px) {
  <!-- For 728px or less ads -->
  #body .adCenterClass #ad_container {
    width: calc(100% - 372px);
  }
}

</style>

<div style="background:#abe6f6; border-bottom:1px solid #507a87; position:relative; z-index:9999999">

    <div class="adCenterClass">
        <a href="https://www.angelfire.lycos.com/" title="Angelfire.com: build your free website today!" style="display:block; float:left; width:186px; border:0">
          <img src="/adm/ad/angelfire-freeAd.jpg" alt="Site hosted by Angelfire.com: Build your free website today!" style="display:block; border:0" />
        </a>
        <div id="ad_container">
            <script type="text/javascript">document.write(lycos_ad['leaderboard']);</script>
        </div>
    </div>
</div>

<!-- ///////////////////////////////////// -->
<script type="text/javascript">document.write(lycos_ad['slider']);</script>


<div id="lycosFooterAd" style="background:#abe6f6; border-top:1px solid #507a87; clear:both; display:none; position:relative; z-index:9999999">
<div class="adCenterClass" style="display:block!important; overflow:hidden; width:936px;">
	<div id="aflinksholder" style="float:left; width:186px;">
        <a href="https://www.angelfire.lycos.com/" title="Angelfire.com: build your free website today!" style="display:block; border:0">
            <img src="/adm/ad/angelfire-freeAd2.jpg" alt="Site hosted by Angelfire.com: Build your free website today!" style="display:block; border:0" />
        </a>
    </div>
    <iframe id="lycosFooterAdiFrame" style="border:0; display:block; float:left; height:96px; overflow:hidden; padding:0; width:750px"></iframe>
</div>
</div>


<!--- UNDERDOGMEDIA EDGE_lycos.com JavaScript ADCODE START--->
<script data-cfasync="false" language="javascript" async src="//udmserve.net/udm/img.fetch?sid=17754;tid=1;dt=6;"></script>
<!--- UNDERDOGMEDIA EDGE_lycos.com JavaScript ADCODE END--->


<basefont size="3">
<br>
<table><tr><td><IMG SRC="images/ghost.gif" alt="ghost" align=center HEIGHT=128 WIDTH=128>

<td> 
<center> <i>
<H1> Penetrator MegaBlaster <br> page #1</H1><br><h5>Please click the refresh button on your browser 
in order to get the updated page.</h5></i>
</center>
<td><IMG SRC="images/ghost.gif" alt="ghost" align=center HEIGHT=128 WIDTH=128>
</tr>
</table>
<p>

<h4> Penetrator MegaBlaster is a kernel module that 
detects & stops overflow attacks 
(like the famous buffer overflow attack), 
which aim to get an interactive access to the 
system (for example, open a new shell).  
Penetrator MegaBlaster was written by <a href="index.html">Boris Litvak</a>, 
Alex Fishgate & Eyal Serrero, with the guidance of
Amichai Shulman. Advices by Gennady Litvak saved tons of time. It was tested on Red Hat 
Linux 6.0 and on Red Hat Linux 5.2. <br></h4>

<p>
The main idea is very simple: 
  <p>The purpose of overflow attack which aims to get 
an interactive access is to execute an interactive 
program (for example, shell) from the attacked program,
which permissions include SET UID or SET GUID bit. If the permissions
don't include one of this bits, The interactive program
will be opened with the attacker's permissions exactly,
which is not interesting to her.
  <p>Penetrator MegaBlaster is basically a module that
replaces the 'execve' system call handler. After it
finishes all the checking, it calls the original handler.
  <p>System administrator should have an access file
with lines in a following format: <br>
(name of the SET UID program from which the execve is called)
(space) (uid or '*' for all users) (space) (path of the 
program being called).
<br>
MegaBlaster checks for execution permissions in this file
for all execve's from SET UID programs. For example,
upon executing shell from finger by user 500, MegaBlaster
will look for <br>fingerd 500 /bin/sh or fingerd * /bin/sh
<br> in the access file. If it doesn't find one of those 
lines, the access is denied. Simple. All the reports by
the MegaBlaster can be viewed easily:
grep MegaBlaster /var/log/messages | more.
<p>

Notes: the idea can be extended at least by 4 ways:<br>
1) Adding options to MegaBlaster activations (4 currently).<br>
2) Inserting it as a patch into the kernel.<br>
3) Implementing the idea on other OS.<br>
4) Selling the idea to Bill Gates (probably the best out of 4).<br>
<p> 
You can find all the MegaBlaster files and installation instructions on the
<a href="files.html">next page</a>.
<p>
<h3>See also: </h3>
<dir>
<li> <a href="http://www.cse.ogi.edu/DISC/projects/immunix/StackGuard/">StackGuard</a>
<li> <a href="http://www.securiteam.com/">SecuriTeam</a>
<li> <a href="http://www.netip.com/Links/known-attack.htm">Known attacks</a>
</dir>
 
<center>
<H2> <i><u><a href="files.html">Next Page</a></u></i></h2>
</center>
<hr>
<table>
<tr>
<td>
<h4> <a href="index.html">Home</a> 
<br>
This page is managed by <a href="http://pages.hotbot.com/resumes/borisl/index.html">Boris Litvak</a>.</h4>
<td width=200 align=right>

<!-- Start of TheCounter.com Code -->
<SCRIPT><!--
s="na";c="na";j="na";f=""+escape(document.referrer)
//--></SCRIPT>
<SCRIPT language="javascript1.2"><!--
s=screen.width;v=navigator.appName
if (v != "Netscape") {c=screen.colorDepth}
else {c=screen.pixelDepth}
j=navigator.javaEnabled()
//--></SCRIPT>
<SCRIPT><!--
function pr(n) {document.write(n,"\n");}
NS2Ch=0
if (navigator.appName == "Netscape" &&
navigator.appVersion.charAt(0) == "2") {NS2Ch=1}
if (NS2Ch == 0) {
r="&size="+s+"&colors="+c+"&referer="+f+"&java="+j+""
pr("<A HREF=\"http://www.TheCounter.com\" TARGET=\"_top\"><IMG")

pr("BORDER=0 SRC=\"http://c1.thecounter.com/id=425198"+r+"\"></A>")}
//--></SCRIPT>
<NOSCRIPT><A HREF="http://www.TheCounter.com" TARGET="_top"><IMG

SRC="http://c1.thecounter.com/id=425198" BORDER=0></A>
</NOSCRIPT>
<!-- End of TheCounter.com Code -->

</td>
<td width=250 align=right> (unique IP's since 20/9/1999)
</tr>
</table>
</body>
</html>
