<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>
Active Directory OU picker in powershell | MicaH&#039;s IT blog</title>
<link rel="profile" href="https://gmpg.org/xfn/11" />
<link rel="stylesheet" type="text/css" media="all" href="https://s2.wp.com/wp-content/themes/pub/twentyten/style.css?ver=20190507" />
<link rel="pingback" href="https://itmicah.wordpress.com/xmlrpc.php">
<meta name='robots' content='max-image-preview:large' />
<meta name="google-site-verification" content="EGt_8_ZhItSDTQODnXzySBND0Pk1lMr8uUFh_QbpjmY" />
<meta name="msvalidate.01" content="79D82F6BDA83F17D6E4F9B70FE7694DB" />
<link rel='dns-prefetch' href='//s1.wp.com' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//s2.wp.com' />
<link rel='dns-prefetch' href='//widgets.wp.com' />
<link rel='dns-prefetch' href='//af.pubmine.com' />
<link rel='dns-prefetch' href='//s.pubmine.com' />
<link rel='dns-prefetch' href='//x.bidswitch.net' />
<link rel='dns-prefetch' href='//static.criteo.net' />
<link rel='dns-prefetch' href='//ib.adnxs.com' />
<link rel='dns-prefetch' href='//aax.amazon-adsystem.com' />
<link rel='dns-prefetch' href='//bidder.criteo.com' />
<link rel='dns-prefetch' href='//cas.criteo.com' />
<link rel='dns-prefetch' href='//gum.criteo.com' />
<link rel='dns-prefetch' href='//ads.pubmatic.com' />
<link rel='dns-prefetch' href='//gads.pubmatic.com' />
<link rel='dns-prefetch' href='//tpc.googlesyndication.com' />
<link rel='dns-prefetch' href='//ad.doubleclick.net' />
<link rel='dns-prefetch' href='//googleads.g.doubleclick.net' />
<link rel='dns-prefetch' href='//www.googletagservices.com' />
<link rel='dns-prefetch' href='//cdn.switchadhub.com' />
<link rel='dns-prefetch' href='//delivery.g.switchadhub.com' />
<link rel='dns-prefetch' href='//delivery.swid.switchadhub.com' />
<link rel='dns-prefetch' href='//a.teads.tv' />
<link rel='dns-prefetch' href='//prebid.media.net' />
<link rel='dns-prefetch' href='//adserver-us.adtech.advertising.com' />
<link rel='dns-prefetch' href='//fastlane.rubiconproject.com' />
<link rel='dns-prefetch' href='//prebid-server.rubiconproject.com' />
<link rel='dns-prefetch' href='//hb-api.omnitagjs.com' />
<link rel='dns-prefetch' href='//mtrx.go.sonobi.com' />
<link rel='dns-prefetch' href='//apex.go.sonobi.com' />
<link rel='dns-prefetch' href='//u.openx.net' />
<link rel="alternate" type="application/rss+xml" title="MicaH&#039;s IT blog &raquo; Feed" href="https://itmicah.wordpress.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="MicaH&#039;s IT blog &raquo; Comments Feed" href="https://itmicah.wordpress.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="MicaH&#039;s IT blog &raquo; Active Directory OU picker in&nbsp;powershell Comments Feed" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/feed/" />
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
	<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s1.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1743601627i&ver=6.8.1-alpha-60199"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\ud83d\udd25","\ud83d\udc26\u200b\ud83d\udd25")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-0-1' href='https://s0.wp.com/_static/??-eJyFj90KwjAMhV/IGuY2vBKfpVtD6Zb+sKSWvb2dCEOFeXlyvvNBoCQ1xiAYBAaKViXK1gWGEhejDYOlOGg6j8wn+MdKqdVae/W4/Cx83nlnLAoD5trG2aEiXUDQJ9KCDCwr4ZFgQkl6nN8ZOAfw0WSq2wU3h1EpsnylIyO5GXfvKx3/7PUyo7hg1aAXqOjnZRvf/a25dn3ftF3TTk+pMofY&cssminify=yes' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-2-1' href='https://s0.wp.com/_static/??-eJylzFsKgCAQQNENlWNhr49oLWmDWZOKj6LdF22hz8uFA5cvlbMJbQJPWRsbQec3JQb9noBw1py1jIPMhhaQ5NRekpFhDjfEdBMyFWMB/6C04vFB0zFWnRBDM/C+2h4i4jhW&cssminify=yes' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify {
	text-align:justify;
}
.has-text-align-justify{text-align:justify;}
</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-4-1' href='https://s1.wp.com/_static/??-eJyVzDEOgCAMQNELiQU1Jg7Gs2AlDYpAaInx9ro5O/7hfbiywhTFRYEcKvnIQPXN1RVSa0h4MOxOssVDBXunKoqK34DlDq5F5gb+LIoVH4k/vpyzGYe+03oyw/4AcmU1KQ==&cssminify=yes' type='text/css' media='all' />
<link crossorigin='anonymous' rel='stylesheet' id='all-css-6-1' href='https://s2.wp.com/_static/??-eJzTLy/QzcxLzilNSS3WzyrWz01NyUxMzUnNTc0rQeEU5CRWphbp5qSmJyZX6uVm5uklFxfr6OPTDpRD5sM02efaGpoZmFkYGRuZGmQBAHPvL0Y=&cssminify=yes' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-8-1' href='https://s1.wp.com/_static/??/wp-content/mu-plugins/core-compat/wp-mediaelement.css,/wp-content/mu-plugins/wpcom-bbpress-premium-themes.css?m=1432920480j&cssminify=yes' type='text/css' media='all' />
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #fff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--blue: #0066cc;--wp--preset--color--medium-gray: #666;--wp--preset--color--light-gray: #f1f1f1;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-family--albert-sans: 'Albert Sans', sans-serif;--wp--preset--font-family--alegreya: Alegreya, serif;--wp--preset--font-family--arvo: Arvo, serif;--wp--preset--font-family--bodoni-moda: 'Bodoni Moda', serif;--wp--preset--font-family--bricolage-grotesque: 'Bricolage Grotesque', sans-serif;--wp--preset--font-family--cabin: Cabin, sans-serif;--wp--preset--font-family--chivo: Chivo, sans-serif;--wp--preset--font-family--commissioner: Commissioner, sans-serif;--wp--preset--font-family--cormorant: Cormorant, serif;--wp--preset--font-family--courier-prime: 'Courier Prime', monospace;--wp--preset--font-family--crimson-pro: 'Crimson Pro', serif;--wp--preset--font-family--dm-mono: 'DM Mono', monospace;--wp--preset--font-family--dm-sans: 'DM Sans', sans-serif;--wp--preset--font-family--dm-serif-display: 'DM Serif Display', serif;--wp--preset--font-family--domine: Domine, serif;--wp--preset--font-family--eb-garamond: 'EB Garamond', serif;--wp--preset--font-family--epilogue: Epilogue, sans-serif;--wp--preset--font-family--fahkwang: Fahkwang, sans-serif;--wp--preset--font-family--figtree: Figtree, sans-serif;--wp--preset--font-family--fira-sans: 'Fira Sans', sans-serif;--wp--preset--font-family--fjalla-one: 'Fjalla One', sans-serif;--wp--preset--font-family--fraunces: Fraunces, serif;--wp--preset--font-family--gabarito: Gabarito, system-ui;--wp--preset--font-family--ibm-plex-mono: 'IBM Plex Mono', monospace;--wp--preset--font-family--ibm-plex-sans: 'IBM Plex Sans', sans-serif;--wp--preset--font-family--ibarra-real-nova: 'Ibarra Real Nova', serif;--wp--preset--font-family--instrument-serif: 'Instrument Serif', serif;--wp--preset--font-family--inter: Inter, sans-serif;--wp--preset--font-family--josefin-sans: 'Josefin Sans', sans-serif;--wp--preset--font-family--jost: Jost, sans-serif;--wp--preset--font-family--libre-baskerville: 'Libre Baskerville', serif;--wp--preset--font-family--libre-franklin: 'Libre Franklin', sans-serif;--wp--preset--font-family--literata: Literata, serif;--wp--preset--font-family--lora: Lora, serif;--wp--preset--font-family--merriweather: Merriweather, serif;--wp--preset--font-family--montserrat: Montserrat, sans-serif;--wp--preset--font-family--newsreader: Newsreader, serif;--wp--preset--font-family--noto-sans-mono: 'Noto Sans Mono', sans-serif;--wp--preset--font-family--nunito: Nunito, sans-serif;--wp--preset--font-family--open-sans: 'Open Sans', sans-serif;--wp--preset--font-family--overpass: Overpass, sans-serif;--wp--preset--font-family--pt-serif: 'PT Serif', serif;--wp--preset--font-family--petrona: Petrona, serif;--wp--preset--font-family--piazzolla: Piazzolla, serif;--wp--preset--font-family--playfair-display: 'Playfair Display', serif;--wp--preset--font-family--plus-jakarta-sans: 'Plus Jakarta Sans', sans-serif;--wp--preset--font-family--poppins: Poppins, sans-serif;--wp--preset--font-family--raleway: Raleway, sans-serif;--wp--preset--font-family--roboto: Roboto, sans-serif;--wp--preset--font-family--roboto-slab: 'Roboto Slab', serif;--wp--preset--font-family--rubik: Rubik, sans-serif;--wp--preset--font-family--rufina: Rufina, serif;--wp--preset--font-family--sora: Sora, sans-serif;--wp--preset--font-family--source-sans-3: 'Source Sans 3', sans-serif;--wp--preset--font-family--source-serif-4: 'Source Serif 4', serif;--wp--preset--font-family--space-mono: 'Space Mono', monospace;--wp--preset--font-family--syne: Syne, sans-serif;--wp--preset--font-family--texturina: Texturina, serif;--wp--preset--font-family--urbanist: Urbanist, sans-serif;--wp--preset--font-family--work-sans: 'Work Sans', sans-serif;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}.has-albert-sans-font-family{font-family: var(--wp--preset--font-family--albert-sans) !important;}.has-alegreya-font-family{font-family: var(--wp--preset--font-family--alegreya) !important;}.has-arvo-font-family{font-family: var(--wp--preset--font-family--arvo) !important;}.has-bodoni-moda-font-family{font-family: var(--wp--preset--font-family--bodoni-moda) !important;}.has-bricolage-grotesque-font-family{font-family: var(--wp--preset--font-family--bricolage-grotesque) !important;}.has-cabin-font-family{font-family: var(--wp--preset--font-family--cabin) !important;}.has-chivo-font-family{font-family: var(--wp--preset--font-family--chivo) !important;}.has-commissioner-font-family{font-family: var(--wp--preset--font-family--commissioner) !important;}.has-cormorant-font-family{font-family: var(--wp--preset--font-family--cormorant) !important;}.has-courier-prime-font-family{font-family: var(--wp--preset--font-family--courier-prime) !important;}.has-crimson-pro-font-family{font-family: var(--wp--preset--font-family--crimson-pro) !important;}.has-dm-mono-font-family{font-family: var(--wp--preset--font-family--dm-mono) !important;}.has-dm-sans-font-family{font-family: var(--wp--preset--font-family--dm-sans) !important;}.has-dm-serif-display-font-family{font-family: var(--wp--preset--font-family--dm-serif-display) !important;}.has-domine-font-family{font-family: var(--wp--preset--font-family--domine) !important;}.has-eb-garamond-font-family{font-family: var(--wp--preset--font-family--eb-garamond) !important;}.has-epilogue-font-family{font-family: var(--wp--preset--font-family--epilogue) !important;}.has-fahkwang-font-family{font-family: var(--wp--preset--font-family--fahkwang) !important;}.has-figtree-font-family{font-family: var(--wp--preset--font-family--figtree) !important;}.has-fira-sans-font-family{font-family: var(--wp--preset--font-family--fira-sans) !important;}.has-fjalla-one-font-family{font-family: var(--wp--preset--font-family--fjalla-one) !important;}.has-fraunces-font-family{font-family: var(--wp--preset--font-family--fraunces) !important;}.has-gabarito-font-family{font-family: var(--wp--preset--font-family--gabarito) !important;}.has-ibm-plex-mono-font-family{font-family: var(--wp--preset--font-family--ibm-plex-mono) !important;}.has-ibm-plex-sans-font-family{font-family: var(--wp--preset--font-family--ibm-plex-sans) !important;}.has-ibarra-real-nova-font-family{font-family: var(--wp--preset--font-family--ibarra-real-nova) !important;}.has-instrument-serif-font-family{font-family: var(--wp--preset--font-family--instrument-serif) !important;}.has-inter-font-family{font-family: var(--wp--preset--font-family--inter) !important;}.has-josefin-sans-font-family{font-family: var(--wp--preset--font-family--josefin-sans) !important;}.has-jost-font-family{font-family: var(--wp--preset--font-family--jost) !important;}.has-libre-baskerville-font-family{font-family: var(--wp--preset--font-family--libre-baskerville) !important;}.has-libre-franklin-font-family{font-family: var(--wp--preset--font-family--libre-franklin) !important;}.has-literata-font-family{font-family: var(--wp--preset--font-family--literata) !important;}.has-lora-font-family{font-family: var(--wp--preset--font-family--lora) !important;}.has-merriweather-font-family{font-family: var(--wp--preset--font-family--merriweather) !important;}.has-montserrat-font-family{font-family: var(--wp--preset--font-family--montserrat) !important;}.has-newsreader-font-family{font-family: var(--wp--preset--font-family--newsreader) !important;}.has-noto-sans-mono-font-family{font-family: var(--wp--preset--font-family--noto-sans-mono) !important;}.has-nunito-font-family{font-family: var(--wp--preset--font-family--nunito) !important;}.has-open-sans-font-family{font-family: var(--wp--preset--font-family--open-sans) !important;}.has-overpass-font-family{font-family: var(--wp--preset--font-family--overpass) !important;}.has-pt-serif-font-family{font-family: var(--wp--preset--font-family--pt-serif) !important;}.has-petrona-font-family{font-family: var(--wp--preset--font-family--petrona) !important;}.has-piazzolla-font-family{font-family: var(--wp--preset--font-family--piazzolla) !important;}.has-playfair-display-font-family{font-family: var(--wp--preset--font-family--playfair-display) !important;}.has-plus-jakarta-sans-font-family{font-family: var(--wp--preset--font-family--plus-jakarta-sans) !important;}.has-poppins-font-family{font-family: var(--wp--preset--font-family--poppins) !important;}.has-raleway-font-family{font-family: var(--wp--preset--font-family--raleway) !important;}.has-roboto-font-family{font-family: var(--wp--preset--font-family--roboto) !important;}.has-roboto-slab-font-family{font-family: var(--wp--preset--font-family--roboto-slab) !important;}.has-rubik-font-family{font-family: var(--wp--preset--font-family--rubik) !important;}.has-rufina-font-family{font-family: var(--wp--preset--font-family--rufina) !important;}.has-sora-font-family{font-family: var(--wp--preset--font-family--sora) !important;}.has-source-sans-3-font-family{font-family: var(--wp--preset--font-family--source-sans-3) !important;}.has-source-serif-4-font-family{font-family: var(--wp--preset--font-family--source-serif-4) !important;}.has-space-mono-font-family{font-family: var(--wp--preset--font-family--space-mono) !important;}.has-syne-font-family{font-family: var(--wp--preset--font-family--syne) !important;}.has-texturina-font-family{font-family: var(--wp--preset--font-family--texturina) !important;}.has-urbanist-font-family{font-family: var(--wp--preset--font-family--urbanist) !important;}.has-work-sans-font-family{font-family: var(--wp--preset--font-family--work-sans) !important;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-10-1' href='https://s2.wp.com/wp-content/mu-plugins/jetpack-mu-wpcom-plugin/sun/jetpack_vendor/automattic/jetpack-mu-wpcom/src/build/verbum-comments/verbum-comments.css?m=1746618905i&cssminify=yes' type='text/css' media='all' />
<link rel='stylesheet' id='verbum-gutenberg-css-css' href='https://widgets.wp.com/verbum-block-editor/block-editor.css?ver=1738686361' media='all' />
<link crossorigin='anonymous' rel='stylesheet' id='all-css-12-1' href='https://s0.wp.com/_static/??/wp-content/themes/pub/twentyten/blocks.css,/wp-content/themes/pub/twentyten/style-wpcom.css?m=1610459589j&cssminify=yes' type='text/css' media='all' />
<style id='akismet-widget-style-inline-css'>

			.a-stats {
				--akismet-color-mid-green: #357b49;
				--akismet-color-white: #fff;
				--akismet-color-light-grey: #f6f7f7;

				max-width: 350px;
				width: auto;
			}

			.a-stats * {
				all: unset;
				box-sizing: border-box;
			}

			.a-stats strong {
				font-weight: 600;
			}

			.a-stats a.a-stats__link,
			.a-stats a.a-stats__link:visited,
			.a-stats a.a-stats__link:active {
				background: var(--akismet-color-mid-green);
				border: none;
				box-shadow: none;
				border-radius: 8px;
				color: var(--akismet-color-white);
				cursor: pointer;
				display: block;
				font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen-Sans', 'Ubuntu', 'Cantarell', 'Helvetica Neue', sans-serif;
				font-weight: 500;
				padding: 12px;
				text-align: center;
				text-decoration: none;
				transition: all 0.2s ease;
			}

			/* Extra specificity to deal with TwentyTwentyOne focus style */
			.widget .a-stats a.a-stats__link:focus {
				background: var(--akismet-color-mid-green);
				color: var(--akismet-color-white);
				text-decoration: none;
			}

			.a-stats a.a-stats__link:hover {
				filter: brightness(110%);
				box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06), 0 0 2px rgba(0, 0, 0, 0.16);
			}

			.a-stats .count {
				color: var(--akismet-color-white);
				display: block;
				font-size: 1.5em;
				line-height: 1.4;
				padding: 0 13px;
				white-space: nowrap;
			}
		
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-14-1' href='https://s1.wp.com/_static/??-eJzTLy/QTc7PK0nNK9HPLdUtyClNz8wr1i9KTcrJTwcy0/WTi5G5ekCujj52Temp+bo5+cmJJZn5eSgc3bScxMwikFb7XFtDE1NLExMLc0OTLACohS2q&cssminify=yes' type='text/css' media='all' />
<style id='jetpack-global-styles-frontend-style-inline-css'>
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-16-1' href='https://s2.wp.com/_static/??-eJyNjcsKAjEMRX/IGmYYdFyInyKZNrQd06SYFvHvfeBG3Li7By7nwK06r9JIGpTuKveYxWClVtFfPgzWBYqGzmRgCa8UMIT7e2aJW2+2gb9F5yweTH1GdqxR7Qt+ZC1ReWbTBJF1QX4dTuU47KfdPI7zYVgfuRlIaA==&cssminify=yes' type='text/css' media='all' />
<script type="text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="text/javascript" id="jetpack-mu-wpcom-settings-js-before">
/* <![CDATA[ */
var JETPACK_MU_WPCOM_SETTINGS = {"assetsUrl":"https:\/\/s1.wp.com\/wp-content\/mu-plugins\/jetpack-mu-wpcom-plugin\/sun\/jetpack_vendor\/automattic\/jetpack-mu-wpcom\/src\/build\/"};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s1.wp.com/_static/??/wp-content/mu-plugins/jetpack-plugin/sun/_inc/build/related-posts/related-posts.min.js,/wp-content/js/rlt-proxy.js?m=1733765333j'></script>
<script type="text/javascript" id="rlt-proxy-js-after">
/* <![CDATA[ */
	rltInitialize( {"token":null,"iframeOrigins":["https:\/\/widgets.wp.com"]} );
/* ]]> */
</script>
<script type="text/javascript" crossorigin='anonymous' src="https://s0.wp.com/wp-content/plugins/gutenberg-core/v20.6.0/build/hooks/index.min.js?m=1744959081i&amp;ver=84e753e2b66eb7028d38" id="wp-hooks-js"></script>
<script type="text/javascript" crossorigin='anonymous' src="https://s0.wp.com/wp-content/plugins/gutenberg-core/v20.6.0/build/i18n/index.min.js?m=1744959081i&amp;ver=bd5a2533e717a1043151" id="wp-i18n-js"></script>
<script type="text/javascript" id="wp-i18n-js-after">
/* <![CDATA[ */
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
/* ]]> */
</script>
<script type="text/javascript" id="wpcom-actionbar-placeholder-js-extra">
/* <![CDATA[ */
var actionbardata = {"siteID":"59931687","postID":"15","siteURL":"http:\/\/itmicah.wordpress.com","xhrURL":"https:\/\/itmicah.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"2b7e8ab620","isLoggedIn":"","statusMessage":"","subsEmailDefault":"instantly","proxyScriptUrl":"https:\/\/s0.wp.com\/wp-content\/js\/wpcom-proxy-request.js?ver=20211021","shortlink":"https:\/\/wp.me\/p43sY7-f","i18n":{"followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/reader\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","shortLinkCopied":"Shortlink copied to clipboard."}};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s1.wp.com/wp-content/blog-plugins/wordads-classes/js/cmp/v2/cmp-non-gdpr.js?m=1707933448i'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://itmicah.wordpress.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress.com" />
<link rel="canonical" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/" />
<link rel='shortlink' href='https://wp.me/p43sY7-f' />
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/?format=json&amp;url=https%3A%2F%2Fitmicah.wordpress.com%2F2013%2F10%2F29%2Factive-directory-ou-picker-in-powershell%2F&amp;for=wpcom-auto-discovery" /><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/?format=xml&amp;url=https%3A%2F%2Fitmicah.wordpress.com%2F2013%2F10%2F29%2Factive-directory-ou-picker-in-powershell%2F&amp;for=wpcom-auto-discovery" />
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Active Directory OU picker in powershell" />
<meta property="og:url" content="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/" />
<meta property="og:description" content="¡ This version is deprecated! New version available here. I recently started to create GUI tools using my favorite Powershell tool: Sapien Powershell Studio 2012. The function of one of my first to…" />
<meta property="article:published_time" content="2013-10-29T13:16:28+00:00" />
<meta property="article:modified_time" content="2016-11-15T12:29:42+00:00" />
<meta property="og:site_name" content="MicaH&#039;s IT blog" />
<meta property="og:image" content="https://itmicah.wordpress.com/wp-content/uploads/2013/10/ad-ou-picker1.png?w=197" />
<meta property="og:image:width" content="197" />
<meta property="og:image:height" content="300" />
<meta property="og:image:alt" content="AD OU Picker" />
<meta property="og:locale" content="en_US" />
<meta property="fb:app_id" content="249643311490" />
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom" />
<meta name="twitter:creator" content="@MicaH_Z" />
<meta name="twitter:site" content="@MicaH_Z" />
<meta name="twitter:text:title" content="Active Directory OU picker in&nbsp;powershell" />
<meta name="twitter:image" content="https://itmicah.wordpress.com/wp-content/uploads/2013/10/ad-ou-picker1.png?w=144" />
<meta name="twitter:image:alt" content="AD OU Picker" />
<meta name="twitter:card" content="summary" />

<!-- End Jetpack Open Graph Tags -->
<link rel="shortcut icon" type="image/x-icon" href="https://s1.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="icon" type="image/x-icon" href="https://s1.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="apple-touch-icon" href="https://s2.wp.com/i/webclip.png" />
<link rel='openid.server' href='https://itmicah.wordpress.com/?openidserver=1' />
<link rel='openid.delegate' href='https://itmicah.wordpress.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="https://itmicah.wordpress.com/osd.xml" title="MicaH&#039;s IT blog" />
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com" />
		<style type="text/css">
			.recentcomments a {
				display: inline !important;
				padding: 0 !important;
				margin: 0 !important;
			}

			table.recentcommentsavatartop img.avatar, table.recentcommentsavatarend img.avatar {
				border: 0px;
				margin: 0;
			}

			table.recentcommentsavatartop a, table.recentcommentsavatarend a {
				border: 0px !important;
				background-color: transparent !important;
			}

			td.recentcommentsavatarend, td.recentcommentsavatartop {
				padding: 0px 0px 1px 0px;
				margin: 0px;
			}

			td.recentcommentstextend {
				border: none !important;
				padding: 0px 0px 2px 10px;
			}

			.rtl td.recentcommentstextend {
				padding: 0px 10px 2px 0px;
			}

			td.recentcommentstexttop {
				border: none;
				padding: 0px 0px 0px 10px;
			}

			.rtl td.recentcommentstexttop {
				padding: 0px 10px 0px 0px;
			}
		</style>
		<meta name="description" content="¡ This version is deprecated! New version available here. I recently started to create GUI tools using my favorite Powershell tool: Sapien Powershell Studio 2012. The function of one of my first tools was to create users and security groups in a specific OU in Active Directory. I decided to create a seperate GUI form&hellip;" />
<style type="text/css" id="custom-background-css">
body.custom-background { background-image: url("https://itmicah.files.wordpress.com/2013/10/abstract-background-141.jpg"); background-position: center top; background-size: auto; background-repeat: repeat; background-attachment: fixed; }
</style>
	<script type="text/javascript">
/* <![CDATA[ */
var wa_client = {}; wa_client.cmd = []; wa_client.config = { 'blog_id': 59931687, 'blog_language': 'en', 'is_wordads': false, 'hosting_type': 0, 'theme': 'pub/twentyten', '_': { 'title': 'Advertisement', 'privacy_settings': 'Privacy Settings' }, 'formats': [ 'inline', 'belowpost', 'bottom_sticky', 'sidebar_sticky_right', 'sidebar' ] };
/* ]]> */
</script>
		<script type="text/javascript">
		function __ATA_CC() {var v = document.cookie.match('(^|;) ?personalized-ads-consent=([^;]*)(;|$)');return v ? 1 : 0;}
		var __ATA_PP = { 'pt': 1, 'ht': 0, 'tn': 'twentyten', 'uloggedin': 0, 'amp': false, 'consent': __ATA_CC(), 'gdpr_applies': false, 'ad': { 'label': { 'text': 'Advertisements' }, 'reportAd': { 'text': 'Report this ad' } }, 'disabled_slot_formats': [ 'IAD', 'MTS', 'DPR' ], 'siteid': 8982, 'blogid': 59931687 };
		var __ATA = __ATA || {};
		__ATA.cmd = __ATA.cmd || [];
		__ATA.criteo = __ATA.criteo || {};
		__ATA.criteo.cmd = __ATA.criteo.cmd || [];
		</script>
		<script type="text/javascript">
		(function(){var g=Date.now||function(){return+new Date};function h(a,b){a:{for(var c=a.length,d="string"==typeof a?a.split(""):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:"string"==typeof a?a.charAt(b):a[b]};function k(a,b,c){c=null!=c?"="+encodeURIComponent(String(c)):"";if(b+=c){c=a.indexOf("#");0>c&&(c=a.length);var d=a.indexOf("?");if(0>d||d>c){d=c;var e=""}else e=a.substring(d+1,c);a=[a.substr(0,d),e,a.substr(c)];c=a[1];a[1]=b?c?c+"&"+b:b:c;a=a[0]+(a[1]?"?"+a[1]:"")+a[2]}return a};var l=0;function m(a,b){var c=document.createElement("script");c.src=a;c.onload=function(){b&&b(void 0)};c.onerror=function(){b&&b("error")};a=document.getElementsByTagName("head");var d;a&&0!==a.length?d=a[0]:d=document.documentElement;d.appendChild(c)}function n(a){var b=void 0===b?document.cookie:b;return(b=h(b.split("; "),function(c){return-1!=c.indexOf(a+"=")}))?b.split("=")[1]:""}function p(a){return"string"==typeof a&&0<a.length}
		function r(a,b,c){b=void 0===b?"":b;c=void 0===c?".":c;var d=[];Object.keys(a).forEach(function(e){var f=a[e],q=typeof f;"object"==q&&null!=f||"function"==q?d.push(r(f,b+e+c)):null!==f&&void 0!==f&&(e=encodeURIComponent(b+e),d.push(e+"="+encodeURIComponent(f)))});return d.filter(p).join("&")}function t(a,b){a||((window.__ATA||{}).config=b.c,m(b.url))}var u=Math.floor(1E13*Math.random()),v=window.__ATA||{};window.__ATA=v;window.__ATA.cmd=v.cmd||[];v.rid=u;v.createdAt=g();var w=window.__ATA||{},x="s.pubmine.com";
		w&&w.serverDomain&&(x=w.serverDomain);var y="//"+x+"/conf",z=window.top===window,A=window.__ATA_PP&&window.__ATA_PP.gdpr_applies,B="boolean"===typeof A?Number(A):null,C=window.__ATA_PP||null,D=z?document.referrer?document.referrer:null:null,E=z?window.location.href:document.referrer?document.referrer:null,F,G=n("__ATA_tuuid");F=G?G:null;var H=window.innerWidth+"x"+window.innerHeight,I=n("usprivacy"),J=r({gdpr:B,pp:C,rid:u,src:D,ref:E,tuuid:F,vp:H,us_privacy:I?I:null},"",".");
		(function(a){var b=void 0===b?"cb":b;l++;var c="callback__"+g().toString(36)+"_"+l.toString(36);a=k(a,b,c);window[c]=function(d){t(void 0,d)};m(a,function(d){d&&t(d)})})(y+"?"+J);}).call(this);
		</script>	<script>
		var sas_fallback = sas_fallback || [];
		sas_fallback.push(
			{ tag: "&lt;div id=&quot;atatags-26942-{{unique_id}}&quot;&gt;&lt;/div&gt;&lt;script&gt;__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: \'atatags-26942-{{unique_id}}\',location: 120,formFactor: \'001\',label: {text: \'Advertisements\',},creative: {reportAd: {text: \'Report this ad\',},privacySettings: {text: \'Privacy\',}}});});&lt;/script&gt;", type: 'belowpost' },
			{ tag: "&lt;div id=&quot;atatags-26942-{{unique_id}}&quot;&gt;&lt;/div&gt;&lt;script&gt;__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: \'atatags-26942-{{unique_id}}\',location: 310,formFactor: \'001\',label: {text: \'Advertisements\',},creative: {reportAd: {text: \'Report this ad\',},privacySettings: {text: \'Privacy\',}}});});&lt;/script&gt;", type: 'inline' },
			{ tag: "&lt;div id=&quot;atatags-26942-{{unique_id}}&quot;&gt;&lt;/div&gt;&lt;script&gt;__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: \'atatags-26942-{{unique_id}}\',location: 140,formFactor: \'003\',label: {text: \'Advertisements\',},creative: {reportAd: {text: \'Report this ad\',},privacySettings: {text: \'Privacy\',}}});});&lt;/script&gt;", type: 'sidebar' },
			{ tag: "&lt;div id=&quot;atatags-26942-{{unique_id}}&quot;&gt;&lt;/div&gt;&lt;script&gt;__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: \'atatags-26942-{{unique_id}}\',location: 110,formFactor: \'002\',label: {text: \'Advertisements\',},creative: {reportAd: {text: \'Report this ad\',},privacySettings: {text: \'Privacy\',}}});});&lt;/script&gt;", type: 'top' }
		);
	</script>		<script type="text/javascript">

			window.doNotSellCallback = function() {

				var linkElements = [
					'a[href="https://wordpress.com/?ref=footer_blog"]',
					'a[href="https://wordpress.com/?ref=footer_website"]',
					'a[href="https://wordpress.com/?ref=vertical_footer"]',
					'a[href^="https://wordpress.com/?ref=footer_segment_"]',
				].join(',');

				var dnsLink = document.createElement( 'a' );
				dnsLink.href = 'https://wordpress.com/advertising-program-optout/';
				dnsLink.classList.add( 'do-not-sell-link' );
				dnsLink.rel = 'nofollow';
				dnsLink.style.marginLeft = '0.5em';
				dnsLink.textContent = 'Do Not Sell or Share My Personal Information';

				var creditLinks = document.querySelectorAll( linkElements );

				if ( 0 === creditLinks.length ) {
					return false;
				}

				Array.prototype.forEach.call( creditLinks, function( el ) {
					el.insertAdjacentElement( 'afterend', dnsLink );
				});

				return true;
			};

		</script>
		<script type="text/javascript">
	window.google_analytics_uacct = "UA-52447-2";
</script>

<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-52447-2']);
	_gaq.push(['_gat._anonymizeIp']);
	_gaq.push(['_setDomainName', 'wordpress.com']);
	_gaq.push(['_initData']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})();
</script>
</head>

<body class="wp-singular post-template-default single single-post postid-15 single-format-standard custom-background wp-theme-pubtwentyten customizer-styles-applied single-author jetpack-reblog-enabled has-marketing-bar has-marketing-bar-theme-twenty-ten">
<div id="wrapper" class="hfeed">
	<div id="header">
		<div id="masthead">
			<div id="branding" role="banner">
								<div id="site-title">
					<span>
						<a href="https://itmicah.wordpress.com/" title="MicaH&#039;s IT blog" rel="home">MicaH&#039;s IT blog</a>
					</span>
				</div>
				<div id="site-description">IT brainfarts for your reading pleasure</div>

									<a class="home-link" href="https://itmicah.wordpress.com/" title="MicaH&#039;s IT blog" rel="home">
						<img src="https://itmicah.wordpress.com/wp-content/uploads/2013/10/header1.jpg" width="940" height="198" alt="" />
					</a>
								</div><!-- #branding -->

			<div id="access" role="navigation">
								<div class="skip-link screen-reader-text"><a href="#content" title="Skip to content">Skip to content</a></div>
				<div class="menu-header"><ul id="menu-main-menu" class="menu"><li id="menu-item-26" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-26"><a href="https://itmicah.wordpress.com/">Home</a></li>
<li id="menu-item-70" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-70"><a>PowerShell</a>
<ul class="sub-menu">
	<li id="menu-item-30" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-30"><a href="https://itmicah.wordpress.com/category/powershell/">Microsoft PowerShell</a></li>
	<li id="menu-item-37" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-37"><a href="https://itmicah.wordpress.com/category/sapien-powershell-studio/">Sapien PowerShell Studio</a></li>
</ul>
</li>
<li id="menu-item-251" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-251"><a href="https://itmicah.wordpress.com/category/res-software/">RES Software</a>
<ul class="sub-menu">
	<li id="menu-item-32" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-32"><a href="https://itmicah.wordpress.com/category/res-software/res-workspace-manager/">RES Workspace Manager</a></li>
	<li id="menu-item-31" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-31"><a href="https://itmicah.wordpress.com/category/res-software/res-automation-manager/">RES Automation Manager</a></li>
</ul>
</li>
<li id="menu-item-36" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-36"><a href="https://itmicah.wordpress.com/category/microsoft-deployment-toolkit-mdt/">Microsoft Deployment Toolkit (MDT)</a></li>
<li id="menu-item-248" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-248"><a href="https://itmicah.wordpress.com/category/citrix/">Citrix</a></li>
<li id="menu-item-38" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38"><a href="https://itmicah.wordpress.com/about/">About</a></li>
</ul></div>			</div><!-- #access -->
		</div><!-- #masthead -->
	</div><!-- #header -->

	<div id="main">

		<div id="container">
			<div id="content" role="main">

			

				<div id="nav-above" class="navigation">
					<div class="nav-previous"><a href="https://itmicah.wordpress.com/2013/10/29/hello-world/" rel="prev"><span class="meta-nav">&larr;</span> Hello World!</a></div>
					<div class="nav-next"><a href="https://itmicah.wordpress.com/2013/10/30/res-workspace-manager-create-a-force-cache-update-application/" rel="next">RES Workspace Manager: create a Force Cache Update&nbsp;application <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-above -->

				<div id="post-15" class="post-15 post type-post status-publish format-standard hentry category-powershell category-sapien-powershell-studio tag-active-directory tag-graphical-user-interface tag-ict tag-it tag-micah tag-michaja-van-der-zouwen tag-organizational-unit tag-ou tag-ou-picker tag-ou-selection tag-powershell tag-powershell-studio tag-sapien tag-scripting tag-select-ou tag-windows-powershell">
											<h2 class="entry-title"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/" rel="bookmark">Active Directory OU picker in&nbsp;powershell</a></h2>					
					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted on</span> <a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/" title="2:16 pm" rel="bookmark"><span class="entry-date">October 29, 2013</span></a> <span class="meta-sep">by</span> <span class="author vcard"><a class="url fn n" href="https://itmicah.wordpress.com/author/itmicah/" title="View all posts by MicaH">MicaH</a></span>					</div><!-- .entry-meta -->

					<div class="entry-content">
						<blockquote>
<h3><strong><span style="color:#ff0000;">¡ This version is <span style="text-decoration:underline;">deprecated!</span> New version available</span> <a href="https://itmicah.wordpress.com/2016/03/29/active-directory-ou-picker-revisited/">here</a>.</strong></h3>
</blockquote>
<p>I recently started to create GUI tools using my favorite Powershell tool: Sapien Powershell Studio 2012. The function of one of my first tools was to create users and security groups in a specific OU in Active Directory. I decided to create a seperate GUI form for the making of a OU picker tool, so I could re-use it in other projects. I found a great base for this tool in a blogpost by <span style="text-decoration:underline;"><a href="http://thepip3r.blogspot.nl/2011/06/powershell-guis-active-directory.html" target="_blank">thepip3r&#8217;s</a></span>. This was a great start but I wanted to give it a more native AD look &amp; feel and I also wanted to be able to create a new OU if necessary.<span id="more-15"></span></p>
<p>The end result looks like this:</p>
<p><a href="https://itmicah.wordpress.com/wp-content/uploads/2013/10/ad-ou-picker1.png"><img data-attachment-id="78" data-permalink="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/ad-ou-picker-2/" data-orig-file="https://itmicah.wordpress.com/wp-content/uploads/2013/10/ad-ou-picker1.png" data-orig-size="346,526" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;}" data-image-title="AD OU Picker" data-image-description="" data-image-caption="" data-medium-file="https://itmicah.wordpress.com/wp-content/uploads/2013/10/ad-ou-picker1.png?w=197" data-large-file="https://itmicah.wordpress.com/wp-content/uploads/2013/10/ad-ou-picker1.png?w=346" class="alignnone size-medium wp-image-78" src="https://itmicah.wordpress.com/wp-content/uploads/2013/10/ad-ou-picker1.png?w=197&#038;h=300" alt="AD OU Picker" width="197" height="300" srcset="https://itmicah.wordpress.com/wp-content/uploads/2013/10/ad-ou-picker1.png?w=197 197w, https://itmicah.wordpress.com/wp-content/uploads/2013/10/ad-ou-picker1.png?w=99 99w, https://itmicah.wordpress.com/wp-content/uploads/2013/10/ad-ou-picker1.png 346w" sizes="(max-width: 197px) 100vw, 197px" /></a>     <a href="https://itmicah.wordpress.com/wp-content/uploads/2013/10/ad-ou-picker-new-ou1.png"><img data-attachment-id="79" data-permalink="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/ad-ou-picker-new-ou-2/" data-orig-file="https://itmicah.wordpress.com/wp-content/uploads/2013/10/ad-ou-picker-new-ou1.png" data-orig-size="348,526" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;}" data-image-title="AD OU Picker New OU" data-image-description="" data-image-caption="" data-medium-file="https://itmicah.wordpress.com/wp-content/uploads/2013/10/ad-ou-picker-new-ou1.png?w=198" data-large-file="https://itmicah.wordpress.com/wp-content/uploads/2013/10/ad-ou-picker-new-ou1.png?w=348" class="alignnone size-medium wp-image-79" src="https://itmicah.wordpress.com/wp-content/uploads/2013/10/ad-ou-picker-new-ou1.png?w=198&#038;h=300" alt="AD OU Picker New OU" width="198" height="300" srcset="https://itmicah.wordpress.com/wp-content/uploads/2013/10/ad-ou-picker-new-ou1.png?w=198 198w, https://itmicah.wordpress.com/wp-content/uploads/2013/10/ad-ou-picker-new-ou1.png?w=99 99w, https://itmicah.wordpress.com/wp-content/uploads/2013/10/ad-ou-picker-new-ou1.png 348w" sizes="(max-width: 198px) 100vw, 198px" /></a></p>
<p>As you can see the icons used for OU&#8217;s, folders and domains are the same as in AD Users and Computers. When selecting an OU you can create a new OU by clicking the New OU button. This will create a new OU branch in the treeview and let&#8217;s you type in a name immediately. As soon as the new name is confirmed by hitting enter the OU will be created.</p>
<p>One of the challenges in this project was that when you use the native powershell command for creating a new OU, New-ADOrganizationalUnit, you&#8217;ll receive an &#8220;Access Denied&#8221; error. For some reason you&#8217;re not allowed to create new AD objects with powershell when you&#8217;re logged on to a Domain Controller. Running the script as a domain admin and with elevated rights wasn&#8217;t enough to overcome this so I used the good old-fashioned DSADD command to create the OU. This will require your main script to be run with elevation. If not elevated hitting the New OU button will generate an error. You&#8217;ll still be able to select an OU though.</p>
<p>Hitting the OK button will create a script level variable $objSelectedOU which contains the object of the OU you selected.</p>
<p>If you want to use this for your own GUI&#8217;s you can view or download the code <a href="https://dl.dropboxusercontent.com/u/62204506/Blog/AD%20OU%20select.txt"><span style="text-decoration:underline;">here</span></a>. It&#8217;s a textfile but if you change the extension to ps1 and run it on a domain controller it will run on its own. You can copy the main function and use it in your own Powershell scripts/GUI&#8217;s. If you download it I&#8217;d appreciate a comment.</p>
<blockquote><p>Edit: In order to make this script easier for you to use I&#8217;ve turned it into a function that will return the OU object automatically. It&#8217;s available for download <a href="https://db.tt/WZxqLvRd" target="_blank">here</a>. Now you can copy the entire function Choose-ADOrganizationalUnit into your script and use it like this:</p>
<p><code>$OU = Choose-ADOrganizationalUnit</code></p>
<p>I think you&#8217;ll find it more user friendly (Yeah, I&#8217;m evolving).</p>
<p>MicaH</p></blockquote>
<blockquote><p>Edit #2: I&#8217;ve created an improved version of this function in a new blogpost: <a href="https://itmicah.wordpress.com/2016/03/29/active-directory-ou-picker-revisited/">https://itmicah.wordpress.com/2016/03/29/active-directory-ou-picker-revisited/</a>. If you&#8217;re currently using this older version please update. The new version is faster and more advanced.</p>
<p>MicaH</p></blockquote>
<div id="atatags-370373-68265fe186e42">
		<script type="text/javascript">
			__ATA.cmd.push(function() {
				__ATA.initVideoSlot('atatags-370373-68265fe186e42', {
					sectionId: '370373',
					format: 'inread'
				});
			});
		</script>
	</div><span id="wordads-inline-marker" style="display: none;"></span><div class="wordads-tag" data-slot-type="belowpost" style="display: none;"></div><div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer"
				data-shared="sharing-twitter-15"
				class="share-twitter sd-button share-icon"
				href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?share=twitter"
				target="_blank"
				aria-labelledby="sharing-twitter-15"
				>
				<span id="sharing-twitter-15" hidden>Click to share on X (Opens in new window)</span>
				<span>X</span>
			</a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer"
				data-shared="sharing-facebook-15"
				class="share-facebook sd-button share-icon"
				href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?share=facebook"
				target="_blank"
				aria-labelledby="sharing-facebook-15"
				>
				<span id="sharing-facebook-15" hidden>Click to share on Facebook (Opens in new window)</span>
				<span>Facebook</span>
			</a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer"
				data-shared="sharing-linkedin-15"
				class="share-linkedin sd-button share-icon"
				href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?share=linkedin"
				target="_blank"
				aria-labelledby="sharing-linkedin-15"
				>
				<span id="sharing-linkedin-15" hidden>Click to share on LinkedIn (Opens in new window)</span>
				<span>LinkedIn</span>
			</a></li><li class="share-email"><a rel="nofollow noopener noreferrer"
				data-shared="sharing-email-15"
				class="share-email sd-button share-icon"
				href="mailto:?subject=%5BShared%20Post%5D%20Active%20Directory%20OU%20picker%20in%20powershell&#038;body=https%3A%2F%2Fitmicah.wordpress.com%2F2013%2F10%2F29%2Factive-directory-ou-picker-in-powershell%2F&#038;share=email"
				target="_blank"
				aria-labelledby="sharing-email-15"
				data-email-share-error-title="Do you have email set up?" data-email-share-error-text="If you&#039;re having problems sharing via email, you might not have email set up for your browser. You may need to create a new email yourself." data-email-share-nonce="13e024c551" data-email-share-track-url="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?share=email">
				<span id="sharing-email-15" hidden>Click to email a link to a friend (Opens in new window)</span>
				<span>Email</span>
			</a></li><li class="share-end"></li></ul></div></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-59931687-15-68265fe187b86' data-src='//widgets.wp.com/likes/index.html?ver=20250515#blog_id=59931687&amp;post_id=15&amp;origin=itmicah.wordpress.com&amp;obj_id=59931687-15-68265fe187b86' data-name='like-post-frame-59931687-15-68265fe187b86' data-title='Like or Reblog'><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height: 55px;'><span class='button'><span>Like</span></span> <span class='loading'>Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div></div>											</div><!-- .entry-content -->

							<div id="entry-author-info">
						<div id="author-avatar">
							<img referrerpolicy="no-referrer" alt='Unknown&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=90&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=180&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=240&#038;d=identicon&#038;r=G 4x' class='avatar avatar-60' height='60' width='60' loading='lazy' decoding='async' />						</div><!-- #author-avatar -->
						<div id="author-description">
							<h2>
							About MicaH							</h2>
							I'm a Senior Technical Specialist at PepperByte BV (the Netherlands).							<div id="author-link">
								<a href="https://itmicah.wordpress.com/author/itmicah/" rel="author">
									View all posts by MicaH <span class="meta-nav">&rarr;</span>								</a>
							</div><!-- #author-link	-->
						</div><!-- #author-description -->
					</div><!-- #entry-author-info -->

						<div class="entry-utility">
							This entry was posted in <a href="https://itmicah.wordpress.com/category/powershell/" rel="category tag">Powershell</a>, <a href="https://itmicah.wordpress.com/category/sapien-powershell-studio/" rel="category tag">Sapien Powershell Studio</a> and tagged <a href="https://itmicah.wordpress.com/tag/active-directory/" rel="tag">Active Directory</a>, <a href="https://itmicah.wordpress.com/tag/graphical-user-interface/" rel="tag">Graphical user interface</a>, <a href="https://itmicah.wordpress.com/tag/ict/" rel="tag">ICT</a>, <a href="https://itmicah.wordpress.com/tag/it/" rel="tag">IT</a>, <a href="https://itmicah.wordpress.com/tag/micah/" rel="tag">MicaH</a>, <a href="https://itmicah.wordpress.com/tag/michaja-van-der-zouwen/" rel="tag">Michaja van der Zouwen</a>, <a href="https://itmicah.wordpress.com/tag/organizational-unit/" rel="tag">Organizational Unit</a>, <a href="https://itmicah.wordpress.com/tag/ou/" rel="tag">OU</a>, <a href="https://itmicah.wordpress.com/tag/ou-picker/" rel="tag">OU picker</a>, <a href="https://itmicah.wordpress.com/tag/ou-selection/" rel="tag">OU selection</a>, <a href="https://itmicah.wordpress.com/tag/powershell/" rel="tag">Powershell</a>, <a href="https://itmicah.wordpress.com/tag/powershell-studio/" rel="tag">Powershell Studio</a>, <a href="https://itmicah.wordpress.com/tag/sapien/" rel="tag">Sapien</a>, <a href="https://itmicah.wordpress.com/tag/scripting/" rel="tag">scripting</a>, <a href="https://itmicah.wordpress.com/tag/select-ou/" rel="tag">select OU</a>, <a href="https://itmicah.wordpress.com/tag/windows-powershell/" rel="tag">Windows PowerShell</a>. Bookmark the <a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/" title="Permalink to Active Directory OU picker in&nbsp;powershell" rel="bookmark">permalink</a>.													</div><!-- .entry-utility -->
					</div><!-- #post-15 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="https://itmicah.wordpress.com/2013/10/29/hello-world/" rel="prev"><span class="meta-nav">&larr;</span> Hello World!</a></div>
					<div class="nav-next"><a href="https://itmicah.wordpress.com/2013/10/30/res-workspace-manager-create-a-force-cache-update-application/" rel="next">RES Workspace Manager: create a Force Cache Update&nbsp;application <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
			<div id="comments">


			<h3 id="comments-title">
			49 Responses to <em>Active Directory OU picker in&nbsp;powershell</em>			</h3>


			<ol class="commentlist">
						<li class="comment even thread-even depth-1" id="li-comment-3">
		<div id="comment-3">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='Vinit&#039;s avatar' src='https://2.gravatar.com/avatar/b1aff7ede8b46508a7f7487b8816ad7217ed6e824c7d89a6a271bdeb8b9a7df3?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/b1aff7ede8b46508a7f7487b8816ad7217ed6e824c7d89a6a271bdeb8b9a7df3?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/b1aff7ede8b46508a7f7487b8816ad7217ed6e824c7d89a6a271bdeb8b9a7df3?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/b1aff7ede8b46508a7f7487b8816ad7217ed6e824c7d89a6a271bdeb8b9a7df3?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/b1aff7ede8b46508a7f7487b8816ad7217ed6e824c7d89a6a271bdeb8b9a7df3?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/b1aff7ede8b46508a7f7487b8816ad7217ed6e824c7d89a6a271bdeb8b9a7df3?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn">Vinit</cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-3">
				December 31, 2013 at 3:56 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>I liked this code very much as it was the thing that i was looking for&#8230;&#8230;but it takes a lot of time to load (form)&#8230;..</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=3#respond" data-commentid="3" data-postid="15" data-belowelement="comment-3" data-respondelement="respond" data-replyto="Reply to Vinit" aria-label="Reply to Vinit">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				<ul class="children">
		<li class="comment byuser comment-author-itmicah bypostauthor odd alt depth-2" id="li-comment-4">
		<div id="comment-4">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='MicaH&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://itmicah.wordpress.com" class="url" rel="ugc">MicaH</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-4">
				December 31, 2013 at 4:11 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Really? It only takes about three seconds on my testservers. I guess it depends on the depth of your OU structure.</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=4#respond" data-commentid="4" data-postid="15" data-belowelement="comment-4" data-respondelement="respond" data-replyto="Reply to MicaH" aria-label="Reply to MicaH">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				<ul class="children">
		<li class="comment even depth-3" id="li-comment-5">
		<div id="comment-5">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='Vinit&#039;s avatar' src='https://2.gravatar.com/avatar/b1aff7ede8b46508a7f7487b8816ad7217ed6e824c7d89a6a271bdeb8b9a7df3?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/b1aff7ede8b46508a7f7487b8816ad7217ed6e824c7d89a6a271bdeb8b9a7df3?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/b1aff7ede8b46508a7f7487b8816ad7217ed6e824c7d89a6a271bdeb8b9a7df3?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/b1aff7ede8b46508a7f7487b8816ad7217ed6e824c7d89a6a271bdeb8b9a7df3?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/b1aff7ede8b46508a7f7487b8816ad7217ed6e824c7d89a6a271bdeb8b9a7df3?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/b1aff7ede8b46508a7f7487b8816ad7217ed6e824c7d89a6a271bdeb8b9a7df3?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn">Vinit</cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-5">
				December 31, 2013 at 4:25 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Here is the script that I have but it has couple of issues:<br />
1) It gives me complete path i.e. OU = ABC, DC = xyz, DC= COM&#8230;&#8230;.However i want only ABC to be appeared.<br />
2) i want it that it should stop at sites name&#8230;&#8230;.i mean should not go for looking for users under site name.</p>
<p>Can you please reply on that ?</p>
<p># the Main function that can be loaded or gets started at the end of the script </p>
<p>Function Browse-ActiveDirectory { </p>
<p>$root=[ADSI]&#8221;</p>
<p># Try to connect to the Domain root </p>
<p>[void]$Root.psbase.get_Name()} </p>
<p># Make the form<br />
# add a reference to the forms assembly<br />
[System.Reflection.Assembly]::LoadWithPartialName(&#8220;System.Windows.Forms&#8221;)</p>
<p>$form = new-object Windows.Forms.form<br />
$form.Size = new-object System.Drawing.Size @(510,560)<br />
$form.text = &#8220;AD&#8221;<br />
$form.StartPosition = &#8220;CenterScreen&#8221;<br />
$form.Topmost = $True<br />
$form.Opacity = 2.0<br />
$form.ShowIcon = $False<br />
$form.AutoSize = $False<br />
$form.MinimizeBox = $False<br />
$form.MaximizeBox = $False<br />
$form.SizeGripStyle= &#8220;Hide&#8221;<br />
$form.WindowState = &#8220;Normal&#8221;<br />
$form.FormBorderStyle=&#8221;Fixed3D&#8221; </p>
<p># Make TreeView to hold the Domain Tree </p>
<p>$TV = new-object windows.forms.TreeView<br />
$TV.Location = new-object System.Drawing.Size(10,10)<br />
$TV.size = new-object System.Drawing.Size(470,470)<br />
$TV.Anchor = &#8220;top, left, right&#8221; </p>
<p># Add the Button to close the form and return the selected DirectoryEntry </p>
<p>$btnSelect = new-object System.Windows.Forms.Button<br />
$btnSelect.text = &#8220;&amp;Select&#8221;<br />
$btnSelect.Location = new-object System.Drawing.Size(10,480)<br />
$btnSelect.size = new-object System.Drawing.Size(70,30)<br />
$btnSelect.Anchor = &#8220;Bottom, Left&#8221;<br />
$btnSelect.add_Click($handler_OKButton_Click)</p>
<p># If Select button pressed set return value to Selected DirectoryEntry and close form </p>
<p>$handler_OKButton_Click=<br />
{<br />
$script = $TV.SelectedNode.text<br />
Write-Host $script<br />
$script:Return = $true<br />
$form.close()<br />
} </p>
<p># Add Cancel button </p>
<p>$btnCancel = new-object System.Windows.Forms.Button<br />
$btnCancel.text = &#8220;&amp;Cancel&#8221;<br />
$btnCancel.Location = new-object System.Drawing.Size(90,480)<br />
$btnCancel.size = new-object System.Drawing.Size(70,30)<br />
$btnCancel.Anchor = &#8220;Bottom, Left&#8221; </p>
<p># If cancel button is clicked set returnvalue to $False and close form<br />
$btnCancel.add_Click({$script:Return = $false ; $form.close()}) </p>
<p># Create a TreeNode for the domain root found </p>
<p>$TNRoot = new-object System.Windows.Forms.TreeNode(&#8220;Root&#8221;)<br />
#$TNRoot.Name = $root.name<br />
$TNRoot.Text = $root.distinguishedName<br />
$TNRoot.tag = &#8220;NotEnumerated&#8221; </p>
<p># First time a Node is Selected, enumerate the Children of the selected DirectoryEntry </p>
<p>$TV.add_AfterSelect({ </p>
<p>if ($this.SelectedNode.tag -eq &#8220;NotEnumerated&#8221;) { </p>
<p>$de = [ADSI]&#8221;LDAP://$($this.SelectedNode.text)&#8221;</p>
<p># Add all Children found as Sub Nodes to the selected TreeNode </p>
<p>$de.psBase.get_Children() |<br />
foreach {<br />
$TN = new-object System.Windows.Forms.TreeNode<br />
$TN.Name = $_.name<br />
$TN.Text = $_.distinguishedName<br />
$TN.tag = &#8220;NotEnumerated&#8221;<br />
$this.SelectedNode.Nodes.Add($TN) </p>
<p>} </p>
<p># Set tag to show this node is already enumerated </p>
<p>$this.SelectedNode.tag = &#8220;Enumerated&#8221; </p>
<p>} </p>
<p>}) </p>
<p># Add the RootNode to the Treeview </p>
<p>[void]$TV.Nodes.Add($TNRoot) </p>
<p># Add the Controls to the Form </p>
<p>$form.Controls.Add($TV)<br />
$form.Controls.Add($btnSelect)<br />
$form.Controls.Add($btnCancel) </p>
<p># Set the Select Button as the Default </p>
<p>$form.AcceptButton = $btnSelect </p>
<p>$Form.Add_Shown({$form.Activate()})<br />
[void]$form.showdialog() </p>
<p># Return selected DirectoryEntry or $false as Cancel Button is Used<br />
Return $script:Return<br />
} </p>
<p># If used as a script start the function </p>
<p>Set-PSDebug -Strict:$false # Otherwise Checking the Switch parmeter does fail (Bug ?) </p>
<p>if ($LoadOnly.IsPresent) { </p>
<p># Only load the Function for interactive use </p>
<p>if (-not $MyInvocation.line.StartsWith(&#8216;. &#8216;)) {<br />
Write-Warning &#8220;LoadOnly Switch is given but you also need to &#8216;dotsource&#8217; the script to load the function in the global scope&#8221;<br />
Write-Host &#8220;To Start a script in the global scope (dotsource) put a dot and a space in front of path to the script&#8221;<br />
Write-Host &#8220;If the script is in the current directory this would look like this :&#8221;<br />
Write-Host &#8220;. .\ActiveDirectoryBrowser.Ps1&#8221;<br />
Write-Host &#8220;then :&#8221;<br />
}<br />
Write-Host &#8220;The Browse-ActiveDirectory Function is loaded and can be used like this :&#8221;<br />
Write-Host &#8216;$de = Browse-ActiveDirectory&#8217;<br />
Set-alias bad Browse-ActiveDirectory<br />
}<br />
Else { </p>
<p> #start Function<br />
 . Browse-ActiveDirectory $root </p>
<p>}</p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
		<li class="comment byuser comment-author-itmicah bypostauthor odd alt depth-3" id="li-comment-6">
		<div id="comment-6">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='MicaH&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://itmicah.wordpress.com" class="url" rel="ugc">MicaH</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-6">
				December 31, 2013 at 5:07 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>1) change $TNRoot.Text = $root.distinguishedName to $TNRoot.Text = $root.name<br />
2) I&#8217;d have to look into that in a test environment. I&#8217;ll get back to you if I get a chance to look at it.</p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
		<li class="comment even depth-3" id="li-comment-7">
		<div id="comment-7">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='Vinit&#039;s avatar' src='https://2.gravatar.com/avatar/b1aff7ede8b46508a7f7487b8816ad7217ed6e824c7d89a6a271bdeb8b9a7df3?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/b1aff7ede8b46508a7f7487b8816ad7217ed6e824c7d89a6a271bdeb8b9a7df3?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/b1aff7ede8b46508a7f7487b8816ad7217ed6e824c7d89a6a271bdeb8b9a7df3?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/b1aff7ede8b46508a7f7487b8816ad7217ed6e824c7d89a6a271bdeb8b9a7df3?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/b1aff7ede8b46508a7f7487b8816ad7217ed6e824c7d89a6a271bdeb8b9a7df3?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/b1aff7ede8b46508a7f7487b8816ad7217ed6e824c7d89a6a271bdeb8b9a7df3?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn">Vinit</cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-7">
				December 31, 2013 at 6:15 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Thanks&#8230;..it changes root from OU = ABC, DC = xyz, DC= COM to be appeared as ABC but not children()&#8230;..However i tried to change $TN.text = $_.distinguishedname to $TN.text = $_.name but that doesn&#8217;t work and throws error.<br />
Any help would be appreciated.</p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-8">
		<div id="comment-8">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='Cory&#039;s avatar' src='https://0.gravatar.com/avatar/9271e1d830b272a9fb18dc014a6d1a98cf15a76411f89ed0a93d4abc99cc3935?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/9271e1d830b272a9fb18dc014a6d1a98cf15a76411f89ed0a93d4abc99cc3935?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/9271e1d830b272a9fb18dc014a6d1a98cf15a76411f89ed0a93d4abc99cc3935?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/9271e1d830b272a9fb18dc014a6d1a98cf15a76411f89ed0a93d4abc99cc3935?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/9271e1d830b272a9fb18dc014a6d1a98cf15a76411f89ed0a93d4abc99cc3935?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/9271e1d830b272a9fb18dc014a6d1a98cf15a76411f89ed0a93d4abc99cc3935?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn">Cory</cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-8">
				January 7, 2014 at 6:42 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Hello,</p>
<p>Thanks for the code, it is just what I was looking for.  I made a small modification to enable choosing a different child domain.  It may be beneficial to others, here is the change:</p>
<p>	$FormEvent_Load={<br />
		Import-Module ActiveDirectory<br />
	    $objIPProperties = [System.Net.NetworkInformation.IPGlobalProperties]::GetIPGlobalProperties()<br />
	    $strDNSDomain = $objIPProperties.DomainName.toLower()<br />
        $domains=(get-addomain $strDNSDomain).childdomains<br />
        $domains += $strDNSDomain<br />
        Write-Host &#8220;Please pick a domain.&#8221;<br />
        $i = 0<br />
        foreach ($domain in $domains){<br />
            write-host  $i -&gt; $domain<br />
            $i++<br />
        }<br />
        $d = Read-Host &#8220;Domain: &#8221;<br />
        #may not work if logged on to a child domain &#8212; need to test</p>
<p>        $strDNSDomain = $domains[$d]</p>
<p>        $strDomainDN = $strDNSDomain.toString().split(&#8216;.&#8217;); foreach ($strVal in $strDomainDN) {$strTemp += &#8220;dc=$strVal,&#8221;}; $strDomainDN = $strTemp.TrimEnd(&#8220;,&#8221;).toLower()<br />
		Build-TreeView<br />
	}</p>
<p>Also line 99 would need to change to:<br />
  $OUs = Get-ADObject -Filter &#8216;ObjectClass -eq &#8220;organizationalUnit&#8221; -or ObjectClass -eq &#8220;container&#8221;&#8216; -SearchScope OneLevel -SearchBase $dn -Server $strDNSDomain</p>
<p>Thanks for the help!</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=8#respond" data-commentid="8" data-postid="15" data-belowelement="comment-8" data-respondelement="respond" data-replyto="Reply to Cory" aria-label="Reply to Cory">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				<ul class="children">
		<li class="comment byuser comment-author-itmicah bypostauthor even depth-2" id="li-comment-9">
		<div id="comment-9">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='MicaH&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://itmicah.wordpress.com" class="url" rel="ugc">MicaH</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-9">
				January 7, 2014 at 9:19 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>You&#8217;re welcome, Cory. Great idea about the child domains, I hadn&#8217;t thought of that. Maybe I&#8217;ll integrate your solution in my script. Thanks for sharing it and for your positive feedback.</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=9#respond" data-commentid="9" data-postid="15" data-belowelement="comment-9" data-respondelement="respond" data-replyto="Reply to MicaH" aria-label="Reply to MicaH">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="li-comment-36">
		<div id="comment-36">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='Jay&#039;s avatar' src='https://0.gravatar.com/avatar/9afecb1049f196ae79979f74f0d82cc294a2c60cff8e6bc661e0aac36c99a9d9?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/9afecb1049f196ae79979f74f0d82cc294a2c60cff8e6bc661e0aac36c99a9d9?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/9afecb1049f196ae79979f74f0d82cc294a2c60cff8e6bc661e0aac36c99a9d9?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/9afecb1049f196ae79979f74f0d82cc294a2c60cff8e6bc661e0aac36c99a9d9?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/9afecb1049f196ae79979f74f0d82cc294a2c60cff8e6bc661e0aac36c99a9d9?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/9afecb1049f196ae79979f74f0d82cc294a2c60cff8e6bc661e0aac36c99a9d9?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn">Jay</cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-36">
				May 20, 2014 at 6:40 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Michaja,<br />
I also have PowerShell Studio 2012. Would it be possible to provide the .pff file of your script? This would help me to add more controls for specific applications related to AD.</p>
<p>-Jay</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=36#respond" data-commentid="36" data-postid="15" data-belowelement="comment-36" data-respondelement="respond" data-replyto="Reply to Jay" aria-label="Reply to Jay">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				<ul class="children">
		<li class="comment byuser comment-author-itmicah bypostauthor even depth-2" id="li-comment-39">
		<div id="comment-39">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='MicaH&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://itmicah.wordpress.com" class="url" rel="ugc">MicaH</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-39">
				May 22, 2014 at 2:27 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Here you go: <a href="https://dl.dropboxusercontent.com/u/62204506/Blog/AD-OU-Selection.zip" rel="nofollow ugc">https://dl.dropboxusercontent.com/u/62204506/Blog/AD-OU-Selection.zip</a><br />
Just know that if you develop a kick-ass tool and get paid big for it I will be expecting royalties! ;^)</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=39#respond" data-commentid="39" data-postid="15" data-belowelement="comment-39" data-respondelement="respond" data-replyto="Reply to MicaH" aria-label="Reply to MicaH">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				<ul class="children">
		<li class="comment odd alt depth-3" id="li-comment-41">
		<div id="comment-41">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='Jay&#039;s avatar' src='https://0.gravatar.com/avatar/9afecb1049f196ae79979f74f0d82cc294a2c60cff8e6bc661e0aac36c99a9d9?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/9afecb1049f196ae79979f74f0d82cc294a2c60cff8e6bc661e0aac36c99a9d9?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/9afecb1049f196ae79979f74f0d82cc294a2c60cff8e6bc661e0aac36c99a9d9?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/9afecb1049f196ae79979f74f0d82cc294a2c60cff8e6bc661e0aac36c99a9d9?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/9afecb1049f196ae79979f74f0d82cc294a2c60cff8e6bc661e0aac36c99a9d9?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/9afecb1049f196ae79979f74f0d82cc294a2c60cff8e6bc661e0aac36c99a9d9?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn">Jay</cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-41">
				May 22, 2014 at 3:02 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Thank you very much, and it&#8217;s a deal. Currently trying to use your form to pick OU&#8217;s, and eventually users to copy them from a production domain into a test domain. Each side has a text box to enter in the root of the domain, Then you select the OU you want to copy (eventually would like to select multiples) then create that OU in the new domain based off where you select the starting OU. During the creation it would replace the original DC=blah,CN=blah with the new DC, and CN&#8217;s from the root domain entered into the text box.</p>
<p>Same thing with the users. It would copy the users with a set number of attributes replacing anything like their UPN or email with the new domain suffix.<br />
 Currently client is doing this manually for three different test domains, trying to simplify the process without using scripts that require a csv file to be edited with find and replace. </p>
<p>Should be fun, and don&#8217;t be surprised if I hit you back with questions lol.</p>
<p>Thanks again MicaH,</p>
<p>-Jay</p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
		<li class="comment byuser comment-author-itmicah bypostauthor even depth-3" id="li-comment-44">
		<div id="comment-44">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='MicaH&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://itmicah.wordpress.com" class="url" rel="ugc">MicaH</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-44">
				May 23, 2014 at 10:57 am</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>You&#8217;re welcome, Jay. Us scripting geeks need to stick together, right?</p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-92">
		<div id="comment-92">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='Dave&#039;s avatar' src='https://0.gravatar.com/avatar/63cd2d56eace8690b7bf9c050f1ec72ca812939a46fb30961f6b2ac928dcf8cb?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/63cd2d56eace8690b7bf9c050f1ec72ca812939a46fb30961f6b2ac928dcf8cb?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/63cd2d56eace8690b7bf9c050f1ec72ca812939a46fb30961f6b2ac928dcf8cb?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/63cd2d56eace8690b7bf9c050f1ec72ca812939a46fb30961f6b2ac928dcf8cb?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/63cd2d56eace8690b7bf9c050f1ec72ca812939a46fb30961f6b2ac928dcf8cb?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/63cd2d56eace8690b7bf9c050f1ec72ca812939a46fb30961f6b2ac928dcf8cb?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn">Dave</cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-92">
				August 13, 2014 at 12:04 am</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>This is awesome.  I&#8217;m wanting to use this for our techs when they image comptuers via SCCM to be able to choose the OU the PC ends up in.  I&#8217;m pretty new to PS but love it.  Where would the output be for the OU they choose so I can pipe it into the join domain script?</p>
<p>Thanks!!!!!</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=92#respond" data-commentid="92" data-postid="15" data-belowelement="comment-92" data-respondelement="respond" data-replyto="Reply to Dave" aria-label="Reply to Dave">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				<ul class="children">
		<li class="comment byuser comment-author-itmicah bypostauthor even depth-2" id="li-comment-93">
		<div id="comment-93">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='MicaH&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://itmicah.wordpress.com" class="url" rel="ugc">MicaH</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-93">
				August 13, 2014 at 12:59 am</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>That&#8217;s an interesting use for it! I hadn&#8217;t considered that. I&#8217;ve given this some thought but sadly my script can&#8217;t be incorporated into a PE environment. It only runs on a domain joined computer and the account you run it with must have at least read rights on your AD structure. So you&#8217;d have to connect to a Domain Joined server first and the run the script through that connection. However, even thought PowerShell and DotNet can both run within WinPE you can&#8217;t use PowerShell remoting in a PE environment. Maybe you could try psexec to run the script remotely but that&#8217;s a long shot! If you do get this working I&#8217;d like to hear all about it. It would be a great addition to the SCCM menu structure! </p>
<p>Anyway, back to answer you&#8217;re original question! The script doesn&#8217;t generate output, it just sets a variable for your scripting environment containing the OU object you selected. But it could easily be customized to set the appropriate TaskSequence variable for SCCM. Just find the line in the script that looks like this:</p>
<p>$buttonOK_Click={</p>
<p>}</p>
<p>As you&#8217;ve guessed this is where you can customize what happens with the selected OU information. Hope it helps and thanks for your feedback!</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=93#respond" data-commentid="93" data-postid="15" data-belowelement="comment-93" data-respondelement="respond" data-replyto="Reply to MicaH" aria-label="Reply to MicaH">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				<ul class="children">
		<li class="comment odd alt depth-3" id="li-comment-94">
		<div id="comment-94">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='Dave&#039;s avatar' src='https://0.gravatar.com/avatar/63cd2d56eace8690b7bf9c050f1ec72ca812939a46fb30961f6b2ac928dcf8cb?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/63cd2d56eace8690b7bf9c050f1ec72ca812939a46fb30961f6b2ac928dcf8cb?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/63cd2d56eace8690b7bf9c050f1ec72ca812939a46fb30961f6b2ac928dcf8cb?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/63cd2d56eace8690b7bf9c050f1ec72ca812939a46fb30961f6b2ac928dcf8cb?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/63cd2d56eace8690b7bf9c050f1ec72ca812939a46fb30961f6b2ac928dcf8cb?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/63cd2d56eace8690b7bf9c050f1ec72ca812939a46fb30961f6b2ac928dcf8cb?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn">Dave</cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-94">
				August 13, 2014 at 4:01 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Hmm&#8230;  Will work on that, but if not for imaging would be useful for mass running up PCs from the factory that have already been imaged with our image as they would be domain members when they come up.  Already have a script in the run once that prompts to change the computer name when they come up.  I hadn&#8217;t actually picked in OU while running the script until this morning.  When I do I get the following error:</p>
<p>Get-ADObject : Cannot validate argument on parameter &#8216;Identity&#8217;. The argument is null. Supply a<br />
non-null argument and try the command again.<br />
At line:178 char:50<br />
+         $script:objSelectedOU = Get-ADObject -Identity $SelectedOU.name<br />
+                                                        ~~~~~~~~~~~~~~~~<br />
    + CategoryInfo          : InvalidData: (:) [Get-ADObject], ParameterBindingValidationException<br />
    + FullyQualifiedErrorId : ParameterArgumentValidationError,Microsoft.ActiveDirectory.Management.C<br />
   ommands.GetADObject</p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
		<li class="comment byuser comment-author-itmicah bypostauthor even depth-3" id="li-comment-95">
		<div id="comment-95">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='MicaH&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://itmicah.wordpress.com" class="url" rel="ugc">MicaH</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-95">
				August 16, 2014 at 2:41 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Hi Dave. I&#8217;ve discovered this happens on OS&#8217;s higher than 2008 R2. I&#8217;ve corrected the issue. Please re-download the script and try again. If you have anymore issues please let me know. If it works now I&#8217;d like to know also. </p>
<p>Thanks for the feedback!</p>
<p>MicaH</p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-vthinktank odd alt thread-even depth-1" id="li-comment-113">
		<div id="comment-113">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='vthinktank&#039;s avatar' src='https://1.gravatar.com/avatar/d79ed8ae5e9628289e4f4d57ce23840932aa2f5d751f8e04163bff9cf572208d?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/d79ed8ae5e9628289e4f4d57ce23840932aa2f5d751f8e04163bff9cf572208d?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/d79ed8ae5e9628289e4f4d57ce23840932aa2f5d751f8e04163bff9cf572208d?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/d79ed8ae5e9628289e4f4d57ce23840932aa2f5d751f8e04163bff9cf572208d?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/d79ed8ae5e9628289e4f4d57ce23840932aa2f5d751f8e04163bff9cf572208d?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/d79ed8ae5e9628289e4f4d57ce23840932aa2f5d751f8e04163bff9cf572208d?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn">vthinktank</cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-113">
				September 25, 2014 at 8:49 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Has anyone tried this using XAML and Powershell ?</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=113#respond" data-commentid="113" data-postid="15" data-belowelement="comment-113" data-respondelement="respond" data-replyto="Reply to vthinktank" aria-label="Reply to vthinktank">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jeffirvine even thread-odd thread-alt depth-1" id="li-comment-153">
		<div id="comment-153">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='jeffirvine&#039;s avatar' src='https://0.gravatar.com/avatar/31ecc4d8be48b477c0b24c0443c18af01a60ad2df1c2acc435b435810c9f76c7?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/31ecc4d8be48b477c0b24c0443c18af01a60ad2df1c2acc435b435810c9f76c7?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/31ecc4d8be48b477c0b24c0443c18af01a60ad2df1c2acc435b435810c9f76c7?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/31ecc4d8be48b477c0b24c0443c18af01a60ad2df1c2acc435b435810c9f76c7?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/31ecc4d8be48b477c0b24c0443c18af01a60ad2df1c2acc435b435810c9f76c7?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/31ecc4d8be48b477c0b24c0443c18af01a60ad2df1c2acc435b435810c9f76c7?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn">jeffirvine</cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-153">
				December 12, 2014 at 5:49 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Hi MicaH, I just wanted to say thank you for posting all of this. I have been working on an &#8220;AD Updater&#8221; for our front desk staff and needed exactly this. I originally took your script and modified it to work for my project to only select Search OUs. I spent a lot of time on it yesterday and finally got it to work but kept thinking to myself, &#8220;I wish I could see his project file so I could see exactly how he did all this&#8221;. If only I would have scrolled down into the comments to see that you posted it! Doh! It&#8217;s all good though, because I learned some things and that&#8217;s what it&#8217;s really all about, right?</p>
<p>Thanks again for this.</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=153#respond" data-commentid="153" data-postid="15" data-belowelement="comment-153" data-respondelement="respond" data-replyto="Reply to jeffirvine" aria-label="Reply to jeffirvine">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				<ul class="children">
		<li class="comment byuser comment-author-itmicah bypostauthor odd alt depth-2" id="li-comment-154">
		<div id="comment-154">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='MicaH&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://itmicah.wordpress.com" class="url" rel="ugc">MicaH</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-154">
				December 12, 2014 at 11:40 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>You&#8217;re welcome, Jeff. Glad to be of service.</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=154#respond" data-commentid="154" data-postid="15" data-belowelement="comment-154" data-respondelement="respond" data-replyto="Reply to MicaH" aria-label="Reply to MicaH">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="li-comment-171">
		<div id="comment-171">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='Brecht Gijbels&#039;s avatar' src='https://i0.wp.com/lh6.googleusercontent.com/-WVsTMeQzQ34/AAAAAAAAAAI/AAAAAAAATx0/wxZCE3UDy4s/photo.jpg?resize=40%2C40&#038;ssl=1' srcset='https://i0.wp.com/lh6.googleusercontent.com/-WVsTMeQzQ34/AAAAAAAAAAI/AAAAAAAATx0/wxZCE3UDy4s/photo.jpg?resize=40%2C40&#038;ssl=1 1x, https://i0.wp.com/lh6.googleusercontent.com/-WVsTMeQzQ34/AAAAAAAAAAI/AAAAAAAATx0/wxZCE3UDy4s/photo.jpg?resize=60%2C60&#038;ssl=1 1.5x, https://i0.wp.com/lh6.googleusercontent.com/-WVsTMeQzQ34/AAAAAAAAAAI/AAAAAAAATx0/wxZCE3UDy4s/photo.jpg?resize=80%2C80&#038;ssl=1 2x, https://i0.wp.com/lh6.googleusercontent.com/-WVsTMeQzQ34/AAAAAAAAAAI/AAAAAAAATx0/wxZCE3UDy4s/photo.jpg?resize=120%2C120&#038;ssl=1 3x, https://i0.wp.com/lh6.googleusercontent.com/-WVsTMeQzQ34/AAAAAAAAAAI/AAAAAAAATx0/wxZCE3UDy4s/photo.jpg?resize=160%2C160&#038;ssl=1 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://plus.google.com/+BrechtGijbels" class="url" rel="ugc external nofollow">Brecht Gijbels</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-171">
				January 12, 2015 at 8:41 am</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Hi MicaH, this is really a great GUI! Thank you very much for the hard work here.<br />
&#8211; Is it possible to have checkboxes in front of the OU? So you can select multiple at the same time?<br />
&#8211; It takes 25 seconds to load, it would be great if it&#8217;s possible to preload it and then just call it when I need it. Still need to think about how to implement this properly.<br />
Thank you for your feedback.</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=171#respond" data-commentid="171" data-postid="15" data-belowelement="comment-171" data-respondelement="respond" data-replyto="Reply to Brecht Gijbels" aria-label="Reply to Brecht Gijbels">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				<ul class="children">
		<li class="comment byuser comment-author-itmicah bypostauthor odd alt depth-2" id="li-comment-172">
		<div id="comment-172">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='MicaH&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://itmicah.wordpress.com" class="url" rel="ugc">MicaH</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-172">
				January 12, 2015 at 9:47 am</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Hi Brecht. Checkboxes shouldn&#8217;t be a problem, although checked boxes are not treated as if they are “selected”. For a good tutorial check this <a href="http://www.sapien.com/blog/2011/11/14/primalforms-2011-spotlight-on-the-treeview-control-part-1/" title="Spotlight on the treeview control" target="_blank" rel="nofollow">link</a>. You might already be able to select multiple OU&#8217;s  bij holding the Ctrl key but I haven&#8217;t tried that myself, so dont hold me to it.<br />
Preloading sounds interesting. You could alter the function so that the form comes up invisible and call the function at the start of the script as a background job. You could then create a button that makes the form visible. You&#8217;ll have to build in a check wether the background job has finished or not. If not, you could change the mouse icon to &#8216;Waiting&#8217; until it is ready, then change it back to normal. Otherwise, people will think the button isn&#8217;t working and they&#8217;ll just keep clicking it! This is all theoretical, I have no idea if it&#8217;ll work this way, but I thought I&#8217;d give you my two cents anyway. Hopefully it will point you in the right direction. Let me know how it turns out!!</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=172#respond" data-commentid="172" data-postid="15" data-belowelement="comment-172" data-respondelement="respond" data-replyto="Reply to MicaH" aria-label="Reply to MicaH">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				<ul class="children">
		<li class="comment even depth-3" id="li-comment-173">
		<div id="comment-173">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='Brecht Gijbels&#039;s avatar' src='https://i0.wp.com/lh6.googleusercontent.com/-WVsTMeQzQ34/AAAAAAAAAAI/AAAAAAAATx0/wxZCE3UDy4s/photo.jpg?resize=40%2C40&#038;ssl=1' srcset='https://i0.wp.com/lh6.googleusercontent.com/-WVsTMeQzQ34/AAAAAAAAAAI/AAAAAAAATx0/wxZCE3UDy4s/photo.jpg?resize=40%2C40&#038;ssl=1 1x, https://i0.wp.com/lh6.googleusercontent.com/-WVsTMeQzQ34/AAAAAAAAAAI/AAAAAAAATx0/wxZCE3UDy4s/photo.jpg?resize=60%2C60&#038;ssl=1 1.5x, https://i0.wp.com/lh6.googleusercontent.com/-WVsTMeQzQ34/AAAAAAAAAAI/AAAAAAAATx0/wxZCE3UDy4s/photo.jpg?resize=80%2C80&#038;ssl=1 2x, https://i0.wp.com/lh6.googleusercontent.com/-WVsTMeQzQ34/AAAAAAAAAAI/AAAAAAAATx0/wxZCE3UDy4s/photo.jpg?resize=120%2C120&#038;ssl=1 3x, https://i0.wp.com/lh6.googleusercontent.com/-WVsTMeQzQ34/AAAAAAAAAAI/AAAAAAAATx0/wxZCE3UDy4s/photo.jpg?resize=160%2C160&#038;ssl=1 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://plus.google.com/+BrechtGijbels" class="url" rel="ugc external nofollow">Brecht Gijbels</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-173">
				January 12, 2015 at 12:53 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Thank you MichaH, but I&#8217;m not using Sapien. In the meantime I managed to speed up your script a little bit. If you replace &#8216;Get-ADObject -Filter &#8216;ObjectClass -eq &#8220;organizationalUnit&#8221; -or ObjectClass -eq &#8220;container&#8221;&#8216; -SearchScope OneLevel -SearchBase $dn&#8217; with &#8216;Get-ADOrganizationalUnit -Filter &#8216;Name -like &#8220;*&#8221;&#8216; -SearchBase $dn -SearchScope OneLevel&#8217;, it&#8217;s 50% faster.</p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
		<li class="comment byuser comment-author-itmicah bypostauthor odd alt depth-3" id="li-comment-174">
		<div id="comment-174">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='MicaH&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://itmicah.wordpress.com" class="url" rel="ugc">MicaH</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-174">
				January 12, 2015 at 1:04 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Nicely spotted! Thanks for the feedback, I&#8217;ll incorporate your solution in my script. </p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
		<li class="comment even depth-3" id="li-comment-175">
		<div id="comment-175">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='Brecht Gijbels&#039;s avatar' src='https://i0.wp.com/lh6.googleusercontent.com/-WVsTMeQzQ34/AAAAAAAAAAI/AAAAAAAATx0/wxZCE3UDy4s/photo.jpg?resize=40%2C40&#038;ssl=1' srcset='https://i0.wp.com/lh6.googleusercontent.com/-WVsTMeQzQ34/AAAAAAAAAAI/AAAAAAAATx0/wxZCE3UDy4s/photo.jpg?resize=40%2C40&#038;ssl=1 1x, https://i0.wp.com/lh6.googleusercontent.com/-WVsTMeQzQ34/AAAAAAAAAAI/AAAAAAAATx0/wxZCE3UDy4s/photo.jpg?resize=60%2C60&#038;ssl=1 1.5x, https://i0.wp.com/lh6.googleusercontent.com/-WVsTMeQzQ34/AAAAAAAAAAI/AAAAAAAATx0/wxZCE3UDy4s/photo.jpg?resize=80%2C80&#038;ssl=1 2x, https://i0.wp.com/lh6.googleusercontent.com/-WVsTMeQzQ34/AAAAAAAAAAI/AAAAAAAATx0/wxZCE3UDy4s/photo.jpg?resize=120%2C120&#038;ssl=1 3x, https://i0.wp.com/lh6.googleusercontent.com/-WVsTMeQzQ34/AAAAAAAAAAI/AAAAAAAATx0/wxZCE3UDy4s/photo.jpg?resize=160%2C160&#038;ssl=1 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://plus.google.com/+BrechtGijbels" class="url" rel="ugc external nofollow">Brecht Gijbels</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-175">
				January 13, 2015 at 3:01 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Hi MicaH, I&#8217;ve finished my project with some small improvements:<br />
&#8211; Multiple OU selection with checkboxes<br />
&#8211; Cancel button (didn&#8217;t need &#8216;New OU&#8217;)<br />
&#8211; Checkbox logic like it is in Windows forms<br />
Let me know what you think: <a href="http://brechtgijbels.blogspot.co.uk/2015/01/powershell-net-ad-ou-picker.html" rel="nofollow ugc">http://brechtgijbels.blogspot.co.uk/2015/01/powershell-net-ad-ou-picker.html</a></p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
		<li class="comment byuser comment-author-itmicah bypostauthor odd alt depth-3" id="li-comment-176">
		<div id="comment-176">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='MicaH&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://itmicah.wordpress.com" class="url" rel="ugc">MicaH</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-176">
				January 15, 2015 at 3:39 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Looks good! It works like it&#8217;s supposed to. By the way, I&#8217;ve reconcidered using your Get-ADOrganizationalUnit solution because you&#8217;ll only get the OU&#8217;s that way and I want the folders displayed as well. </p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-vthinktank even thread-odd thread-alt depth-1" id="li-comment-178">
		<div id="comment-178">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='vthinktank&#039;s avatar' src='https://1.gravatar.com/avatar/d79ed8ae5e9628289e4f4d57ce23840932aa2f5d751f8e04163bff9cf572208d?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/d79ed8ae5e9628289e4f4d57ce23840932aa2f5d751f8e04163bff9cf572208d?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/d79ed8ae5e9628289e4f4d57ce23840932aa2f5d751f8e04163bff9cf572208d?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/d79ed8ae5e9628289e4f4d57ce23840932aa2f5d751f8e04163bff9cf572208d?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/d79ed8ae5e9628289e4f4d57ce23840932aa2f5d751f8e04163bff9cf572208d?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/d79ed8ae5e9628289e4f4d57ce23840932aa2f5d751f8e04163bff9cf572208d?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn">vthinktank</cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-178">
				January 15, 2015 at 9:40 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>can we please have the ps1 as file that could be downloaded.if that is acceptable agreeable possible</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=178#respond" data-commentid="178" data-postid="15" data-belowelement="comment-178" data-respondelement="respond" data-replyto="Reply to vthinktank" aria-label="Reply to vthinktank">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				<ul class="children">
		<li class="comment byuser comment-author-itmicah bypostauthor odd alt depth-2" id="li-comment-180">
		<div id="comment-180">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='MicaH&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://itmicah.wordpress.com" class="url" rel="ugc">MicaH</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-180">
				January 16, 2015 at 4:18 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>You can right-click the link and choose Save link as&#8230; Then simply save the file as a .ps1 file.</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=180#respond" data-commentid="180" data-postid="15" data-belowelement="comment-180" data-respondelement="respond" data-replyto="Reply to MicaH" aria-label="Reply to MicaH">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				<ul class="children">
		<li class="comment byuser comment-author-vthinktank even depth-3" id="li-comment-181">
		<div id="comment-181">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='vthinktank&#039;s avatar' src='https://1.gravatar.com/avatar/d79ed8ae5e9628289e4f4d57ce23840932aa2f5d751f8e04163bff9cf572208d?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/d79ed8ae5e9628289e4f4d57ce23840932aa2f5d751f8e04163bff9cf572208d?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/d79ed8ae5e9628289e4f4d57ce23840932aa2f5d751f8e04163bff9cf572208d?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/d79ed8ae5e9628289e4f4d57ce23840932aa2f5d751f8e04163bff9cf572208d?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/d79ed8ae5e9628289e4f4d57ce23840932aa2f5d751f8e04163bff9cf572208d?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/d79ed8ae5e9628289e4f4d57ce23840932aa2f5d751f8e04163bff9cf572208d?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn">vthinktank</cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-181">
				January 18, 2015 at 3:19 am</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Thank you Sir</p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="li-comment-183">
		<div id="comment-183">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='Will Henderson&#039;s avatar' src='https://1.gravatar.com/avatar/d9461a995a80a438bf293bcf88a410bd9e8ada3b34eb7a6a65696948ee63728f?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/d9461a995a80a438bf293bcf88a410bd9e8ada3b34eb7a6a65696948ee63728f?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/d9461a995a80a438bf293bcf88a410bd9e8ada3b34eb7a6a65696948ee63728f?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/d9461a995a80a438bf293bcf88a410bd9e8ada3b34eb7a6a65696948ee63728f?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/d9461a995a80a438bf293bcf88a410bd9e8ada3b34eb7a6a65696948ee63728f?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/d9461a995a80a438bf293bcf88a410bd9e8ada3b34eb7a6a65696948ee63728f?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn">Will Henderson</cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-183">
				January 27, 2015 at 10:44 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Hi MicaH, </p>
<p>Great script! I&#8217;m wondering about limiting the scope of the OUs that can be picked. For my purposes, I don&#8217;t need it showing the entire domain, just a couple of OUs in a specific part of the tree. I&#8217;ve tried a few things but no success yet. Any ideas?</p>
<p>Will</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=183#respond" data-commentid="183" data-postid="15" data-belowelement="comment-183" data-respondelement="respond" data-replyto="Reply to Will Henderson" aria-label="Reply to Will Henderson">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				<ul class="children">
		<li class="comment byuser comment-author-itmicah bypostauthor even depth-2" id="li-comment-191">
		<div id="comment-191">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='MicaH&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://itmicah.wordpress.com" class="url" rel="ugc">MicaH</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-191">
				February 22, 2015 at 12:33 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>That&#8217;s a tough one. Especially if the OU&#8217;s ate on different levels. It&#8217;s definitely possible but it&#8217;s gonna require some serious programing skills. I&#8217;d start by using the Get-ADOrganizationUnit commandlet to get the distinguished names of those OU&#8217;S and use these as a filter for the underlying OU&#8217;S. </p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=191#respond" data-commentid="191" data-postid="15" data-belowelement="comment-191" data-respondelement="respond" data-replyto="Reply to MicaH" aria-label="Reply to MicaH">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
		<li class="comment odd alt depth-2" id="li-comment-202">
		<div id="comment-202">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='Michael Robinson&#039;s avatar' src='https://0.gravatar.com/avatar/373425ee98cd5bafb5826146c71ee342c8797fc9cf00d1d4955a52e5621c256a?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/373425ee98cd5bafb5826146c71ee342c8797fc9cf00d1d4955a52e5621c256a?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/373425ee98cd5bafb5826146c71ee342c8797fc9cf00d1d4955a52e5621c256a?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/373425ee98cd5bafb5826146c71ee342c8797fc9cf00d1d4955a52e5621c256a?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/373425ee98cd5bafb5826146c71ee342c8797fc9cf00d1d4955a52e5621c256a?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/373425ee98cd5bafb5826146c71ee342c8797fc9cf00d1d4955a52e5621c256a?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn">Michael Robinson</cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-202">
				July 2, 2015 at 8:27 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>You can narrow the scope down to a subset by changing the field $strDomainDN to OU=TopOU,DC=a,DC=b,DC=c</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=202#respond" data-commentid="202" data-postid="15" data-belowelement="comment-202" data-respondelement="respond" data-replyto="Reply to Michael Robinson" aria-label="Reply to Michael Robinson">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				<ul class="children">
		<li class="comment byuser comment-author-itmicah bypostauthor even depth-3" id="li-comment-203">
		<div id="comment-203">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='MicaH&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://itmicah.wordpress.com" class="url" rel="ugc">MicaH</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-203">
				July 2, 2015 at 8:32 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Thanks Michael. Sorry Will, I completely forgot to answer this question.</p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-213">
		<div id="comment-213">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='Wei-Yen Tan&#039;s avatar' src='https://graph.facebook.com/v2.2/776263553/picture?type=large&#038;_md5=0a6602290b4dea6428ae2b45fe103685' srcset='https://graph.facebook.com/v2.2/776263553/picture?type=large&#038;_md5=0a6602290b4dea6428ae2b45fe103685 1x, https://graph.facebook.com/v2.2/776263553/picture?type=large&#038;_md5=0a6602290b4dea6428ae2b45fe103685 1.5x, https://graph.facebook.com/v2.2/776263553/picture?type=large&#038;_md5=0a6602290b4dea6428ae2b45fe103685 2x, https://graph.facebook.com/v2.2/776263553/picture?type=large&#038;_md5=0a6602290b4dea6428ae2b45fe103685 3x, https://graph.facebook.com/v2.2/776263553/picture?type=large&#038;_md5=0a6602290b4dea6428ae2b45fe103685 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="http://www.facebook.com/776263553" class="url" rel="ugc external nofollow">Wei-Yen Tan</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-213">
				July 21, 2015 at 2:53 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Hi Micah,</p>
<p>Excellent script. I have an idea on how to use this. You mention in a previous comment that I could pass the variable to somewhere else.</p>
<p>What I would like to do is to put the contents of the variable into a form of a distinguished name and place in a text field on a form.</p>
<p>I want to use this script to pick an OU that they can move a list of users to. CAn I do something like that?</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=213#respond" data-commentid="213" data-postid="15" data-belowelement="comment-213" data-respondelement="respond" data-replyto="Reply to Wei-Yen Tan" aria-label="Reply to Wei-Yen Tan">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				<ul class="children">
		<li class="comment byuser comment-author-itmicah bypostauthor even depth-2" id="li-comment-214">
		<div id="comment-214">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='MicaH&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://itmicah.wordpress.com" class="url" rel="ugc">MicaH</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-214">
				July 21, 2015 at 5:00 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>That&#8217;s exactly what I wrote it for. The $objSelectedOU variable is in the script scope so you should be able to do something like:<br />
<code>$Textbox.text = $objSelectedOU.DistinghuisedName</code><br />
I&#8217;ve also just added a easier to use version: check out the Edit section at the bottom of the post. With the new version you can copy the main function into your script and do something like this:<br />
<code><br />
$OU = Choose-ADOrganizationalUnit<br />
$Textbox.text = $OU.DistinghuisedName<br />
</code></p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=214#respond" data-commentid="214" data-postid="15" data-belowelement="comment-214" data-respondelement="respond" data-replyto="Reply to MicaH" aria-label="Reply to MicaH">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				<ul class="children">
		<li class="comment odd alt depth-3" id="li-comment-215">
		<div id="comment-215">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='Wei-Yen Tan&#039;s avatar' src='https://graph.facebook.com/v2.2/776263553/picture?type=large' srcset='https://graph.facebook.com/v2.2/776263553/picture?type=large 1x, https://graph.facebook.com/v2.2/776263553/picture?type=large 1.5x, https://graph.facebook.com/v2.2/776263553/picture?type=large 2x, https://graph.facebook.com/v2.2/776263553/picture?type=large 3x, https://graph.facebook.com/v2.2/776263553/picture?type=large 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="http://www.facebook.com/776263553" class="url" rel="ugc external nofollow">Wei-Yen Tan</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-215">
				July 22, 2015 at 7:10 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Thanks for this.</p>
<p>I am using Powershell Studio like yourself and am very new to it. </p>
<p>So I have a form&#8230;.does that mean I copy the whole text that you mentioned  into the beginning of the form?</p>
<p>Thank you</p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
		<li class="comment byuser comment-author-itmicah bypostauthor even depth-3" id="li-comment-216">
		<div id="comment-216">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='MicaH&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://itmicah.wordpress.com" class="url" rel="ugc">MicaH</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-216">
				August 4, 2015 at 1:02 am</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Yes, you can insert the function anywhere you want and call the function with a button click action. It&#8217;s a bit hard to explain using text only but this is basically what you&#8217;d have to do:<br />
* create a form (or use existing) and place a textbox in it with a button next to it.<br />
* Dubbel-click the button. This will automatically create a button click action for you.<br />
* In this button click action call the imported function and save the result in a variable, like I showed you in the previous comment: $OU = Get-ADOrganizationUnit<br />
* Assuming your textbox is $textbox the next line in the button click action should be: $textbox.text = $OU.DistinguishedName<br />
* Run the script to see if it works: Click the button and my OU picker should emerge. When selecting an OU and clicking OK the distinguished name of the OU should now be in the textbox.</p>
<p>Hope it helps clear things up.</p>
<p>MicaH</p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-itmicah bypostauthor odd alt thread-even depth-1" id="li-comment-217">
		<div id="comment-217">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='MicaH&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://itmicah.wordpress.com" class="url" rel="ugc">MicaH</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-217">
				August 4, 2015 at 1:05 am</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>I&#8217;m on vacation now but if you&#8217;re still having difficulty let me know, I&#8217;ll cook up an example for you. </p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=217#respond" data-commentid="217" data-postid="15" data-belowelement="comment-217" data-respondelement="respond" data-replyto="Reply to MicaH" aria-label="Reply to MicaH">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="li-comment-223">
		<div id="comment-223">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='Arne&#039;s avatar' src='https://2.gravatar.com/avatar/58bacd9729d4d85589d4217a400bed7cce96d2014b11cc81d07a62676333de08?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/58bacd9729d4d85589d4217a400bed7cce96d2014b11cc81d07a62676333de08?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/58bacd9729d4d85589d4217a400bed7cce96d2014b11cc81d07a62676333de08?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/58bacd9729d4d85589d4217a400bed7cce96d2014b11cc81d07a62676333de08?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/58bacd9729d4d85589d4217a400bed7cce96d2014b11cc81d07a62676333de08?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/58bacd9729d4d85589d4217a400bed7cce96d2014b11cc81d07a62676333de08?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn">Arne</cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-223">
				September 21, 2015 at 1:46 am</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Hey MicaH,</p>
<p>great script. I modified it a little so that it shows me only OUs and I&#8217;m also excluding some OUs that I don&#8217;t need to see. </p>
<p>Now I&#8217;m just stuck with returning the selected OU to my .ps1 script.<br />
Im calling the OUPicker via: Start-Process -wait &#8220;$ScriptDirectory\OUtree.exe&#8221;</p>
<p>In the OUtree.exe I have modified the OnApplicationExit function and $buttonOK_Click to the following:</p>
<p>function OnApplicationExit {<br />
	#Note: This function is not called in Projects<br />
	#Note: This function runs after the form is closed<br />
	#TODO: Add custom code to clean up and unload snapins when the application exits</p>
<p>	$script:ExitCode = $objSelectedOU #Set the exit code for the Packager<br />
}<br />
$buttonOK_Click = {<br />
	#$selOU = $treeView1.SelectedNode.Name<br />
	$global:objSelectedOU = $treeView1.SelectedNode.Name<br />
	$textbox1.Text = $global:objSelectedOU<br />
	$formChooseOU.close()<br />
}</p>
<p>But I can&#8217;t get any value back to the original .ps1 script. Nothing of the following seem to work:</p>
<p>Write-Host &#8220;LastExitCode: $LastExitCode&#8221;<br />
$LastExitCode<br />
Write-Host &#8220;objSelectedOU: $objSelectedOU&#8221;<br />
$objSelectedOU</p>
<p>What am I missing here?<br />
Thanks in advance</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=223#respond" data-commentid="223" data-postid="15" data-belowelement="comment-223" data-respondelement="respond" data-replyto="Reply to Arne" aria-label="Reply to Arne">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="li-comment-245">
		<div id="comment-245">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='toothandnail&#039;s avatar' src='https://1.gravatar.com/avatar/1d58e47a445c1fcf2be5796effdb5d99e3fb9b573d0f4e37d5df4bc17c0ef9f4?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/1d58e47a445c1fcf2be5796effdb5d99e3fb9b573d0f4e37d5df4bc17c0ef9f4?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/1d58e47a445c1fcf2be5796effdb5d99e3fb9b573d0f4e37d5df4bc17c0ef9f4?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/1d58e47a445c1fcf2be5796effdb5d99e3fb9b573d0f4e37d5df4bc17c0ef9f4?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/1d58e47a445c1fcf2be5796effdb5d99e3fb9b573d0f4e37d5df4bc17c0ef9f4?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/1d58e47a445c1fcf2be5796effdb5d99e3fb9b573d0f4e37d5df4bc17c0ef9f4?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn">toothandnail</cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-245">
				October 16, 2015 at 10:17 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Thanks! With this I&#8217;m going to make OSDed PCs go somewhere besides the default.</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=245#respond" data-commentid="245" data-postid="15" data-belowelement="comment-245" data-respondelement="respond" data-replyto="Reply to toothandnail" aria-label="Reply to toothandnail">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="li-comment-257">
		<div id="comment-257">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='mmoore5553&#039;s avatar' src='https://0.gravatar.com/avatar/32a62671088ce26b9d7cd1478dffe4cfb22a876620cc259364d88bb1c29f13ff?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/32a62671088ce26b9d7cd1478dffe4cfb22a876620cc259364d88bb1c29f13ff?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/32a62671088ce26b9d7cd1478dffe4cfb22a876620cc259364d88bb1c29f13ff?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/32a62671088ce26b9d7cd1478dffe4cfb22a876620cc259364d88bb1c29f13ff?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/32a62671088ce26b9d7cd1478dffe4cfb22a876620cc259364d88bb1c29f13ff?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/32a62671088ce26b9d7cd1478dffe4cfb22a876620cc259364d88bb1c29f13ff?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="http://gravatar.com/mmoore5553" class="url" rel="ugc external nofollow">mmoore5553</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-257">
				November 6, 2015 at 2:58 am</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Micah,</p>
<p>Can you make a small example. I am trying to figure out how to incorporate this. I am just using powershell thought and thought about using HTA or visual studio. If i could do this totally in powershell that would be great too. I am just stuck &#8230;</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=257#respond" data-commentid="257" data-postid="15" data-belowelement="comment-257" data-respondelement="respond" data-replyto="Reply to mmoore5553" aria-label="Reply to mmoore5553">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				<ul class="children">
		<li class="comment byuser comment-author-itmicah bypostauthor odd alt depth-2" id="li-comment-259">
		<div id="comment-259">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='MicaH&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://itmicah.wordpress.com" class="url" rel="ugc">MicaH</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-259">
				November 9, 2015 at 9:30 am</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>OK. I&#8217;ll cook something up for you. Are you using Sapien PowerShell Studio?</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=259#respond" data-commentid="259" data-postid="15" data-belowelement="comment-259" data-respondelement="respond" data-replyto="Reply to MicaH" aria-label="Reply to MicaH">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				<ul class="children">
		<li class="comment byuser comment-author-itmicah bypostauthor even depth-3" id="li-comment-260">
		<div id="comment-260">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='MicaH&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://itmicah.wordpress.com" class="url" rel="ugc">MicaH</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-260">
				November 9, 2015 at 10:19 am</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>I&#8217;ve created a simple form in PowerShell Studio for you. You can download the form file here: <a href="https://dl.dropboxusercontent.com/u/62204506/Blog/OUPicker_example.pff" rel="nofollow">OUPicker_example.pff</a>. If you&#8217;re not using Sapien Powershell Studio I can post the PowerShell code it generates but that will be harder to read.</p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
		<li class="comment odd alt depth-3" id="li-comment-263">
		<div id="comment-263">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='mmoore5553&#039;s avatar' src='https://0.gravatar.com/avatar/32a62671088ce26b9d7cd1478dffe4cfb22a876620cc259364d88bb1c29f13ff?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/32a62671088ce26b9d7cd1478dffe4cfb22a876620cc259364d88bb1c29f13ff?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/32a62671088ce26b9d7cd1478dffe4cfb22a876620cc259364d88bb1c29f13ff?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/32a62671088ce26b9d7cd1478dffe4cfb22a876620cc259364d88bb1c29f13ff?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/32a62671088ce26b9d7cd1478dffe4cfb22a876620cc259364d88bb1c29f13ff?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/32a62671088ce26b9d7cd1478dffe4cfb22a876620cc259364d88bb1c29f13ff?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="http://gravatar.com/mmoore5553" class="url" rel="ugc external nofollow">mmoore5553</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-263">
				November 11, 2015 at 6:02 am</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Thank you. I will test it out. I do not have sapien but will try the trial an if good will buy it. Can you make this a program like visual studio and be an exe  ? I am not sure if sapien will work like that or not.</p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
		<li class="comment byuser comment-author-itmicah bypostauthor even depth-3" id="li-comment-264">
		<div id="comment-264">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='MicaH&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://itmicah.wordpress.com" class="url" rel="ugc">MicaH</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-264">
				November 11, 2015 at 9:20 am</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Sapien will let you save your forms/projects as .exe files. The new version can even create an .msi for you if you have dependencies you&#8217;d like to include. This won&#8217;t work in the trial version though. I think it can be done in visual studio as well but I have no experience with that. </p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-supercheetah0 odd alt thread-even depth-1" id="li-comment-270">
		<div id="comment-270">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='supercheetah&#039;s avatar' src='https://0.gravatar.com/avatar/6e24801f870093005200f742a62e2a63722d312326bf8d30f9120dfd6ae01e23?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/6e24801f870093005200f742a62e2a63722d312326bf8d30f9120dfd6ae01e23?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/6e24801f870093005200f742a62e2a63722d312326bf8d30f9120dfd6ae01e23?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/6e24801f870093005200f742a62e2a63722d312326bf8d30f9120dfd6ae01e23?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/6e24801f870093005200f742a62e2a63722d312326bf8d30f9120dfd6ae01e23?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/6e24801f870093005200f742a62e2a63722d312326bf8d30f9120dfd6ae01e23?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="http://supercheetah.livejournal.com" class="url" rel="ugc external nofollow">supercheetah</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-270">
				November 16, 2015 at 10:05 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Firstly, if this is a double post, I apologize.  I thought I posted it, but can&#8217;t find it.</p>
<p>I really appreciate this code, but it was really, really slow on our AD forest because it’s pretty deeply nested. Also, I had the issue that we have multiple domains in our AD forest, so I had to add the capability for it to query for those different domains</p>
<p>I tried to refactor it, but had a hard time doing so, Instead, I just started from scratch using your code as just inspiration.</p>
<p>It looks at the root domain to see what domains are all available, and creates a hash of the hostnames of the DCs. It assumes all OUs have child nodes in them, but only actually finds out from the DC when the user tries to expand them.</p>
<p>Here’s the results of my work: <a href="https://gist.github.com/supercheetah/b68023f3254dfc9a6497" rel="nofollow ugc">https://gist.github.com/supercheetah/b68023f3254dfc9a6497</a></p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=270#respond" data-commentid="270" data-postid="15" data-belowelement="comment-270" data-respondelement="respond" data-replyto="Reply to supercheetah" aria-label="Reply to supercheetah">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="li-comment-287">
		<div id="comment-287">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='Joey de Graaf&#039;s avatar' src='https://2.gravatar.com/avatar/8c4b8c163d3354af12809bb01fdbda39745d49382ef16ea5f5987ca1e245d64a?s=40&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/8c4b8c163d3354af12809bb01fdbda39745d49382ef16ea5f5987ca1e245d64a?s=40&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/8c4b8c163d3354af12809bb01fdbda39745d49382ef16ea5f5987ca1e245d64a?s=60&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/8c4b8c163d3354af12809bb01fdbda39745d49382ef16ea5f5987ca1e245d64a?s=80&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/8c4b8c163d3354af12809bb01fdbda39745d49382ef16ea5f5987ca1e245d64a?s=120&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/8c4b8c163d3354af12809bb01fdbda39745d49382ef16ea5f5987ca1e245d64a?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://www.serverknowledge.net" class="url" rel="ugc external nofollow">Joey de Graaf</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-287">
				January 9, 2016 at 7:30 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Hi Micah,<br />
Thanks for sharing this script! I used it in my own Powershell GUI tool. You can see the result on <a href="https://www.serverknowledge.net/powershell/ad-user-info-exporter/" rel="nofollow ugc">https://www.serverknowledge.net/powershell/ad-user-info-exporter/</a>.</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=287#respond" data-commentid="287" data-postid="15" data-belowelement="comment-287" data-respondelement="respond" data-replyto="Reply to Joey de Graaf" aria-label="Reply to Joey de Graaf">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				<ul class="children">
		<li class="comment byuser comment-author-itmicah bypostauthor odd alt depth-2" id="li-comment-293">
		<div id="comment-293">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='MicaH&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://itmicah.wordpress.com" class="url" rel="ugc">MicaH</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-293">
				January 18, 2016 at 11:37 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Nicely done, Joey. (Prima toepassing, landgenoot)</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=293#respond" data-commentid="293" data-postid="15" data-belowelement="comment-293" data-respondelement="respond" data-replyto="Reply to MicaH" aria-label="Reply to MicaH">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="li-comment-296">
		<div id="comment-296">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='Stephen&#039;s avatar' src='https://1.gravatar.com/avatar/a03276dd4ef03f37d6721eaac20e5d10bff691c65dba3ff30db182069a640c5b?s=40&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/a03276dd4ef03f37d6721eaac20e5d10bff691c65dba3ff30db182069a640c5b?s=40&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/a03276dd4ef03f37d6721eaac20e5d10bff691c65dba3ff30db182069a640c5b?s=60&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/a03276dd4ef03f37d6721eaac20e5d10bff691c65dba3ff30db182069a640c5b?s=80&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/a03276dd4ef03f37d6721eaac20e5d10bff691c65dba3ff30db182069a640c5b?s=120&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/a03276dd4ef03f37d6721eaac20e5d10bff691c65dba3ff30db182069a640c5b?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn">Stephen</cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-296">
				February 8, 2016 at 6:35 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Love the script.</p>
<p>Thank you for sharing.</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=296#respond" data-commentid="296" data-postid="15" data-belowelement="comment-296" data-respondelement="respond" data-replyto="Reply to Stephen" aria-label="Reply to Stephen">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
		<li class="post pingback">
		<p>Pingback: <a href="https://itmicah.wordpress.com/2016/03/29/active-directory-ou-picker-revisited/" class="url" rel="ugc">Active Directory OU picker revisited | MicaH&#039;s IT blog</a></p>
				</li><!-- #comment-## -->
		<li class="comment byuser comment-author-itmicah bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-323">
		<div id="comment-323">
			<div class="comment-author vcard">
				<img referrerpolicy="no-referrer" alt='MicaH&#039;s avatar' src='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=40&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=60&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=80&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=120&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/69b70a038ba4758dae9876239632ab357e83f598a0225b801a546d4c4de4a705?s=160&#038;d=identicon&#038;r=G 4x' class='avatar avatar-40' height='40' width='40' loading='lazy' decoding='async' />				<cite class="fn"><a href="https://itmicah.wordpress.com" class="url" rel="ugc">MicaH</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comment-323">
				March 29, 2016 at 11:17 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Everyone, I&#8217;ve created a better version of this function in a new blog post: <a href="https://itmicah.wordpress.com/2016/03/29/active-directory-ou-picker-revisited/" rel="ugc">https://itmicah.wordpress.com/2016/03/29/active-directory-ou-picker-revisited/</a>. If you&#8217;re using the old version please update. The new one is way better and faster, thanks to some of your idea&#8217;s in this comment section. Let me know what you think!</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/?replytocom=323#respond" data-commentid="323" data-postid="15" data-belowelement="comment-323" data-respondelement="respond" data-replyto="Reply to MicaH" aria-label="Reply to MicaH">Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
			</ol>


	

	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2013/10/29/active-directory-ou-picker-in-powershell/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://itmicah.wordpress.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">


<div class="comment-form__verbum transparent"></div><div class="verbum-form-meta"><input type='hidden' name='comment_post_ID' value='15' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />

			<input type="hidden" name="highlander_comment_nonce" id="highlander_comment_nonce" value="e4bc36c9db" />
			<input type="hidden" name="verbum_show_subscription_modal" value="" /></div><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="91849f1a88" /></p><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="175"/><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

	
			</div><!-- #content -->
		</div><!-- #container -->


		<div id="primary" class="widget-area" role="complementary">
						<ul class="xoxo">

<li id="media_image-2" class="widget-container widget_media_image"><style>.widget.widget_media_image { overflow: hidden; }.widget.widget_media_image img { height: auto; max-width: 100%; }</style><a href="http://nl.linkedin.com/pub/michaja-van-der-zouwen/9/496/871"><img class="image alignnone" src="https://media.licdn.com/mpr/mpr/shrinknp_400_400/AAEAAQAAAAAAAAi0AAAAJDZkZDAzNGYzLWNhOWMtNDZmMS05NTU1LTliYjA0ZmNiYzVkMQ.jpg" alt="" width="200" height="200" /></a></li><li id="follow_button_widget-4" class="widget-container widget_follow_button_widget">
		<a class="wordpress-follow-button" href="https://itmicah.wordpress.com" data-blog="59931687" data-lang="en" >Follow MicaH&#039;s IT blog on WordPress.com</a>
		<script type="text/javascript">(function(d){ window.wpcomPlatform = {"titles":{"timelines":"Embeddable Timelines","followButton":"Follow Button","wpEmbeds":"WordPress Embeds"}}; var f = d.getElementsByTagName('SCRIPT')[0], p = d.createElement('SCRIPT');p.type = 'text/javascript';p.async = true;p.src = '//widgets.wp.com/platform.js';f.parentNode.insertBefore(p,f);}(document));</script>

		</li><li id="wpcom_social_media_icons_widget-2" class="widget-container widget_wpcom_social_media_icons_widget"><h3 class="widget-title">Social</h3><ul><li><a href="https://twitter.com/MicaH_Z/" class="genericon genericon-twitter" target="_blank"><span class="screen-reader-text">View MicaH_Z&#8217;s profile on Twitter</span></a></li><li><a href="https://www.linkedin.com/in/michajavanderzouwen/" class="genericon genericon-linkedin" target="_blank"><span class="screen-reader-text">View michajavanderzouwen&#8217;s profile on LinkedIn</span></a></li></ul></li><li id="categories-3" class="widget-container widget_categories"><h3 class="widget-title">Categories</h3><form action="https://itmicah.wordpress.com" method="get"><label class="screen-reader-text" for="cat">Categories</label><select  name='cat' id='cat' class='postform'>
	<option value='-1'>Select Category</option>
	<option class="level-0" value="97228">Citrix</option>
	<option class="level-0" value="662">Default</option>
	<option class="level-0" value="16288395">Microsoft Deployment Toolkit (MDT)</option>
	<option class="level-0" value="178495">Powershell</option>
	<option class="level-0" value="50818390">RES Automation Manager</option>
	<option class="level-0" value="7179509">RES Software</option>
	<option class="level-0" value="50818398">RES Workspace Manager</option>
	<option class="level-0" value="198895572">Sapien Powershell Studio</option>
</select>
</form><script type="text/javascript">
/* <![CDATA[ */

(function() {
	var dropdown = document.getElementById( "cat" );
	function onCatChange() {
		if ( dropdown.options[ dropdown.selectedIndex ].value > 0 ) {
			dropdown.parentNode.submit();
		}
	}
	dropdown.onchange = onCatChange;
})();

/* ]]> */
</script>
</li><li id="wp_tag_cloud-2" class="widget-container wp_widget_tag_cloud"><h3 class="widget-title">Tags</h3><ul class='wp-tag-cloud' role='list'>
	<li><a href="https://itmicah.wordpress.com/tag/active-directory/" class="tag-cloud-link tag-link-35699 tag-link-position-1" style="font-size: 13.384615384615pt;" aria-label="Active Directory (3 items)">Active Directory</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/citrix/" class="tag-cloud-link tag-link-97228 tag-link-position-2" style="font-size: 11.230769230769pt;" aria-label="Citrix (2 items)">Citrix</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/comma-separated-values/" class="tag-cloud-link tag-link-9664920 tag-link-position-3" style="font-size: 8pt;" aria-label="Comma-separated values (1 item)">Comma-separated values</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/csv/" class="tag-cloud-link tag-link-602178 tag-link-position-4" style="font-size: 8pt;" aria-label="CSV (1 item)">CSV</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/graphical-user-interface/" class="tag-cloud-link tag-link-309097 tag-link-position-5" style="font-size: 8pt;" aria-label="Graphical user interface (1 item)">Graphical user interface</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/ict/" class="tag-cloud-link tag-link-16879 tag-link-position-6" style="font-size: 11.230769230769pt;" aria-label="ICT (2 items)">ICT</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/it/" class="tag-cloud-link tag-link-3072 tag-link-position-7" style="font-size: 11.230769230769pt;" aria-label="IT (2 items)">IT</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/kms/" class="tag-cloud-link tag-link-36821 tag-link-position-8" style="font-size: 8pt;" aria-label="KMS (1 item)">KMS</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/local-cache/" class="tag-cloud-link tag-link-33811797 tag-link-position-9" style="font-size: 8pt;" aria-label="local cache (1 item)">local cache</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/mdt/" class="tag-cloud-link tag-link-83244 tag-link-position-10" style="font-size: 15.179487179487pt;" aria-label="MDT (4 items)">MDT</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/micah/" class="tag-cloud-link tag-link-37125 tag-link-position-11" style="font-size: 8pt;" aria-label="MicaH (1 item)">MicaH</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/michaja-van-der-zouwen/" class="tag-cloud-link tag-link-198890079 tag-link-position-12" style="font-size: 11.230769230769pt;" aria-label="Michaja van der Zouwen (2 items)">Michaja van der Zouwen</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/microsoft/" class="tag-cloud-link tag-link-637 tag-link-position-13" style="font-size: 11.230769230769pt;" aria-label="Microsoft (2 items)">Microsoft</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/microsoft-deployment/" class="tag-cloud-link tag-link-5596955 tag-link-position-14" style="font-size: 13.384615384615pt;" aria-label="Microsoft Deployment (3 items)">Microsoft Deployment</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/microsoft-deployment-toolkit/" class="tag-cloud-link tag-link-8624925 tag-link-position-15" style="font-size: 13.384615384615pt;" aria-label="Microsoft Deployment Toolkit (3 items)">Microsoft Deployment Toolkit</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/microsoft-excel/" class="tag-cloud-link tag-link-4834 tag-link-position-16" style="font-size: 8pt;" aria-label="Microsoft Excel (1 item)">Microsoft Excel</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/microsoft-windows/" class="tag-cloud-link tag-link-5496 tag-link-position-17" style="font-size: 8pt;" aria-label="Microsoft Windows (1 item)">Microsoft Windows</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/operating-system/" class="tag-cloud-link tag-link-5495 tag-link-position-18" style="font-size: 11.230769230769pt;" aria-label="Operating system (2 items)">Operating system</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/organizational-unit/" class="tag-cloud-link tag-link-16544418 tag-link-position-19" style="font-size: 11.230769230769pt;" aria-label="Organizational Unit (2 items)">Organizational Unit</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/ou/" class="tag-cloud-link tag-link-175211 tag-link-position-20" style="font-size: 8pt;" aria-label="OU (1 item)">OU</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/ou-picker/" class="tag-cloud-link tag-link-198904777 tag-link-position-21" style="font-size: 11.230769230769pt;" aria-label="OU picker (2 items)">OU picker</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/ou-selection/" class="tag-cloud-link tag-link-198904773 tag-link-position-22" style="font-size: 11.230769230769pt;" aria-label="OU selection (2 items)">OU selection</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/outlook/" class="tag-cloud-link tag-link-9559 tag-link-position-23" style="font-size: 8pt;" aria-label="Outlook (1 item)">Outlook</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/outlook-contacts/" class="tag-cloud-link tag-link-2693190 tag-link-position-24" style="font-size: 8pt;" aria-label="Outlook Contacts (1 item)">Outlook Contacts</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/powershell/" class="tag-cloud-link tag-link-178495 tag-link-position-25" style="font-size: 22pt;" aria-label="Powershell (11 items)">Powershell</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/powershell-studio/" class="tag-cloud-link tag-link-85247332 tag-link-position-26" style="font-size: 16.615384615385pt;" aria-label="Powershell Studio (5 items)">Powershell Studio</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/res-software/" class="tag-cloud-link tag-link-7179509 tag-link-position-27" style="font-size: 11.230769230769pt;" aria-label="RES Software (2 items)">RES Software</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/res-workspace-manager/" class="tag-cloud-link tag-link-50818398 tag-link-position-28" style="font-size: 11.230769230769pt;" aria-label="RES Workspace Manager (2 items)">RES Workspace Manager</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/sapien/" class="tag-cloud-link tag-link-2067042 tag-link-position-29" style="font-size: 15.179487179487pt;" aria-label="Sapien (4 items)">Sapien</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/scripting/" class="tag-cloud-link tag-link-2929 tag-link-position-30" style="font-size: 13.384615384615pt;" aria-label="scripting (3 items)">scripting</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/select-ou/" class="tag-cloud-link tag-link-198904774 tag-link-position-31" style="font-size: 8pt;" aria-label="select OU (1 item)">select OU</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/standalone/" class="tag-cloud-link tag-link-499483 tag-link-position-32" style="font-size: 8pt;" aria-label="standalone (1 item)">standalone</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/target-group/" class="tag-cloud-link tag-link-236632 tag-link-position-33" style="font-size: 11.230769230769pt;" aria-label="Target Group (2 items)">Target Group</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/update-cache/" class="tag-cloud-link tag-link-81503349 tag-link-position-34" style="font-size: 8pt;" aria-label="update cache (1 item)">update cache</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/utilities/" class="tag-cloud-link tag-link-10266 tag-link-position-35" style="font-size: 8pt;" aria-label="Utilities (1 item)">Utilities</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/windows-7/" class="tag-cloud-link tag-link-729864 tag-link-position-36" style="font-size: 11.230769230769pt;" aria-label="Windows 7 (2 items)">Windows 7</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/windows-powershell/" class="tag-cloud-link tag-link-926032 tag-link-position-37" style="font-size: 18.769230769231pt;" aria-label="Windows PowerShell (7 items)">Windows PowerShell</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/windows-server-2012/" class="tag-cloud-link tag-link-30743506 tag-link-position-38" style="font-size: 8pt;" aria-label="Windows Server 2012 (1 item)">Windows Server 2012</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/wsus/" class="tag-cloud-link tag-link-347217 tag-link-position-39" style="font-size: 11.230769230769pt;" aria-label="WSUS (2 items)">WSUS</a></li>
	<li><a href="https://itmicah.wordpress.com/tag/xendesktop/" class="tag-cloud-link tag-link-3421487 tag-link-position-40" style="font-size: 11.230769230769pt;" aria-label="XenDesktop (2 items)">XenDesktop</a></li>
</ul>
</li>
		<li id="recent-posts-3" class="widget-container widget_recent_entries">
		<h3 class="widget-title">Recent Posts</h3>
		<ul>
											<li>
					<a href="https://itmicah.wordpress.com/2019/03/07/telnet-not-installed/">Help! Telnet not&nbsp;installed!</a>
									</li>
											<li>
					<a href="https://itmicah.wordpress.com/2017/11/13/preserve-audio-volume-and-mute-in-res-one-workspace/">Preserve audio volume and mute in RES One&nbsp;Workspace</a>
									</li>
											<li>
					<a href="https://itmicah.wordpress.com/2017/10/24/capture-multiple-images-using-one-mdt-task-sequence/">Capture multiple images using one MDT task&nbsp;sequence</a>
									</li>
											<li>
					<a href="https://itmicah.wordpress.com/2016/12/15/res-one-automation-powershell-module/">RES One Automation PowerShell&nbsp;Module</a>
									</li>
											<li>
					<a href="https://itmicah.wordpress.com/2016/11/16/configure-wer-user-mode-application-crash-dumps-powershell-style/">Configure WER User-Mode (Application) crash dumps PowerShell-style</a>
									</li>
					</ul>

		</li><li id="archives-3" class="widget-container widget_archive"><h3 class="widget-title">Archives</h3>
			<ul>
					<li><a href='https://itmicah.wordpress.com/2019/03/'>March 2019</a></li>
	<li><a href='https://itmicah.wordpress.com/2017/11/'>November 2017</a></li>
	<li><a href='https://itmicah.wordpress.com/2017/10/'>October 2017</a></li>
	<li><a href='https://itmicah.wordpress.com/2016/12/'>December 2016</a></li>
	<li><a href='https://itmicah.wordpress.com/2016/11/'>November 2016</a></li>
	<li><a href='https://itmicah.wordpress.com/2016/03/'>March 2016</a></li>
	<li><a href='https://itmicah.wordpress.com/2016/02/'>February 2016</a></li>
	<li><a href='https://itmicah.wordpress.com/2015/05/'>May 2015</a></li>
	<li><a href='https://itmicah.wordpress.com/2014/11/'>November 2014</a></li>
	<li><a href='https://itmicah.wordpress.com/2014/08/'>August 2014</a></li>
	<li><a href='https://itmicah.wordpress.com/2014/05/'>May 2014</a></li>
	<li><a href='https://itmicah.wordpress.com/2014/01/'>January 2014</a></li>
	<li><a href='https://itmicah.wordpress.com/2013/12/'>December 2013</a></li>
	<li><a href='https://itmicah.wordpress.com/2013/11/'>November 2013</a></li>
	<li><a href='https://itmicah.wordpress.com/2013/10/'>October 2013</a></li>
			</ul>

			</li><li id="linkcat-198895728" class="widget-container widget_links"><h3 class="widget-title">Other IT guru blogs</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://bitsofthoughts.com/" rel="colleague noopener" title="Dutch blogsite of my former colleague Patrick Kaak" target="_blank">bITs of thoughts by Patrick Kaak</a>
Dutch blogsite of my former colleague Patrick Kaak</li>
<li><a href="http://keithga.wordpress.com/" rel="noopener" title="Great blog on all things Microsoft related" target="_blank">Keith&#039;s Consulting Blog</a>
Great blog on all things Microsoft related</li>
<li><a href="https://pshirwin.wordpress.com/" title="My main man Irwin Strachan is my besty when it comes to PowerShell. The most enthousiastic PowerShell evangelist ever!">PowerShell reverend Irwin Strachan.</a>
My main man Irwin Strachan is my besty when it comes to PowerShell. The most enthousiastic PowerShell evangelist ever!</li>
<li><a href="http://www.robinhobo.com/" rel="noopener" title="IT and Photography" target="_blank">Robin Hobo</a>
IT and Photography</li>

	</ul>
</li>
<div class="wordads-tag" data-slot-type="sidebar" style="display: none;"></div>			</ul>
		</div><!-- #primary .widget-area -->


		<div id="secondary" class="widget-area" role="complementary">
			<ul class="xoxo">
				<li id="meta-4" class="widget-container widget_meta"><h3 class="widget-title">Meta</h3>
		<ul>
			<li><a class="click-register" href="https://wordpress.com/start?ref=wplogin">Create account</a></li>			<li><a href="https://itmicah.wordpress.com/wp-login.php">Log in</a></li>
			<li><a href="https://itmicah.wordpress.com/feed/">Entries feed</a></li>
			<li><a href="https://itmicah.wordpress.com/comments/feed/">Comments feed</a></li>

			<li><a href="https://wordpress.com/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.com</a></li>
		</ul>

		</li>			</ul>
		</div><!-- #secondary .widget-area -->

	</div><!-- #main -->

	<div id="footer" role="contentinfo">
		<div id="colophon">



			<div id="footer-widget-area" role="complementary">

				<div id="first" class="widget-area">
					<ul class="xoxo">
						<li id="follow_button_widget-3" class="widget-container widget_follow_button_widget">
		<a class="wordpress-follow-button" href="https://itmicah.wordpress.com" data-blog="59931687" data-lang="en" >Follow MicaH&#039;s IT blog on WordPress.com</a>
		<script type="text/javascript">(function(d){ window.wpcomPlatform = {"titles":{"timelines":"Embeddable Timelines","followButton":"Follow Button","wpEmbeds":"WordPress Embeds"}}; var f = d.getElementsByTagName('SCRIPT')[0], p = d.createElement('SCRIPT');p.type = 'text/javascript';p.async = true;p.src = '//widgets.wp.com/platform.js';f.parentNode.insertBefore(p,f);}(document));</script>

		</li><li id="blog-stats-2" class="widget-container widget_blog-stats"><h3 class="widget-title">Blog Stats</h3>		<ul>
			<li>133,513 hits</li>
		</ul>
		</li>					</ul>
				</div><!-- #first .widget-area -->

				<div id="second" class="widget-area">
					<ul class="xoxo">
						<li id="blog_subscription-2" class="widget-container widget_blog_subscription jetpack_subscription_widget"><h3 class="widget-title"><label for="subscribe-field">Follow Blog via Email</label></h3>

			<div class="wp-block-jetpack-subscriptions__container">
			<form
				action="https://subscribe.wordpress.com"
				method="post"
				accept-charset="utf-8"
				data-blog="59931687"
				data-post_access_level="everybody"
				id="subscribe-blog"
			>
				<p>Enter your email address to follow this blog and receive notifications of new posts by email.</p>
				<p id="subscribe-email">
					<label
						id="subscribe-field-label"
						for="subscribe-field"
						class="screen-reader-text"
					>
						Email Address:					</label>

					<input
							type="email"
							name="email"
							
							style="width: 95%; padding: 1px 10px"
							placeholder="Email Address"
							value=""
							id="subscribe-field"
							required
						/>				</p>

				<p id="subscribe-submit"
									>
					<input type="hidden" name="action" value="subscribe"/>
					<input type="hidden" name="blog_id" value="59931687"/>
					<input type="hidden" name="source" value="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/"/>
					<input type="hidden" name="sub-type" value="widget"/>
					<input type="hidden" name="redirect_fragment" value="subscribe-blog"/>
					<input type="hidden" id="_wpnonce" name="_wpnonce" value="dc4f752c1d" />					<button type="submit"
													class="wp-block-button__link"
																	>
						Follow					</button>
				</p>
			</form>
							<div class="wp-block-jetpack-subscriptions__subscount">
					Join 86 other subscribers				</div>
						</div>
			
</li>					</ul>
				</div><!-- #second .widget-area -->

				<div id="third" class="widget-area">
					<ul class="xoxo">
						<li id="meta-3" class="widget-container widget_meta"><h3 class="widget-title">Meta</h3>
		<ul>
			<li><a class="click-register" href="https://wordpress.com/start?ref=wplogin">Create account</a></li>			<li><a href="https://itmicah.wordpress.com/wp-login.php">Log in</a></li>
			<li><a href="https://itmicah.wordpress.com/feed/">Entries feed</a></li>
			<li><a href="https://itmicah.wordpress.com/comments/feed/">Comments feed</a></li>

			<li><a href="https://wordpress.com/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.com</a></li>
		</ul>

		</li>					</ul>
				</div><!-- #third .widget-area -->


			</div><!-- #footer-widget-area -->

			<div id="site-info">
				<a href="https://itmicah.wordpress.com/" title="MicaH&#039;s IT blog" rel="home">
					MicaH&#039;s IT blog				</a>
							</div><!-- #site-info -->

			<div id="site-generator">
								<a href="https://wordpress.com/?ref=footer_blog" rel="nofollow">Blog at WordPress.com.</a>
			</div><!-- #site-generator -->

		</div><!-- #colophon -->
	</div><!-- #footer -->

</div><!-- #wrapper -->

<!--  -->
<script type="speculationrules">
{"prefetch":[{"source":"document","where":{"and":[{"href_matches":"\/*"},{"not":{"href_matches":["\/wp-*.php","\/wp-admin\/*","\/files\/*","\/wp-content\/*","\/wp-content\/plugins\/*","\/wp-content\/themes\/pub\/twentyten\/*","\/*\\?(.+)"]}},{"not":{"selector_matches":"a[rel~=\"nofollow\"]"}},{"not":{"selector_matches":".no-prefetch, .no-prefetch a"}}]},"eagerness":"conservative"}]}
</script>
<script type="text/javascript" src="//0.gravatar.com/js/hovercards/hovercards.min.js?ver=20252017d2298fc173af206bd9f65440008ab9e1ee2bd896241083289a9e27bd0efc7c" id="grofiles-cards-js"></script>
<script type="text/javascript" id="wpgroho-js-extra">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s2.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1610363240i'></script>

	<script>
		// Initialize and attach hovercards to all gravatars
		( function() {
			function init() {
				if ( typeof Gravatar === 'undefined' ) {
					return;
				}

				if ( typeof Gravatar.init !== 'function' ) {
					return;
				}

				Gravatar.profile_cb = function ( hash, id ) {
					WPGroHo.syncProfileData( hash, id );
				};

				Gravatar.my_hash = WPGroHo.my_hash;
				Gravatar.init(
					'body',
					'#wp-admin-bar-my-account',
					{
						i18n: {
							'Edit your profile →': 'Edit your profile →',
							'View profile →': 'View profile →',
							'Contact': 'Contact',
							'Send money': 'Send money',
							'Sorry, we are unable to load this Gravatar profile.': 'Sorry, we are unable to load this Gravatar profile.',
							'Gravatar not found.': 'Gravatar not found.',
							'Too Many Requests.': 'Too Many Requests.',
							'Internal Server Error.': 'Internal Server Error.',
							'Is this you?': 'Is this you?',
							'Claim your free profile.': 'Claim your free profile.',
							'Email': 'Email',
							'Home Phone': 'Home Phone',
							'Work Phone': 'Work Phone',
							'Cell Phone': 'Cell Phone',
							'Contact Form': 'Contact Form',
							'Calendar': 'Calendar',
						},
					}
				);
			}

			if ( document.readyState !== 'loading' ) {
				init();
			} else {
				document.addEventListener( 'DOMContentLoaded', init );
			}
		} )();
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-b4a79bbc9c61cfbd40a182ac2cf7bba1">
	</div>
	<div class="grofile-hash-map-717569e634400c09a1a6d96686808846">
	</div>
	<div class="grofile-hash-map-b4a79bbc9c61cfbd40a182ac2cf7bba1">
	</div>
	<div class="grofile-hash-map-8d08a4094d50b8c48daefe0b1373179d">
	</div>
	<div class="grofile-hash-map-23d0b60a8073185b2e29f849c4b750ac">
	</div>
	<div class="grofile-hash-map-240a50a97c7a6fb924dd04d0b4b489dc">
	</div>
	<div class="grofile-hash-map-7754e1742602aa0488c4c6de73e9584f">
	</div>
	<div class="grofile-hash-map-4454ce59597c7c56b46c6147029021db">
	</div>
	<div class="grofile-hash-map-3ddbec9fec5753aff404478004ac25e6">
	</div>
	<div class="grofile-hash-map-c76a40891ab6edac3c1e398b0787fa86">
	</div>
	<div class="grofile-hash-map-caf3285aee9837796bea1a098f8c1dbd">
	</div>
	<div class="grofile-hash-map-74aec0b2a8bbbf4e18377b7b3f8c268c">
	</div>
	<div class="grofile-hash-map-8cc849e8f799fa072585ad3223d0f3b2">
	</div>
	<div class="grofile-hash-map-889c3d2e1ae2210bd797e1f85ab108f6">
	</div>
	<div class="grofile-hash-map-6053fd41f8df2cc24e1b08f3763105fd">
	</div>
	<div class="grofile-hash-map-8b400383da516ccc72d80733ad612698">
	</div>
	<div class="grofile-hash-map-d50f14b6d7a7b1a22bf7410a0df60849">
	</div>
	<div class="grofile-hash-map-de16d37f4e07c86c793b82322cf3bf87">
	</div>
	</div>
		<script type="text/javascript">
		( function() {
			function init() {
				document.body.addEventListener( 'is.post-load', function() {
					if ( typeof __ATA.insertInlineAds === 'function' ) {
						__ATA.insertInlineAds();
					}
				} );
			}

			if ( document.readyState !== 'loading' ) {
				init();
			} else {
				document.addEventListener( 'DOMContentLoaded', init );
			}
		} )();
		</script>		<!-- CCPA [start] -->
		<script type="text/javascript">
			( function () {

				var setupPrivacy = function() {

					// Minimal Mozilla Cookie library
					// https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie/Simple_document.cookie_framework
					var cookieLib = window.cookieLib = {getItem:function(e){return e&&decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,o,n,t,r,i){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var c="";if(n)switch(n.constructor){case Number:c=n===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:c="; expires="+n;break;case Date:c="; expires="+n.toUTCString()}return"rootDomain"!==r&&".rootDomain"!==r||(r=(".rootDomain"===r?".":"")+document.location.hostname.split(".").slice(-2).join(".")),document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(o)+c+(r?"; domain="+r:"")+(t?"; path="+t:"")+(i?"; secure":""),!0}};

					// Implement IAB USP API.
					window.__uspapi = function( command, version, callback ) {

						// Validate callback.
						if ( typeof callback !== 'function' ) {
							return;
						}

						// Validate the given command.
						if ( command !== 'getUSPData' || version !== 1 ) {
							callback( null, false );
							return;
						}

						// Check for GPC. If set, override any stored cookie.
						if ( navigator.globalPrivacyControl ) {
							callback( { version: 1, uspString: '1YYN' }, true );
							return;
						}

						// Check for cookie.
						var consent = cookieLib.getItem( 'usprivacy' );

						// Invalid cookie.
						if ( null === consent ) {
							callback( null, false );
							return;
						}

						// Everything checks out. Fire the provided callback with the consent data.
						callback( { version: 1, uspString: consent }, true );
					};

					// Initialization.
					document.addEventListener( 'DOMContentLoaded', function() {

						// Internal functions.
						var setDefaultOptInCookie = function() {
							var value = '1YNN';
							var domain = '.wordpress.com' === location.hostname.slice( -14 ) ? '.rootDomain' : location.hostname;
							cookieLib.setItem( 'usprivacy', value, 365 * 24 * 60 * 60, '/', domain );
						};

						var setDefaultOptOutCookie = function() {
							var value = '1YYN';
							var domain = '.wordpress.com' === location.hostname.slice( -14 ) ? '.rootDomain' : location.hostname;
							cookieLib.setItem( 'usprivacy', value, 24 * 60 * 60, '/', domain );
						};

						var setDefaultNotApplicableCookie = function() {
							var value = '1---';
							var domain = '.wordpress.com' === location.hostname.slice( -14 ) ? '.rootDomain' : location.hostname;
							cookieLib.setItem( 'usprivacy', value, 24 * 60 * 60, '/', domain );
						};

						var setCcpaAppliesCookie = function( applies ) {
							var domain = '.wordpress.com' === location.hostname.slice( -14 ) ? '.rootDomain' : location.hostname;
							cookieLib.setItem( 'ccpa_applies', applies, 24 * 60 * 60, '/', domain );
						}

						var maybeCallDoNotSellCallback = function() {
							if ( 'function' === typeof window.doNotSellCallback ) {
								return window.doNotSellCallback();
							}

							return false;
						}

						// Look for usprivacy cookie first.
						var usprivacyCookie = cookieLib.getItem( 'usprivacy' );

						// Found a usprivacy cookie.
						if ( null !== usprivacyCookie ) {

							// If the cookie indicates that CCPA does not apply, then bail.
							if ( '1---' === usprivacyCookie ) {
								return;
							}

							// CCPA applies, so call our callback to add Do Not Sell link to the page.
							maybeCallDoNotSellCallback();

							// We're all done, no more processing needed.
							return;
						}

						// We don't have a usprivacy cookie, so check to see if we have a CCPA applies cookie.
						var ccpaCookie = cookieLib.getItem( 'ccpa_applies' );

						// No CCPA applies cookie found, so we'll need to geolocate if this visitor is from California.
						// This needs to happen client side because we do not have region geo data in our $SERVER headers,
						// only country data -- therefore we can't vary cache on the region.
						if ( null === ccpaCookie ) {

							var request = new XMLHttpRequest();
							request.open( 'GET', 'https://public-api.wordpress.com/geo/', true );

							request.onreadystatechange = function () {
								if ( 4 === this.readyState ) {
									if ( 200 === this.status ) {

										// Got a geo response. Parse out the region data.
										var data = JSON.parse( this.response );
										var region      = data.region ? data.region.toLowerCase() : '';
										var ccpa_applies = ['california', 'colorado', 'connecticut', 'delaware', 'indiana', 'iowa', 'montana', 'new jersey', 'oregon', 'tennessee', 'texas', 'utah', 'virginia'].indexOf( region ) > -1;
										// Set CCPA applies cookie. This keeps us from having to make a geo request too frequently.
										setCcpaAppliesCookie( ccpa_applies );

										// Check if CCPA applies to set the proper usprivacy cookie.
										if ( ccpa_applies ) {
											if ( maybeCallDoNotSellCallback() ) {
												// Do Not Sell link added, so set default opt-in.
												setDefaultOptInCookie();
											} else {
												// Failed showing Do Not Sell link as required, so default to opt-OUT just to be safe.
												setDefaultOptOutCookie();
											}
										} else {
											// CCPA does not apply.
											setDefaultNotApplicableCookie();
										}
									} else {
										// Could not geo, so let's assume for now that CCPA applies to be safe.
										setCcpaAppliesCookie( true );
										if ( maybeCallDoNotSellCallback() ) {
											// Do Not Sell link added, so set default opt-in.
											setDefaultOptInCookie();
										} else {
											// Failed showing Do Not Sell link as required, so default to opt-OUT just to be safe.
											setDefaultOptOutCookie();
										}
									}
								}
							};

							// Send the geo request.
							request.send();
						} else {
							// We found a CCPA applies cookie.
							if ( ccpaCookie === 'true' ) {
								if ( maybeCallDoNotSellCallback() ) {
									// Do Not Sell link added, so set default opt-in.
									setDefaultOptInCookie();
								} else {
									// Failed showing Do Not Sell link as required, so default to opt-OUT just to be safe.
									setDefaultOptOutCookie();
								}
							} else {
								// CCPA does not apply.
								setDefaultNotApplicableCookie();
							}
						}
					} );
				};

				// Kickoff initialization.
				if ( window.defQueue && defQueue.isLOHP && defQueue.isLOHP === 2020 ) {
					defQueue.items.push( setupPrivacy );
				} else {
					setupPrivacy();
				}

			} )();
		</script>

		<!-- CCPA [end] -->
		<div class="widget widget_eu_cookie_law_widget">
<div
	class="hide-on-button ads-active"
	data-hide-timeout="30"
	data-consent-expiration="180"
	id="eu-cookie-law"
	style="display: none"
>
	<form method="post">
		<input type="submit" value="Close and accept" class="accept" />

		Privacy &amp; Cookies: This site uses cookies. By continuing to use this website, you agree to their use. <br />
To find out more, including how to control cookies, see here:
				<a href="https://automattic.com/cookies/" rel="nofollow">
			Cookie Policy		</a>
 </form>
</div>
</div>		<div id="actionbar" dir="ltr" style="display: none;"
			class="actnbr-pub-twentyten actnbr-has-follow actnbr-has-actions">
		<ul>
								<li class="actnbr-btn actnbr-hidden">
						<a class="actnbr-action actnbr-actn-comment" href="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/#comments">
							<svg class="gridicon gridicons-comment" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M12 16l-5 5v-5H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2v9c0 1.1-.9 2-2 2h-7z"/></g></svg>							<span>Comment						</span>
						</a>
					</li>
									<li class="actnbr-btn actnbr-hidden">
						<a class="actnbr-action actnbr-actn-reblog" href="">
							<svg class="gridicon gridicons-reblog" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M22.086 9.914L20 7.828V18c0 1.105-.895 2-2 2h-7v-2h7V7.828l-2.086 2.086L14.5 8.5 19 4l4.5 4.5-1.414 1.414zM6 16.172V6h7V4H6c-1.105 0-2 .895-2 2v10.172l-2.086-2.086L.5 15.5 5 20l4.5-4.5-1.414-1.414L6 16.172z"/></g></svg><span>Reblog</span>
						</a>
					</li>
									<li class="actnbr-btn actnbr-hidden">
								<a class="actnbr-action actnbr-actn-follow " href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z"  fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
							<div class="actnbr-popover tip tip-top-left actnbr-notice" id="follow-bubble">
							<div class="tip-arrow"></div>
							<div class="tip-inner actnbr-follow-bubble">
															<ul>
											<li class="actnbr-sitename">
			<a href="https://itmicah.wordpress.com">
				<img loading='lazy' alt='' src='https://s2.wp.com/i/logo/wpcom-gray-white.png' srcset='https://s2.wp.com/i/logo/wpcom-gray-white.png 1x' class='avatar avatar-50' height='50' width='50' />				MicaH&#039;s IT blog			</a>
		</li>
										<div class="actnbr-message no-display"></div>
									<form method="post" action="https://subscribe.wordpress.com" accept-charset="utf-8" style="display: none;">
																						<div class="actnbr-follow-count">Join 45 other subscribers</div>
																					<div>
										<input type="email" name="email" placeholder="Enter your email address" class="actnbr-email-field" aria-label="Enter your email address" />
										</div>
										<input type="hidden" name="action" value="subscribe" />
										<input type="hidden" name="blog_id" value="59931687" />
										<input type="hidden" name="source" value="https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/" />
										<input type="hidden" name="sub-type" value="actionbar-follow" />
										<input type="hidden" id="_wpnonce" name="_wpnonce" value="dc4f752c1d" />										<div class="actnbr-button-wrap">
											<button type="submit" value="Sign me up">
												Sign me up											</button>
										</div>
									</form>
									<li class="actnbr-login-nudge">
										<div>
											Already have a WordPress.com account? <a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fitmicah.wordpress.com%2F2013%2F10%2F29%2Factive-directory-ou-picker-in-powershell%2F&#038;signup_flow=account">Log in now.</a>										</div>
									</li>
								</ul>
															</div>
						</div>
					</li>
							<li class="actnbr-ellipsis actnbr-hidden">
				<svg class="gridicon gridicons-ellipsis" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M7 12c0 1.104-.896 2-2 2s-2-.896-2-2 .896-2 2-2 2 .896 2 2zm12-2c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm-7 0c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2z"/></g></svg>				<div class="actnbr-popover tip tip-top-left actnbr-more">
					<div class="tip-arrow"></div>
					<div class="tip-inner">
						<ul>
								<li class="actnbr-sitename">
			<a href="https://itmicah.wordpress.com">
				<img loading='lazy' alt='' src='https://s2.wp.com/i/logo/wpcom-gray-white.png' srcset='https://s2.wp.com/i/logo/wpcom-gray-white.png 1x' class='avatar avatar-50' height='50' width='50' />				MicaH&#039;s IT blog			</a>
		</li>
								<li class="actnbr-folded-follow">
										<a class="actnbr-action actnbr-actn-follow " href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z"  fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
								</li>
														<li class="actnbr-signup"><a href="https://wordpress.com/start/">Sign up</a></li>
							<li class="actnbr-login"><a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fitmicah.wordpress.com%2F2013%2F10%2F29%2Factive-directory-ou-picker-in-powershell%2F&#038;signup_flow=account">Log in</a></li>
																<li class="actnbr-shortlink">
										<a href="https://wp.me/p43sY7-f">
											<span class="actnbr-shortlink__text">Copy shortlink</span>
											<span class="actnbr-shortlink__icon"><svg class="gridicon gridicons-checkmark" height="16" width="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M9 19.414l-6.707-6.707 1.414-1.414L9 16.586 20.293 5.293l1.414 1.414"/></g></svg></span>
										</a>
									</li>
																<li class="flb-report">
									<a href="https://wordpress.com/abuse/?report_url=https://itmicah.wordpress.com/2013/10/29/active-directory-ou-picker-in-powershell/" target="_blank" rel="noopener noreferrer">
										Report this content									</a>
								</li>
															<li class="actnbr-reader">
									<a href="https://wordpress.com/reader/blogs/59931687/posts/15">
										View post in Reader									</a>
								</li>
															<li class="actnbr-subs">
									<a href="https://subscribe.wordpress.com/">Manage subscriptions</a>
								</li>
																<li class="actnbr-fold"><a href="">Collapse this bar</a></li>
														</ul>
					</div>
				</div>
			</li>
		</ul>
	</div>
	
<script>
window.addEventListener( "load", function( event ) {
	var link = document.createElement( "link" );
	link.href = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.css?v=20250116";
	link.type = "text/css";
	link.rel = "stylesheet";
	document.head.appendChild( link );

	var script = document.createElement( "script" );
	script.src = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.js?v=20250204";
	script.defer = true;
	document.body.appendChild( script );
} );
</script>

			<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div
				class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions"
				itemscope
				itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"/>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"/>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"/>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
							</span>
						</a>
												<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"/>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea
													name="comment"
													class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea"
													id="jp-carousel-comment-form-comment-field"
													placeholder="Write a Comment..."
												></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email (Required)</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name (Required)</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field" />
															</fieldset>
																											</div>
													<input
														type="submit"
														name="submit"
														class="jp-carousel-comment-form-button"
														id="jp-carousel-comment-form-button-submit"
														value="Post Comment" />
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" href="#" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"/>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/itmicah.wordpress.com\/2013\/10\/29\/active-directory-ou-picker-in-powershell\/":15};
	</script>
				<link crossorigin='anonymous' rel='stylesheet' id='all-css-0-2' href='https://s1.wp.com/_static/??-eJydj8EKAjEMRH/IGnYRXQ/ip0g3DSVrm5ampfj3CuvevLi3mTDzyEDPBpNUkgqxmRyaZ1FYqGaLz68HbQIxuRZIAW1JTSmAds5UzNzEBTqi6gH2w7bMdviT92BB8CRU+FPQ33Lnj52dp6qgCdkGE8mxNStb62udfo+34XI6T+M4XYflDYDZgSQ=&cssminify=yes' type='text/css' media='all' />
<script type="text/javascript" src="https://s1.wp.com/wp-content/js/mobile-useragent-info.js?m=1609849039i&amp;ver=20241018" id="mobile-useragent-info-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" id="verbum-settings-js-before">
/* <![CDATA[ */
window.VerbumComments = {"Log in or provide your name and email to leave a reply.":"Log in or provide your name and email to leave a reply.","Log in or provide your name and email to leave a comment.":"Log in or provide your name and email to leave a comment.","Receive web and mobile notifications for posts on this site.":"Receive web and mobile notifications for posts on this site.","Name":"Name","Email (address never made public)":"Email (address never made public)","Website (optional)":"Website (optional)","Leave a reply. (log in optional)":"Leave a reply. (log in optional)","Leave a comment. (log in optional)":"Leave a comment. (log in optional)","Log in to leave a reply.":"Log in to leave a reply.","Log in to leave a comment.":"Log in to leave a comment.","Logged in via %s":"Logged in via %s","Log out":"Log out","Email":"Email","(Address never made public)":"(Address never made public)","Instantly":"Instantly","Daily":"Daily","Reply":"Reply","Comment":"Comment","WordPress":"WordPress","Weekly":"Weekly","Notify me of new posts":"Notify me of new posts","Email me new posts":"Email me new posts","Email me new comments":"Email me new comments","Cancel":"Cancel","Write a comment...":"Write a comment...","Write a reply...":"Write a reply...","Website":"Website","Optional":"Optional","We'll keep you in the loop!":"We'll keep you in the loop!","Loading your comment...":"Loading your comment...","Discover more from":"Discover more from MicaH's IT blog","Subscribe now to keep reading and get access to the full archive.":"Subscribe now to keep reading and get access to the full archive.","Continue reading":"Continue reading","Never miss a beat!":"Never miss a beat!","Interested in getting blog post updates? Simply click the button below to stay in the loop!":"Interested in getting blog post updates? Simply click the button below to stay in the loop!","Enter your email address":"Enter your email address","Subscribe":"Subscribe","Comment sent successfully":"Comment sent successfully","Save my name, email, and website in this browser for the next time I comment.":"Save my name, email, and website in this browser for the next time I comment.","hovercardi18n":{"Edit your profile \u2192":"Edit your profile \u2192","View profile \u2192":"View profile \u2192","Contact":"Contact","Send money":"Send money","Profile not found.":"Profile not found.","Too Many Requests.":"Too Many Requests.","Internal Server Error.":"Internal Server Error.","Sorry, we are unable to load this Gravatar profile.":"Sorry, we are unable to load this Gravatar profile."},"siteId":59931687,"postId":15,"mustLogIn":false,"requireNameEmail":true,"commentRegistration":false,"connectURL":"https:\/\/itmicah.wordpress.com\/public.api\/connect\/?action=request&from_comments=yes","logoutURL":"https:\/\/itmicah.wordpress.com\/wp-login.php?action=logout&_wpnonce=ba22c74fdd","homeURL":"https:\/\/itmicah.wordpress.com\/","subscribeToBlog":true,"subscribeToComment":true,"isJetpackCommentsLoggedIn":false,"jetpackUsername":"","jetpackUserId":0,"jetpackSignature":"","jetpackAvatar":"https:\/\/0.gravatar.com\/avatar\/?s=96&amp;d=identicon&amp;r=G","enableBlocks":true,"enableSubscriptionModal":true,"currentLocale":"en","isJetpackComments":false,"allowedBlocks":["core\/paragraph","core\/list","core\/code","core\/list-item","core\/quote","core\/image","core\/embed","core\/quote","core\/code"],"embedNonce":"dc96985f90","verbumBundleUrl":"https:\/\/s2.wp.com\/wp-content\/mu-plugins\/jetpack-mu-wpcom-plugin\/sun\/jetpack_vendor\/automattic\/jetpack-mu-wpcom\/src\/features\/verbum-comments\/dist\/index.js","isRTL":false,"vbeCacheBuster":1738686361,"iframeUniqueId":0,"colorScheme":false}
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s0.wp.com/_static/??-eJx9jksOAiEQRC8k02LMTFwYz4LQQZjmIw1DvL0kxmhcuK16r1LQs9ApVowVrpSsyNSsiww9FaMMC02KGRn8iFQlsR0mzzv40kL7SM5YrAzYRptWh4JUh4ohk6r4k//ZIbcO+t6w4U1FQ1jesIuamnn90SmEIYqCmR5TcHFAl3CWy3Fe5F6eZv8EVd5Rwg=='></script>
<script type="text/javascript" src="https://s1.wp.com/wp-content/mu-plugins/jetpack-mu-wpcom-plugin/sun/jetpack_vendor/automattic/jetpack-mu-wpcom/src/build/verbum-comments/assets/dynamic-loader.js?m=1741800217i&amp;minify=false&amp;ver=74baca08b8baf473b8a0" id="verbum-dynamic-loader-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" id="jetpack-carousel-js-extra">
/* <![CDATA[ */
var jetpackSwiperLibraryPath = {"url":"https:\/\/s2.wp.com\/wp-content\/mu-plugins\/jetpack-plugin\/sun\/_inc\/build\/carousel\/swiper-bundle.min.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/itmicah.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"04c687170d","display_exif":"0","display_comments":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","image_label":"Open image in full-screen.","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/itmicah.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fitmicah.wordpress.com%2F2013%2F10%2F29%2Factive-directory-ou-picker-in-powershell%2F","blog_id":"59931687","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"stats_query_args":"blog=59931687&v=wpcom&tz=2&user_id=0&subd=itmicah","is_public":"1"};
/* ]]> */
</script>
<script type="text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s0.wp.com/_static/??-eJx9T0sOwiAUvJDwamh1ZTyKQcD6KDwInzTe3qQWF8awm5nMJwNrZCpQMVTAVxZdnZEyWFOiVMvOIVeCG5KCe0WnQckUajbua2sC90jc5gP8b5ULZm8KE3z41DXhkTaz7mTbBFujCv6HdnL9J/kpk9FS69cGkeb9wtVfjufxNE1CDKN9A+Q0bTE='></script>
<script type="text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>

	<script type="text/javascript">
		(function () {
			var wpcom_reblog = {
				source: 'toolbar',

				toggle_reblog_box_flair: function (obj_id, post_id) {

					// Go to site selector. This will redirect to their blog if they only have one.
					const postEndpoint = `https://wordpress.com/post`;

					// Ideally we would use the permalink here, but fortunately this will be replaced with the 
					// post permalink in the editor.
					const originalURL = `${ document.location.href }?page_id=${ post_id }`; 
					
					const url =
						postEndpoint +
						'?url=' +
						encodeURIComponent( originalURL ) +
						'&is_post_share=true' +
						'&v=5';

					const redirect = function () {
						if (
							! window.open( url, '_blank' )
						) {
							location.href = url;
						}
					};

					if ( /Firefox/.test( navigator.userAgent ) ) {
						setTimeout( redirect, 0 );
					} else {
						redirect();
					}
				},
			};

			window.wpcom_reblog = wpcom_reblog;
		})();
	</script>
	<iframe src='https://widgets.wp.com/likes/master.html?ver=20250515#ver=20250515' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
	<div id='likes-other-gravatars' role="dialog" aria-hidden="true" tabindex="-1"><div class="likes-text"><span>%d</span></div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
	<script src="//stats.wp.com/w.js?68" defer></script> <script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'59931687','blog_tz':'2','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'59931687','v':'wpcom','tz':'2','user_id':'0','post':'15','subd':'itmicah'}]);
_stq.push(['extra', {'crypt':'UE5XaGUuOTlwaD85flAmcm1mcmZsaDhkV11YdTdvUG14Q2VDQTR4LlUsLi82dU1mai9BMlJHcFZwMXpXJVBJUXIubTZXV18lMlBmbHc0eVZwQ2NlSmFHJVBbaV1kVEhhNDksJlR2a3BOJXBxaU5xX3VjbXc1b1NXSnc1MV9VSndCK1N8dVErb0JQT0sxdXZXVnQuNHhhelplK2ZdLWkteVM3Si9TeUR2LUxMTW5vNmoyYllQYUU/MEZjW2RvLWp+cENMNXdpN11ERHw5cj05UFJhT112aHZLbSwwMEpXOUhGRSU9VitbMmR6UGVTYV9INGolZDJZb2tpdmEmL2wwT2VLWHN5fHEzLzJsPS4lfjNhSW9hQ3NHPz9QaEguYnBNND1VU3czMTlrRSVMQU1CWG1LVDlqZ3FWY1F5dXZfWDkxUE9bRTlmRGRLVX54OTFPWDYyRFgwLmcua1YsbGduYWgrQS1zQl01VSxoNklLSWw1bTRiSG8yWnBDb09GMW8lTnROUlVxVzQsfHVfaEIlREY1ZHF1WWUlQ1BSTmEyXThlK2tZVnxpWyUyP240Qm8ueS1BYmgyVXFEU2ZDYVE='}]);
_stq.push([ 'clickTrackerInit', '59931687', '15' ]);
</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:1px;width:1px;overflow:hidden;position:absolute;bottom:1px;" alt="" /></noscript>
<script defer id="bilmur" data-customproperties="{&quot;logged_in&quot;:&quot;0&quot;,&quot;wptheme&quot;:&quot;pub\/twentyten&quot;,&quot;wptheme_is_block&quot;:&quot;0&quot;}" data-provider="wordpress.com" data-service="simple" data-site-tz="Europe/Amsterdam"   src="/wp-content/js/bilmur-4.min.js?i=12&m=202520"></script><div id="marketingbar" class="marketing-bar noskim  "><div class="marketing-bar-text">Design a site like this with WordPress.com</div><a class="marketing-bar-button" href="https://wordpress.com/start/?ref=marketing_bar">Get started</a><a class="marketing-bar-link" tabindex="-1" aria-label="Create your website at WordPress.com" href="https://wordpress.com/start/?ref=marketing_bar"></a></div>		<script type="text/javascript">
			window._tkq = window._tkq || [];

			window._tkq.push( [ 'recordEvent', 'wpcom_marketing_bar_impression', {"is_current_user_blog_owner":false} ] );

			document.querySelectorAll( '#marketingbar > a' ).forEach( link => {
				link.addEventListener( 'click', ( e ) => {
					window._tkq.push( [ 'recordEvent', 'wpcom_marketing_bar_cta_click', {"is_current_user_blog_owner":false} ] );
				} );
			});
		</script><script>
( function() {
	function getMobileUserAgentInfo() {
		if ( typeof wpcom_mobile_user_agent_info === 'object' ) {
			wpcom_mobile_user_agent_info.init();
			var mobileStatsQueryString = '';

			if ( wpcom_mobile_user_agent_info.matchedPlatformName !== false ) {
				mobileStatsQueryString += '&x_' + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
			}

			if ( wpcom_mobile_user_agent_info.matchedUserAgentName !== false ) {
				mobileStatsQueryString += '&x_' + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
			}

			if ( wpcom_mobile_user_agent_info.isIPad() ) {
				mobileStatsQueryString += '&x_' + 'ipad_views' + '=' + 'views';
			}

			if ( mobileStatsQueryString != '' ) {
				new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
			}
		}
	}

	document.addEventListener( 'DOMContentLoaded', getMobileUserAgentInfo );
} )();
</script>
<script>
(function() {
	'use strict';

	const fetches = {};
	const promises = {};
	const urls = {
		'wp-polyfill': 'https://s1.wp.com/wp-includes/js/dist/vendor/wp-polyfill.min.js?m=1744646400i&ver=3.15.0',
		'verbum': 'https://s2.wp.com/wp-content/mu-plugins/jetpack-mu-wpcom-plugin/sun/jetpack_vendor/automattic/jetpack-mu-wpcom/src/build/verbum-comments/verbum-comments.js?m=1746618905i&minify=false&ver=e7eb4580fccc06e8771c'
	};
	const loaders = {
		'verbum': () => {
			fetchExternalScript('wp-polyfill');
			fetchExternalScript('verbum');
			promises['wp-polyfill'] = promises['wp-polyfill'] || loadWPScript('wp-polyfill');
			promises['verbum'] = promises['verbum'] || promises['wp-polyfill'].then( () => loadWPScript('verbum') );
			return promises['verbum'];
		},
		
	};
	const scriptExtras = {
		
	};

	window.WP_Enqueue_Dynamic_Script = {
		loadScript: (handle) => {
			if (!loaders[handle]) {
				console.error('WP_Enqueue_Dynamic_Script: unregistered script `' + handle + '`.');
			}
			return loaders[handle]();
		}
	};

	function fetchExternalScript(handle) {
		if (!urls[handle]) {
			return Promise.resolve();
		}

		fetches[handle] = fetches[handle] || fetch(urls[handle], { mode: 'no-cors' });
		return fetches[handle];
	}

	function runExtraScript(handle, type, index) {
		const id = 'wp-enqueue-dynamic-script:' + handle + ':' + type + ':' + (index + 1);
		const template = document.getElementById(id);
		if (!template) {
			return Promise.reject();
		}

		const script = document.createElement( 'script' );
		script.innerHTML = template.innerHTML;
		document.body.appendChild( script );
		return Promise.resolve();
	}

	function loadExternalScript(handle) {
		if (!urls[handle]) {
			return Promise.resolve();
		}

		return fetches[handle].then(() => {
			return new Promise((resolve, reject) => {
				const script = document.createElement('script');
				script.onload = () => resolve();
				script.onerror = (e) => reject(e);
				script.src = urls[handle];
				document.body.appendChild(script);
			});
		});
	}

	function loadExtra(handle, pos) {
		const count = (scriptExtras[handle] && scriptExtras[handle][pos]) || 0;
		let promise = Promise.resolve();

		for (let i = 0; i < count; i++) {
			promise = promise.then(() => runExtraScript(handle, pos, i));
		}

		return promise;
	}

	function loadWPScript(handle) {
		// Core loads scripts in this order. See: https://github.com/WordPress/WordPress/blob/a59eb9d39c4fcba834b70c9e8dfd64feeec10ba6/wp-includes/class-wp-scripts.php#L428.
		return loadExtra(handle, 'translations')
			.then(() => loadExtra(handle, 'before'))
			.then(() => loadExternalScript(handle))
			.then(() => loadExtra(handle, 'after'));
	}
} )();
</script>
</body>
</html>
