<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Windows 7 as a Wireless Access Point - Ishan&#039;s blog</title>
<link rel="profile" href="https://gmpg.org/xfn/11" />
<link rel="pingback" href="https://www.ishanarora.com/xmlrpc.php" />
<!--[if lt IE 9]>
<script src="http://www.ishanarora.com/wp-content/themes/expound/js/html5.js" type="text/javascript"></script>
<![endif]-->


<!-- This site is optimized with the Yoast SEO plugin v5.7.1 - https://yoast.com/wordpress/plugins/seo/ -->
<link rel="canonical" href="https://www.ishanarora.com/2009/07/29/windows-7-as-a-wireless-access-point/" />
<script type='application/ld+json'>{"@context":"http:\/\/schema.org","@type":"WebSite","@id":"#website","url":"http:\/\/www.ishanarora.com\/","name":"Ishan&#039;s blog","potentialAction":{"@type":"SearchAction","target":"http:\/\/www.ishanarora.com\/?s={search_term_string}","query-input":"required name=search_term_string"}}</script>
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Ishan&#039;s blog &raquo; Feed" href="https://www.ishanarora.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Ishan&#039;s blog &raquo; Comments Feed" href="https://www.ishanarora.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Ishan&#039;s blog &raquo; Windows 7 as a Wireless Access Point Comments Feed" href="https://www.ishanarora.com/2009/07/29/windows-7-as-a-wireless-access-point/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.ishanarora.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.8.20"}};
			!function(t,a,e){var r,i,n,o=a.createElement("canvas"),l=o.getContext&&o.getContext("2d");function c(t){var e=a.createElement("script");e.src=t,e.defer=e.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(e)}for(n=Array("flag","emoji4"),e.supports={everything:!0,everythingExceptFlag:!0},i=0;i<n.length;i++)e.supports[n[i]]=function(t){var e,a=String.fromCharCode;if(!l||!l.fillText)return!1;switch(l.clearRect(0,0,o.width,o.height),l.textBaseline="top",l.font="600 32px Arial",t){case"flag":return(l.fillText(a(55356,56826,55356,56819),0,0),e=o.toDataURL(),l.clearRect(0,0,o.width,o.height),l.fillText(a(55356,56826,8203,55356,56819),0,0),e===o.toDataURL())?!1:(l.clearRect(0,0,o.width,o.height),l.fillText(a(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),e=o.toDataURL(),l.clearRect(0,0,o.width,o.height),l.fillText(a(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),e!==o.toDataURL());case"emoji4":return l.fillText(a(55358,56794,8205,9794,65039),0,0),e=o.toDataURL(),l.clearRect(0,0,o.width,o.height),l.fillText(a(55358,56794,8203,9794,65039),0,0),e!==o.toDataURL()}return!1}(n[i]),e.supports.everything=e.supports.everything&&e.supports[n[i]],"flag"!==n[i]&&(e.supports.everythingExceptFlag=e.supports.everythingExceptFlag&&e.supports[n[i]]);e.supports.everythingExceptFlag=e.supports.everythingExceptFlag&&!e.supports.flag,e.DOMReady=!1,e.readyCallback=function(){e.DOMReady=!0},e.supports.everything||(r=function(){e.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",r,!1),t.addEventListener("load",r,!1)):(t.attachEvent("onload",r),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&e.readyCallback()})),(r=e.source||{}).concatemoji?c(r.concatemoji):r.wpemoji&&r.twemoji&&(c(r.twemoji),c(r.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='wp-pagenavi-css' href="https://www.ishanarora.com/wp-content/plugins/wp-pagenavi/pagenavi-css.css?ver=2.70" type='text/css' media='all' />
<link rel='stylesheet' id='expound-style-css' href="https://www.ishanarora.com/wp-content/themes/expound/style.css?ver=20140129" type='text/css' media='all' />
<link rel='stylesheet' id='author-info-widget-css' href="https://www.ishanarora.com/wp-content/plugins/author-info-widget/author-info-widget.css?ver=4.8.20" type='text/css' media='all' />
<link rel='https://api.w.org/' href="https://www.ishanarora.com/wp-json/" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.ishanarora.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.ishanarora.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.8.20" />
<link rel='shortlink' href="https://www.ishanarora.com/?p=19" />
<link rel="alternate" type="application/json+oembed" href="https://www.ishanarora.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.ishanarora.com%2F2009%2F07%2F29%2Fwindows-7-as-a-wireless-access-point%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://www.ishanarora.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.ishanarora.com%2F2009%2F07%2F29%2Fwindows-7-as-a-wireless-access-point%2F&#038;format=xml" />

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Windows 7 as a Wireless Access Point" />
<meta property="og:url" content="http://www.ishanarora.com/2009/07/29/windows-7-as-a-wireless-access-point/" />
<meta property="og:description" content="As you may already know Windows 7 adds native Virtual WiFi technology from Microsoft Research as mentioned by Long on his blog. This lead me to this MSDN page stating “On Windows 7 and later, the o…" />
<meta property="article:published_time" content="2009-07-29T13:23:00+00:00" />
<meta property="article:modified_time" content="2011-06-11T19:02:57+00:00" />
<meta property="og:site_name" content="Ishan&#039;s blog" />
<meta property="og:image" content="http://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_5.png" />
<meta property="og:image:width" content="294" />
<meta property="og:image:height" content="437" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="Windows 7 as a Wireless Access Point" />
<meta name="twitter:image" content="http://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_5.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />
</head>

<body class="post-template-default single single-post postid-19 single-format-standard">
<div id="page" class="hfeed site">
		<header id="masthead" class="site-header" role="banner">
		<div class="site-branding">
			<div class="site-title-group">
				<h1 class="site-title"><a href="https://www.ishanarora.com/" title="Ishan&#039;s blog" rel="home">Ishan&#039;s blog</a></h1>
				<h2 class="site-description"></h2>
			</div>
		</div>

		<nav id="site-navigation" class="navigation-main" role="navigation">
			<h1 class="menu-toggle">Menu</h1>
			<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

			<div class="menu-front-menu-container"><ul id="menu-front-menu" class="menu"><li id="menu-item-51" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-has-children menu-item-51"><a href="https://www.ishanarora.com/">Blog</a>
<ul  class="sub-menu">
	<li id="menu-item-47" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-47"><a href="https://www.ishanarora.com/category/bullshit/">Bullshit Blogging</a></li>
	<li id="menu-item-50" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-50"><a href="https://www.ishanarora.com/category/tech/">Technology</a></li>
</ul>
</li>
<li id="menu-item-57" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-57"><a>Open Source</a>
<ul  class="sub-menu">
	<li id="menu-item-59" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-59"><a href="http://qbittorrent.sourceforge.net/">qBittorrent</a></li>
</ul>
</li>
</ul></div>								</nav><!-- #site-navigation -->
	</header><!-- #masthead -->
	
	<div id="main" class="site-main">

	<div id="primary" class="content-area">
		<div id="content" class="site-content" role="main">

		
			
<article id="post-19" class="post-19 post type-post status-publish format-standard has-post-thumbnail hentry category-tech tag-hosted-network tag-hostednetwork tag-netsh tag-netsh-wlan tag-softap tag-software-wireless-access-point tag-virtual-wifi tag-vwifi tag-windows-7">
	<header class="entry-header">
		<h1 class="entry-title">Windows 7 as a Wireless Access Point</h1>

		<div class="entry-meta">
			<a class="author" rel="author" href="https://www.ishanarora.com/author/ishanarora/">Ishan Arora</a> / <a class="entry-date" href="https://www.ishanarora.com/2009/07/29/windows-7-as-a-wireless-access-point/">July 29, 2009</a>		</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

	<div class="entry-content">
		<p>As you may already know <a href="http://www.istartedsomething.com/20090516/windows-7-native-virtual-wifi-technology-microsoft-research/">Windows 7 adds native Virtual WiFi technology from Microsoft Research</a> as mentioned by Long on his blog. This lead me to <a href="http://msdn.microsoft.com/en-us/library/dd439506%28VS.85%29.aspx">this MSDN page</a> stating</p>
<blockquote><p><em>“On Windows 7 and later, the operating system installs a virtual device if a Hosted Network capable wireless adapter is present on the machine. This virtual device normally shows up in the “Network Connections Folder” as ‘Wireless Network Connection 2’ with a Device Name of ‘Microsoft Virtual WiFi Miniport adapter’ if the computer has a single wireless network adapter. This virtual device is used exclusively for performing software access point (SoftAP) connections and is not present in the list returned by the WlanEnumInterfaces function. The lifetime of this virtual device is tied to the physical wireless adapter. If the physical wireless adapter is disabled, this virtual device will be removed as well.”</em></p></blockquote>
<p>Wait a minute! SoftAP! Seriously? This was a surprize since I had been exploring a solution for this exact problem for more than a month. However I was disappointed at first when I got my hands on Windows 7 RC. There was no setting for this so called SoftAP feature. Forget that, I could not even find the virtual wireless device named <em>“Microsoft Virtual WiFi Miniport adapter”</em>. It just did not exist. Some people on the web speculated that this was because of missing driver support even though Virtual WiFi functionality is a requirement for WLAN drivers under the Windows 7 certification logo. This did not fit. I was never prompted for installing uncertified drivers. As a matter of fact I did not have to install any drivers at all. Everything was done by Windows 7 automatically. I decided to investigate, and found the <a href="http://msdn.microsoft.com/en-us/library/dd815243%28VS.85%29.aspx">solution</a>. Basically there is no native GUI to do all this, so you have to use command prompt to do all this. Here is what you need to do.<span id="more-19"></span></p>
<p>Run cmd.exe as administrator and enter  the following command</p>
<p><a href="https://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_1.png"><img class="aligncenter size-full wp-image-80" title="Run cmd.exe as administrator" src="https://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_1.png" alt="" width="442" height="516" srcset="http://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_1.png 442w, http://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_1-256x300.png 256w" sizes="(max-width: 442px) 100vw, 442px" /></a></p>
<p><em>netsh wlan set hostednetwork mode=allow &#8220;ssid=&lt;ssid&gt;&#8221; “key=&lt;passphrase&gt;” keyUsage=persistent</em></p>
<p>where is <em>&lt;ssid&gt;</em> is the SSID and <em>&lt;passphrase&gt;</em> is the WPA2-Personal key you want to associate with your SoftAP.</p>
<p><a href="https://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_2.png"><img class="aligncenter size-full wp-image-81" title="set up hostednetwork" src="https://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_2.png" alt="" width="687" height="354" srcset="http://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_2.png 687w, http://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_2-300x154.png 300w" sizes="(max-width: 687px) 100vw, 687px" /></a></p>
<p>This will create the required <em>“Microsoft Virtual WiFi Miniport adapter”</em> and also set up your <em>hostednetwork</em>. You may now setup Internet Connection Sharing or Network Bridging for this newly found adapter. All this is onetime setting.</p>
<p><a href="https://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_3.png"><img class="aligncenter size-full wp-image-82" title="Microsoft Virtual WiFi Miniport adapter" src="https://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_3.png" alt="" width="558" height="254" srcset="http://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_3.png 558w, http://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_3-300x136.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></a></p>
<p>What is left now is to start the hosted network. The command to start/stop the hostednetwork is <em>“netsh wlan start|stop hostednetwork”</em> and it needs to be run as adminstrator. Since you will have to start/stop the hostednetwork every time you start/stop your computer, I would advice you to create desktop shortcuts for there commands and set them to run as administrator.</p>
<p><a href="https://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_4.png"><img class="aligncenter size-full wp-image-83" title="netsh wlan start|stop hostednetwork" src="https://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_4.png" alt="" width="787" height="545" srcset="http://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_4.png 787w, http://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_4-300x207.png 300w" sizes="(max-width: 787px) 100vw, 787px" /></a></p>
<p>It seems some drivers do face some problems with these commands and may need windows to restart to function correctly again. Enjoy. Here are some screenshots for hostednetwork without ICS or bridging and no clients connected.</p>
<p><a href="https://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_5.png"><img class="aligncenter size-full wp-image-84" title="Currently connected to..." src="https://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_5.png" alt="" width="294" height="437" srcset="http://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_5.png 294w, http://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_5-201x300.png 201w" sizes="(max-width: 294px) 100vw, 294px" /></a></p>
<p><a href="https://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_6.png"><img class="aligncenter size-full wp-image-85" title="Network and Sharing Center" src="https://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_6.png" alt="" width="670" height="393" srcset="http://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_6.png 670w, http://www.ishanarora.com/wp-content/uploads/2009/07/vwifi_6-300x175.png 300w" sizes="(max-width: 670px) 100vw, 670px" /></a></p>
<p><em>UPDATE (21 March 2010): If you prefer using a GUI then try <a href="http://www.connectify.me/" target="_blank">Connectify</a>.</em></p>
			</div><!-- .entry-content -->

	<footer class="entry-meta">
		<a class="entry-date" href="https://www.ishanarora.com/2009/07/29/windows-7-as-a-wireless-access-point/">July 29, 2009</a> in <a href="https://www.ishanarora.com/category/tech/" rel="category tag">Technology</a>. Tags: <a href="https://www.ishanarora.com/tag/hosted-network/" rel="tag">Hosted Network</a>, <a href="https://www.ishanarora.com/tag/hostednetwork/" rel="tag">hostednetwork</a>, <a href="https://www.ishanarora.com/tag/netsh/" rel="tag">netsh</a>, <a href="https://www.ishanarora.com/tag/netsh-wlan/" rel="tag">netsh wlan</a>, <a href="https://www.ishanarora.com/tag/softap/" rel="tag">SoftAP</a>, <a href="https://www.ishanarora.com/tag/software-wireless-access-point/" rel="tag">Software Wireless Access Point</a>, <a href="https://www.ishanarora.com/tag/virtual-wifi/" rel="tag">Virtual Wifi</a>, <a href="https://www.ishanarora.com/tag/vwifi/" rel="tag">VWifi</a>, <a href="https://www.ishanarora.com/tag/windows-7/" rel="tag">Windows 7</a>	</footer><!-- .entry-meta -->
</article><!-- #post-## -->
			
				<nav role="navigation" id="nav-below" class="navigation-post">
		<h1 class="screen-reader-text">Post navigation</h1>

	
		
	
	</nav><!-- #nav-below -->
	
			