
<!DOCTYPE html>







<html data-bs-theme="auto" lang="en">
    <head>
        
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>
            
                RFC 1829 - The ESP DES-CBC Transform
            
        </title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://static.ietf.org/fonts/inter/import.css" rel="stylesheet">
        <link href="https://static.ietf.org/fonts/noto-sans-mono/import.css" rel="stylesheet">
        
            <link rel="stylesheet" href="https://static.ietf.org/dt/12.40.0/ietf/css/document_html_referenced.css">
            
            <script type="module" crossorigin="" src="https://static.ietf.org/dt/12.40.0/assets/embedded-2913faa2.js"></script>
<link href="https://static.ietf.org/dt/12.40.0/assets/create-pinia-singleton-11b3ca5c.js" type="text/javascript" crossorigin="anonymous" rel="modulepreload" as="script" />
<link href="https://static.ietf.org/dt/12.40.0/assets/Scrollbar-50c4ab08.js" type="text/javascript" crossorigin="anonymous" rel="modulepreload" as="script" />
            <script src="https://static.ietf.org/dt/12.40.0/ietf/js/document_html.js"></script>
            <script src="https://static.ietf.org/dt/12.40.0/ietf/js/theme.js"></script>
        
        <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/rfc1829/">
        <meta name="description"
            
                content="The ESP DES-CBC Transform (RFC 1829, )"
            >
        

<link rel="apple-touch-icon"
      sizes="180x180"
      href="https://static.ietf.org/dt/12.40.0/ietf/images/ietf-logo-nor-180.png">
<link rel="icon"
      sizes="32x32"
      href="https://static.ietf.org/dt/12.40.0/ietf/images/ietf-logo-nor-32.png">
<link rel="icon"
      sizes="16x16"
      href="https://static.ietf.org/dt/12.40.0/ietf/images/ietf-logo-nor-16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon"
      href="https://static.ietf.org/dt/12.40.0/ietf/images/ietf-logo-nor-mask.svg"
      color="#ffffff">
<meta name="msapplication-TileColor"
      content="#ffffff">
<meta name="theme-color"
      content="#ffffff">
        




<meta property="og:title" content="RFC 1829: The ESP DES-CBC Transform">
<meta property="og:url" content="https://datatracker.ietf.org/doc/html/rfc1829">
<link rel="canonical" href="https://datatracker.ietf.org/doc/html/rfc1829">
<meta property="og:site_name" content="IETF Datatracker">
<meta property="og:description" content="This document describes the DES-CBC security transform for the IP Encapsulating Security Payload (ESP). [STANDARDS-TRACK]">
<meta property="og:type" content="article">

<meta property="og:image" content="https://static.ietf.org/dt/12.40.0/ietf/images/ietf-logo-card.png">
<meta property="og:image:alt" content="Logo of the IETF">
<meta property="article:section" content="IETF - Internet Engineering Task Force">
<meta property="og:image:type" content="image/png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta name="twitter:card" content="summary_large_image">

<meta property="article:author" content="Phil R. Karn">
<meta property="article:author" content="William A. Simpson">
<meta property="article:author" content="Perry E. Metzger">



        
        <style>
            
            .diff-form .select2-selection__rendered {
                direction: rtl;
                text-align: left;
            }
        </style>
    </head>
    <body>
        
        <noscript><iframe class="status" title="Site status" src="/status/latest"></iframe></noscript>
<div class="vue-embed" data-component="Status"></div>
        <div class="btn-toolbar sidebar-toolbar position-fixed top-0 end-0 m-2 m-lg-3 d-print-none">
            <div class="dropdown">
                <button class="btn btn-outline-secondary btn-sm me-1 dropdown-toggle d-flex align-items-center"
                    id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown"
                    aria-label="Toggle theme">
                        <i class="theme-icon-active bi bi-circle-half"></i>
                </button>

                <ul class="dropdown-menu" aria-labelledby="bd-theme">
                    <li>
                        <button type="button" class="dropdown-item d-flex align-items-center"
                            data-bs-theme-value="light" aria-pressed="false">
                            <i class="me-2 opacity-50 theme-icon bi bi-sun-fill"></i>
                            Light<i class="bi bi-check2 ms-auto d-none"></i>
                        </button>
                    </li>
                    <li>
                        <button type="button" class="dropdown-item d-flex align-items-center"
                            data-bs-theme-value="dark" aria-pressed="false">
                            <i class="me-2 opacity-50 theme-icon bi bi-moon-stars-fill"></i>
                            Dark<i class="bi bi-check2 ms-auto d-none"></i>
                        </button>
                    </li>
                    <li>
                        <button type="button" class="dropdown-item d-flex align-items-center active"
                            data-bs-theme-value="auto" aria-pressed="true">
                            <i class="me-2 opacity-50 theme-icon bi bi-circle-half"></i>
                            Auto<i class="bi bi-check2 ms-auto d-none"></i>
                        </button>
                    </li>
                </ul>
            </div>
            <button class="btn btn-outline-secondary btn-sm sidebar-toggle"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#sidebar"
                    aria-expanded="true"
                    aria-controls="sidebar"
                    aria-label="Toggle metadata sidebar"
                    title="Toggle metadata sidebar">
            <i class="bi bi-arrow-bar-left sidebar-shown"></i>
            <i class="bi bi-arrow-bar-right sidebar-collapsed"></i>
            </button>
        </div>
        <nav class="navbar bg-light-subtle px-1 fixed-top d-print-none d-md-none">
            <a class="nav-link ps-1"
               href="/doc/rfc1829/">
                
                    RFC 1829
                
                <br class="d-sm-none">

                <span class="ms-sm-3 badge rounded-pill badge-ps">
                    
                        Proposed Standard
                    
                </span>
            </a>
            <button class="navbar-toggler p-1"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#docinfo-collapse"
                    aria-controls="docinfo-collapse"
                    aria-expanded="false"
                    aria-label="Show document information">
                <span class="navbar-toggler-icon small"></span>
            </button>
            <div class="navbar-nav navbar-nav-scroll overscroll-none collapse pt-1" id="docinfo-collapse">
                <div class="bg-light-subtle p-0">
                    <table class="table table-sm table-borderless small">
                        <tbody class="meta align-top">
                            <tr>
                                <th scope="row"></th>
                                <th scope="row">Title</th>
                                <td class="edit"></td>
                                <td>The ESP DES-CBC Transform</td>
                            </tr>
                        </tbody>
                        







<tbody class="meta align-top ">
    <tr>
        <th scope="row">Document</th>
        <th scope="row">Document type</th>
        <td class="edit"></td>
        <td>
            





<span class="text-success">RFC
    
    - Proposed Standard
    
</span>

            
                
                    <br>August 1995
                
                <br>
                
                
                    <a class="btn btn-sm btn-warning"
                       title="Click to report an error in the document."
                       href="https://www.rfc-editor.org/errata.php#reportnew"
                       target="_blank">
                        Report errata
                    </a>
                
                
                
                
                
                
                
                
                
                    <div>
                        Was
                        <a href="/doc/draft-ietf-ipsec-esp-des-cbc/03/">draft-ietf-ipsec-esp-des-cbc</a>
                        (<a href="/wg/ipsec/about/">ipsec WG</a>)
                    </div>
                
            
            
            
                




    


            
        </td>
    </tr>
    
        <tr>
            <td></td>
            <th scope="row">Select version</th>
            <td class="edit"></td>
            <td>
                



    <ul class="revision-list pagination pagination-sm text-center flex-wrap my-0">
        
            
            
                
                    <li class="page-item">
                        <a class="page-link"
                        href="/doc/html/draft-ietf-ipsec-esp-des-cbc-03"
                        rel="nofollow">
                            03
                        </a>
                    </li>
                
            
            
            <li class="page-item rfc active">
                <a class="page-link"
                href="/doc/html/rfc1829">
                    RFC 1829
                </a>
            </li>
        
    </ul>

            </td>
        </tr>
        
            <tr>
                <td></td>
                <th scope="row">Compare versions</th>
                <td class="edit"></td>
                <td>
                    



<form class="form-horizontal diff-form"
      action="https://author-tools.ietf.org/iddiff"
      method="get"
      target="_blank">

            <select class="form-select form-select-sm mb-1 select2-field"
                    data-max-entries="1"
                    data-width="resolve"
                    data-allow-clear="false"
                    data-minimum-input-length="0"
                    aria-label="From revision"
                    name="url1">
                
                    <option value="rfc1829">
                        RFC 1829
                        
                    </option>
                
                    <option value="draft-ietf-ipsec-esp-des-cbc-03" selected>
                        draft-ietf-ipsec-esp-des-cbc-03
                        
                    </option>
                
                    <option value="draft-ietf-ipsec-esp-des-cbc-00">
                        draft-ietf-ipsec-esp-des-cbc-00
                        
                    </option>
                
                
            </select>

            <select class="form-select form-select-sm mb-1 select2-field"
                    data-max-entries="1"
                    data-width="resolve"
                    data-allow-clear="false"
                    data-minimum-input-length="0"
                    aria-label="To revision"
                    name="url2">
                
                    <option value="rfc1829" selected>
                        RFC 1829
                        
                    </option>
                
                    <option value="draft-ietf-ipsec-esp-des-cbc-03">
                        draft-ietf-ipsec-esp-des-cbc-03
                        
                    </option>
                
                    <option value="draft-ietf-ipsec-esp-des-cbc-00">
                        draft-ietf-ipsec-esp-des-cbc-00
                        
                    </option>
                
                
            </select>

            <button type="submit"
                    class="btn btn-primary btn-sm"
                    value="--html"
                    name="difftype">
                Side-by-side
            </button>
            
            <button type="submit"
                    class="btn btn-primary btn-sm"
                    value="--hwdiff"
                    name="difftype">
                Inline
            </button>

</form>
                </td>
            </tr>
        
    
    <tr>
        <td></td>
        <th scope="row">Authors</th>
        <td class="edit">
            
        </td>
        <td>
            
            
                <span ><a 
           title="Datatracker profile of Phil R. Karn"
            href="/person/karn@qualcomm.com" >Phil R. Karn</a> <a 
               href="mailto:karn%40qualcomm.com"
               aria-label="Compose email to karn@qualcomm.com"
               title="Compose email to karn@qualcomm.com">
                <i class="bi bi-envelope"></i></a></span>,
            
                <span ><a 
           title="Datatracker profile of William A. Simpson"
            href="/person/wsimpson@umich.edu" >William A. Simpson</a> <a 
               href="mailto:wsimpson%40umich.edu"
               aria-label="Compose email to wsimpson@umich.edu"
               title="Compose email to wsimpson@umich.edu">
                <i class="bi bi-envelope"></i></a></span>,
            
                <span ><a 
           title="Datatracker profile of Perry E. Metzger"
            href="/person/perry@piermont.com" >Perry E. Metzger</a> <a 
               href="mailto:perry%40piermont.com"
               aria-label="Compose email to perry@piermont.com"
               title="Compose email to perry@piermont.com">
                <i class="bi bi-envelope"></i></a></span>
            
            
                <br>
                <a class="btn btn-primary btn-sm mt-1" href="mailto:rfc1829@ietf.org?subject=rfc1829" title="Send email to the document authors">Email authors</a>
            
        </td>
    </tr>
    
    
    <tr>
        <td></td>
        <th scope="row">
            RFC stream
        </th>
        <td class="edit">
            
        </td>
        <td >
            
                
                
                    
                        



<img alt="IETF Logo"
     class="d-lm-none w-25 mt-1"
     
     
        
             src="https://static.ietf.org/dt/12.40.0/ietf/images/ietf-logo-nor-white.svg"
        
     
     >

<img alt="IETF Logo"
     class="d-dm-none w-25 mt-1"
     
     
        
             src="https://static.ietf.org/dt/12.40.0/ietf/images/ietf-logo-nor.svg"
        
     
     >
                    
                
                
            
        </td>
    </tr>
    
    <tr>
        <td></td>
        <th scope="row">
            Other formats
        </th>
        <td class="edit">
        </td>
        <td>
            
                
    <div class="buttonlist">
    
        
        <a class="btn btn-primary btn-sm"
          
          target="_blank"
          href="https://www.rfc-editor.org/rfc/rfc1829.txt">
            
                <i class="bi bi-file-text"></i> txt
            
        </a>
        
    
        
        <a class="btn btn-primary btn-sm"
          
          target="_blank"
          href="https://www.rfc-editor.org/rfc/rfc1829.html">
            
                <i class="bi bi-file-code"></i> html
            
        </a>
        
    
        
        <a class="btn btn-primary btn-sm"
          
            download="rfc1829.pdf"
          
         
          target="_blank"
          href="https://www.rfc-editor.org/rfc/pdfrfc/rfc1829.txt.pdf">
            
                <i class="bi bi-file-pdf"></i> pdf
            
        </a>
        
    
        
    
        
        <a class="btn btn-primary btn-sm"
          
          target="_blank"
          href="/doc/rfc1829/bibtex/">
            
                <i class="bi bi-file-ruled"></i> bibtex
            
        </a>
        
    
</div>

            
        </td>
    </tr>
    
    
        
            <tr>
                <td>
                </td>
                <th scope="row">
                    Additional resources
                </th>
                <td class="edit">
                    
                </td>
                <td>
                    
                        
                        
                            
                                <a href="https://mailarchive.ietf.org/arch/browse/ipsec?q=rfc1829 OR %22draft-ietf-ipsec-esp-des-cbc%22">
                                    Mailing list discussion
                                </a>
                            
                        
                    
                </td>
            </tr>
        
    
</tbody>
                        <tr>
                            <th scope="row"></th>
                            <th scope="row"></th>
                            <td class="edit"></td>
                            <td>
                                <a class="btn btn-sm btn-warning mb-3"
                                target="_blank"
                                href="https://github.com/ietf-tools/datatracker/issues/new/choose">
                                    Report a bug
                                    <i class="bi bi-bug"></i>
                                </a>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </nav>
        <div class="row g-0">
            <div class="col-md-9 d-flex justify-content-center lh-sm"
                 data-bs-spy="scroll"
                 data-bs-target="#toc-nav"
                 data-bs-smooth-scroll="true"
                 tabindex="0"
                 id="content">
                
                    <div class="rfcmarkup">
                        <br class="noprint">
                        <!-- [html-validate-disable-block attr-quotes, void-style, element-permitted-content, heading-level -- FIXME: rfcmarkup/rfc2html generates HTML with issues] -->
                        <div class="rfcmarkup"><pre>Network Working Group                                            P. Karn
Request for Comments: 1829                                      Qualcomm
Category: Standards Track                                     P. Metzger
                                                                Piermont
                                                              W. Simpson
                                                              Daydreamer
                                                             August 1995


                       <span class="h1">The ESP DES-CBC Transform</span>



Status of this Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the &quot;Internet
   Official Protocol Standards&quot; (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.


Abstract

   This document describes the DES-CBC security transform for the IP
   Encapsulating Security Payload (ESP).


Table of Contents

     <a href="#section-1">1</a>.     Introduction ..........................................    <a href="#page-1">1</a>
        <a href="#section-1.1">1.1</a>       Keys ............................................    <a href="#page-1">1</a>
        <a href="#section-1.2">1.2</a>       Initialization Vector ...........................    <a href="#page-1">1</a>
        <a href="#section-1.3">1.3</a>       Data Size .......................................    <a href="#page-2">2</a>
        <a href="#section-1.4">1.4</a>       Performance .....................................    <a href="#page-2">2</a>

     <a href="#section-2">2</a>.     Payload Format ........................................    <a href="#page-3">3</a>

     <a href="#section-3">3</a>.     Algorithm .............................................    <a href="#page-5">5</a>
        <a href="#section-3.1">3.1</a>       Encryption ......................................    <a href="#page-5">5</a>
        <a href="#section-3.2">3.2</a>       Decryption ......................................    <a href="#page-5">5</a>

     SECURITY CONSIDERATIONS ......................................    <a href="#page-6">6</a>
     ACKNOWLEDGEMENTS .............................................    <a href="#page-7">7</a>
     REFERENCES ...................................................    <a href="#page-8">8</a>
     AUTHOR&#x27;S ADDRESS .............................................   <a href="#page-10">10</a>





<span class="grey">Karn, Metzger &amp; Simpson     Standards Track                     [Page i]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-1" ></span>
<span class="grey"><a href="/doc/html/rfc1829">RFC 1829</a>                      ESP DES-CBC                    August 1995</span>


<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   The Encapsulating Security Payload (ESP) [<a href="/doc/html/rfc1827">RFC-1827</a>] provides
   confidentiality for IP datagrams by encrypting the payload data to be
   protected.  This specification describes the ESP use of the Cipher
   Block Chaining (CBC) mode of the US Data Encryption Standard (DES)
   algorithm [<a href="#ref-FIPS-46">FIPS-46</a>, <a href="#ref-FIPS-46-1">FIPS-46-1</a>, <a href="#ref-FIPS-74">FIPS-74</a>, <a href="#ref-FIPS-81">FIPS-81</a>].

   All implementations that claim conformance or compliance with the
   Encapsulating Security Payload specification MUST implement this
   DES-CBC transform.

   This document assumes that the reader is familiar with the related
   document &quot;Security Architecture for the Internet Protocol&quot;
   [<a href="/doc/html/rfc1825">RFC-1825</a>], which defines the overall security plan for IP, and
   provides important background for this specification.



<span class="h3"><a class="selflink" id="section-1.1" href="#section-1.1">1.1</a>.  Keys</span>

   The secret DES key shared between the communicating parties is eight
   octets in length.  This key consists of a 56-bit quantity used by the
   DES algorithm.  The 56-bit key is stored as a 64-bit (eight octet)
   quantity, with the least significant bit of each octet used as a
   parity bit.



<span class="h3"><a class="selflink" id="section-1.2" href="#section-1.2">1.2</a>.  Initialization Vector</span>

   This mode of DES requires an Initialization Vector (IV) that is eight
   octets in length.

   Each datagram contains its own IV.  Including the IV in each datagram
   ensures that decryption of each received datagram can be performed,
   even when other datagrams are dropped, or datagrams are re-ordered in
   transit.

   The method for selection of IV values is implementation dependent.

   Notes:
      A common acceptable technique is simply a counter, beginning with
      a randomly chosen value.  While this provides an easy method for
      preventing repetition, and is sufficiently robust for practical
      use, cryptanalysis may use the rare serendipitous occurrence when
      a corresponding bit position in the first DES block increments in
      exactly the same fashion.


<span class="grey">Karn, Metzger &amp; Simpson     Standards Track                     [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey"><a href="/doc/html/rfc1829">RFC 1829</a>                      ESP DES-CBC                    August 1995</span>


      Other implementations exhibit unpredictability, usually through a
      pseudo-random number generator.  Care should be taken that the
      periodicity of the number generator is long enough to prevent
      repetition during the lifetime of the session key.



<span class="h3"><a class="selflink" id="section-1.3" href="#section-1.3">1.3</a>.  Data Size</span>

   The DES algorithm operates on blocks of eight octets.  This often
   requires padding after the end of the unencrypted payload data.

   Both input and output result in the same number of octets, which
   facilitates in-place encryption and decryption.

   On receipt, if the length of the data to be decrypted is not an
   integral multiple of eight octets, then an error is indicated, as
   described in [<a href="/doc/html/rfc1825">RFC-1825</a>].



<span class="h3"><a class="selflink" id="section-1.4" href="#section-1.4">1.4</a>.  Performance</span>

   At the time of writing, at least one hardware implementation can
   encrypt or decrypt at about 1 Gbps [Schneier94, p. 231].

























<span class="grey">Karn, Metzger &amp; Simpson     Standards Track                     [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey"><a href="/doc/html/rfc1829">RFC 1829</a>                      ESP DES-CBC                    August 1995</span>


<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  Payload Format</span>


   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Security Parameters Index (SPI)                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                   Initialization Vector (IV)                  ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                          Payload Data                         ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
             ... Padding           |  Pad Length   | Payload Type  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   Security Parameters Index (SPI)

      A 32-bit value identifying the Security Parameters for this
      datagram.  The value MUST NOT be zero.

   Initialization Vector (IV)

      The size of this field is variable, although it is constant for
      all DES-CBC datagrams of the same SPI and IP Destination.  Octets
      are sent in network order (most significant octet first)
      [<a href="/doc/html/rfc1700">RFC-1700</a>].

      The size MUST be a multiple of 32-bits.  Sizes of 32 and 64 bits
      are required to be supported.  The use of other sizes is beyond
      the scope of this specification.  The size is expected to be
      indicated by the key management mechanism.

      When the size is 32-bits, a 64-bit IV is formed from the 32-bit
      value followed by (concatenated with) the bit-wise complement of
      the 32-bit value.  This field size is most common, as it aligns
      the Payload Data for both 32-bit and 64-bit processing.

      All conformant implementations MUST also correctly process a
      64-bit field size.  This provides strict compatibility with
      existing hardware implementations.

         It is the intent that the value not repeat during the lifetime
         of the encryption session key.  Even when a full 64-bit IV is
         used, the session key SHOULD be changed at least as frequently
         as 2**32 datagrams.


<span class="grey">Karn, Metzger &amp; Simpson     Standards Track                     [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey"><a href="/doc/html/rfc1829">RFC 1829</a>                      ESP DES-CBC                    August 1995</span>


   Payload Data

      The size of this field is variable.

      Prior to encryption and after decryption, this field begins with
      the IP Protocol/Payload header specified in the Payload Type
      field.  Note that in the case of IP-in-IP encapsulation (Payload
      Type 4), this will be another IP header.

   Padding

      The size of this field is variable.

      Prior to encryption, it is filled with unspecified implementation
      dependent (preferably random) values, to align the Pad Length and
      Payload Type fields at an eight octet boundary.

      After decryption, it MUST be ignored.

   Pad Length

      This field indicates the size of the Padding field.  It does not
      include the Pad Length and Payload Type fields.  The value
      typically ranges from 0 to 7, but may be up to 255 to permit
      hiding of the actual data length.

      This field is opaque.  That is, the value is set prior to
      encryption, and is examined only after decryption.

   Payload Type

      This field indicates the contents of the Payload Data field, using
      the IP Protocol/Payload value.  Up-to-date values of the IP
      Protocol/Payload are specified in the most recent &quot;Assigned
      Numbers&quot; [<a href="/doc/html/rfc1700">RFC-1700</a>].

      This field is opaque.  That is, the value is set prior to
      encryption, and is examined only after decryption.

         For example, when encrypting an entire IP datagram (Tunnel-
         Mode), this field will contain the value 4, which indicates
         IP-in-IP encapsulation.








<span class="grey">Karn, Metzger &amp; Simpson     Standards Track                     [Page 4]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-5" ></span>
<span class="grey"><a href="/doc/html/rfc1829">RFC 1829</a>                      ESP DES-CBC                    August 1995</span>


<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  Algorithm</span>

   In DES-CBC, the base DES encryption function is applied to the XOR of
   each plaintext block with the previous ciphertext block to yield the
   ciphertext for the current block.  This provides for
   re-synchronization when datagrams are lost.

   For more explanation and implementation information for DES, see
   [<a href="#ref-Schneier94">Schneier94</a>].



<span class="h3"><a class="selflink" id="section-3.1" href="#section-3.1">3.1</a>.  Encryption</span>

   Append zero or more octets of (preferably random) padding to the
   plaintext, to make its modulo 8 length equal to 6.  For example, if
   the plaintext length is 41, 5 octets of padding are added.

   Append a Pad Length octet containing the number of padding octets
   just added.

   Append a Payload Type octet containing the IP Protocol/Payload value
   which identifies the protocol header that begins the payload.

   Provide an Initialization Vector (IV) of the size indicated by the
   SPI.

   Encrypt the payload with DES in CBC mode, producing a ciphertext of
   the same length.

   Octets are mapped to DES blocks in network order (most significant
   octet first) [<a href="/doc/html/rfc1700">RFC-1700</a>].  Octet 0 (modulo 8) of the payload
   corresponds to bits 1-8 of the 64-bit DES input block, while octet 7
   (modulo 8) corresponds to bits 57-64 of the DES input block.

   Construct an appropriate IP datagram for the target Destination, with
   the indicated SPI, IV, and payload.

   The Total/Payload Length in the encapsulating IP Header reflects the
   length of the encrypted data, plus the SPI, IV, padding, Pad Length,
   and Payload Type octets.



<span class="h3"><a class="selflink" id="section-3.2" href="#section-3.2">3.2</a>.  Decryption</span>

   First, the SPI field is removed and examined.  This is used as an
   index into the local Security Parameter table to find the negotiated


<span class="grey">Karn, Metzger &amp; Simpson     Standards Track                     [Page 5]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-6" ></span>
<span class="grey"><a href="/doc/html/rfc1829">RFC 1829</a>                      ESP DES-CBC                    August 1995</span>


   parameters and decryption key.

   The negotiated form of the IV determines the size of the IV field.
   These octets are removed, and an appropriate 64-bit IV value is
   constructed.

   The encrypted part of the payload is decrypted using DES in the CBC
   mode.

   The Payload Type is removed and examined.  If it is unrecognized, the
   payload is discarded with an appropriate ICMP message.

   The Pad Length is removed and examined.  The specified number of pad
   octets are removed from the end of the decrypted payload, and the IP
   Total/Payload Length is adjusted accordingly.

   The IP Header(s) and the remaining portion of the decrypted payload
   are passed to the protocol receive routine specified by the Payload
   Type field.



Security Considerations

   Users need to understand that the quality of the security provided by
   this specification depends completely on the strength of the DES
   algorithm, the correctness of that algorithm&#x27;s implementation, the
   security of the key management mechanism and its implementation, the
   strength of the key [<a href="#ref-CN94">CN94</a>], and upon the correctness of the
   implementations in all of the participating nodes.

   Among other considerations, applications may wish to take care not to
   select weak keys, although the odds of picking one at random are low
   [Schneier94, p 233].

   The cut and paste attack described by [<a href="#ref-Bell95">Bell95</a>] exploits the nature of
   all Cipher Block Chaining algorithms.  When a block is damaged in
   transmission, on decryption both it and the following block will be
   garbled by the decryption process, but all subsequent blocks will be
   decrypted correctly.  If an attacker has legitimate access to the
   same key, this feature can be used to insert or replay previously
   encrypted data of other users of the same engine, revealing the
   plaintext.  The usual (ICMP, TCP, UDP) transport checksum can detect
   this attack, but on its own is not considered cryptographically
   strong.  In this situation, user or connection oriented integrity
   checking is needed [<a href="/doc/html/rfc1826">RFC-1826</a>].

   At the time of writing of this document, [<a href="#ref-BS93">BS93</a>] demonstrated a


<span class="grey">Karn, Metzger &amp; Simpson     Standards Track                     [Page 6]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-7" ></span>
<span class="grey"><a href="/doc/html/rfc1829">RFC 1829</a>                      ESP DES-CBC                    August 1995</span>


   differential cryptanalysis based chosen-plaintext attack requiring
   2^47 plaintext-ciphertext pairs, and [<a href="#ref-Matsui94">Matsui94</a>] demonstrated a linear
   cryptanalysis based known-plaintext attack requiring only 2^43
   plaintext-ciphertext pairs.  Although these attacks are not
   considered practical, they must be taken into account.

   More disturbingly, [<a href="#ref-Weiner94">Weiner94</a>] has shown the design of a DES cracking
   machine costing $1 Million that can crack one key every 3.5 hours.
   This is an extremely practical attack.

   One or two blocks of known plaintext suffice to recover a DES key.
   Because IP datagrams typically begin with a block of known and/or
   guessable header text, frequent key changes will not protect against
   this attack.

   It is suggested that DES is not a good encryption algorithm for the
   protection of even moderate value information in the face of such
   equipment.  Triple DES is probably a better choice for such purposes.

   However, despite these potential risks, the level of privacy provided
   by use of ESP DES-CBC in the Internet environment is far greater than
   sending the datagram as cleartext.



Acknowledgements

   This document was reviewed by the IP Security Working Group of the
   Internet Engineering Task Force (IETF).  Comments should be submitted
   to the ipsec@ans.net mailing list.

   Some of the text of this specification was derived from work by
   Randall Atkinson for the SIP, SIPP, and IPv6 Working Groups.

   The use of DES for confidentiality is closely modeled on the work
   done for SNMPv2 [<a href="/doc/html/rfc1446">RFC-1446</a>].

   Steve Bellovin, Steve Deering, Karl Fox, Charles Lynn, Craig Metz,
   Dave Mihelcic and Jeffrey Schiller provided useful critiques of
   earlier versions of this draft.










<span class="grey">Karn, Metzger &amp; Simpson     Standards Track                     [Page 7]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-8" ></span>
<span class="grey"><a href="/doc/html/rfc1829">RFC 1829</a>                      ESP DES-CBC                    August 1995</span>


References

   [<a id="ref-Bell95">Bell95</a>]  Bellovin, S., &quot;An Issue With DES-CBC When Used Without
            Strong Integrity&quot;, Proceedings of the 32nd IETF, Danvers,
            MA, April 1995.

   [<a id="ref-BS93">BS93</a>]   Biham, E., and Shamir, A., &quot;Differential Cryptanalysis of
            the Data Encryption Standard&quot;, Berlin: Springer-Verlag,
            1993.

   [<a id="ref-CN94">CN94</a>]   Carroll, J.M., and Nudiati, S., &quot;On Weak Keys and Weak Data:
            Foiling the Two Nemeses&quot;, Cryptologia, Vol. 18 No. 23 pp.
            253-280, July 1994.

   [<a id="ref-FIPS-46">FIPS-46</a>]
            US National Bureau of Standards, &quot;Data Encryption Standard&quot;,
            Federal Information Processing Standard (FIPS) Publication
            46, January 1977.

   [<a id="ref-FIPS-46-1">FIPS-46-1</a>]
            US National Bureau of Standards, &quot;Data Encryption Standard&quot;,
            Federal Information Processing Standard (FIPS) Publication
            46-1, January 1988.

   [<a id="ref-FIPS-74">FIPS-74</a>]
            US National Bureau of Standards, &quot;Guidelines for
            Implementing and Using the Data Encryption Standard&quot;,
            Federal Information Processing Standard (FIPS) Publication
            74, April 1981.

   [<a id="ref-FIPS-81">FIPS-81</a>]
            US National Bureau of Standards, &quot;DES Modes of Operation&quot;
            Federal Information Processing Standard (FIPS) Publication
            81, December 1980.

   [<a id="ref-Matsui94">Matsui94</a>]
            Matsui, M., &quot;Linear Cryptanalysis method dor DES Cipher,&quot;
            Advances in Cryptology -- Eurocrypt &#x27;93 Proceedings, Berlin:
            Springer-Verlag, 1994.

   [<a id="ref-RFC-1446">RFC-1446</a>]
            Galvin, J., and McCloghrie, K., &quot;Security Protocols for
            Version 2 of the Simple Network Management Protocol
            (SNMPv2)&quot;, <a href="/doc/html/rfc1446">RFC-1446</a>, DDN Network Information Center, April
            1993.

   [<a id="ref-RFC-1700">RFC-1700</a>]
            Reynolds, J., and Postel, J., &quot;Assigned Numbers&quot;, STD 2,

<span class="grey">Karn, Metzger &amp; Simpson     Standards Track                     [Page 8]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-9" ></span>
<span class="grey"><a href="/doc/html/rfc1829">RFC 1829</a>                      ESP DES-CBC                    August 1995</span>


            <a href="/doc/html/rfc1700">RFC-1700</a>, USC/Information Sciences Institute, October 1994.

   [<a id="ref-RFC-1800">RFC-1800</a>]
            Postel, J., &quot;Internet Official Protocol Standards&quot;, STD 1,
            <a href="/doc/html/rfc1800">RFC-1800</a>, USC/Information Sciences Institute, July 1995.

   [<a id="ref-RFC-1825">RFC-1825</a>]
            Atkinson, R., &quot;Security Architecture for the Internet
            Protocol&quot;, <a href="/doc/html/rfc1825">RFC-1825</a>, Naval Research Laboratory, July 1995.

   [<a id="ref-RFC-1826">RFC-1826</a>]
            Atkinson, R., &quot;IP Authentication Header&quot;, <a href="/doc/html/rfc1826">RFC-1826</a>, Naval
            Research Laboratory, July 1995.

   [<a id="ref-RFC-1827">RFC-1827</a>]
            Atkinson, R., &quot;IP Encapsulating Security Protocol (ESP)&quot;,
            <a href="/doc/html/rfc1827">RFC-1827</a>, Naval Research Laboratory, July 1995.

   [<a id="ref-Schneier94">Schneier94</a>]
            Schneier, B., &quot;Applied Cryptography&quot;, John Wiley &amp; Sons, New
            York, NY, 1994.  ISBN 0-471-59756-2

   [<a id="ref-Weiner94">Weiner94</a>]
            Wiener, M.J., &quot;Efficient DES Key Search&quot;, School of Computer
            Science, Carleton University, Ottawa, Canada, TR-244, May
            1994.  Presented at the Rump Session of Crypto &#x27;93.
























<span class="grey">Karn, Metzger &amp; Simpson     Standards Track                     [Page 9]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-10" ></span>
<span class="grey"><a href="/doc/html/rfc1829">RFC 1829</a>                      ESP DES-CBC                    August 1995</span>


Author&#x27;s Address

   Questions about this memo can also be directed to:

      Phil Karn
      Qualcomm, Inc.
      6455 Lusk Blvd.
      San Diego, California  92121-2779

      karn@unix.ka9q.ampr.org


      Perry Metzger
      Piermont Information Systems Inc.
      160 Cabrini Blvd., Suite #2
      New York, NY  10033

      perry@piermont.com


      William Allen Simpson
      Daydreamer
      Computer Systems Consulting Services
      1384 Fontaine
      Madison Heights, Michigan  48071

      Bill.Simpson@um.cc.umich.edu
          bsimpson@MorningStar.com






















Karn, Metzger &amp; Simpson     Standards Track                    [Page 10]
</pre></div>
                    </div>
                
            </div>
            <div class="d-print-none col-md-3 bg-light-subtle collapse show" id="sidebar">
                <div class="position-fixed border-start sidebar overflow-scroll overscroll-none no-scrollbar">
                    <div class="d-flex flex-column vh-100 pt-2 pt-lg-3 ps-3 pl-md-2 pl-lg-3">
                        <div>
                            <a class="btn btn-primary btn-sm" href="/doc/rfc1829/">Datatracker</a>
                            <p class="fw-bold pt-2">
                                
                                    RFC 1829
                                
                                <br>
                                





<span class="text-success">RFC
    
    - Proposed Standard
    
</span>

                            </p>
                        </div>
                        
                        <ul class="nav nav-tabs nav-fill small me-2" role="tablist">
                            <li class="nav-item" role="presentation" title="Document information">
                                <button class="nav-link px-2"
                                        id="docinfo-tab"
                                        data-bs-toggle="tab"
                                        data-bs-target="#docinfo-tab-pane"
                                        type="button"
                                        role="tab"
                                        aria-controls="docinfo-tab-pane"
                                        aria-selected="true">
                                    <i class="bi bi-info-circle"></i><span class="d-none d-md-block d-xl-inline ms-xl-1">Info</span>
                                </button>
                            </li>
                            <li class="nav-item" role="presentation" title="Table of contents">
                                <button class="nav-link px-2"
                                        id="toc-tab"
                                        data-bs-toggle="tab"
                                        data-bs-target="#toc-tab-pane"
                                        type="button"
                                        role="tab"
                                        aria-controls="toc-tab-pane"
                                        aria-selected="false">
                                    <i class="bi bi-list-ol"></i><span class="d-none d-md-block d-xl-inline ms-xl-1">Contents</span>
                                </button>
                            </li>
                            <li class="nav-item" role="presentation" title="Preferences">
                                <button class="nav-link px-2"
                                        id="pref-tab"
                                        data-bs-toggle="tab"
                                        data-bs-target="#pref-tab-pane"
                                        type="button"
                                        role="tab"
                                        aria-controls="pref-tab-pane"
                                        aria-selected="false">
                                    <i class="bi bi-gear"></i><span class="d-none d-md-block d-xl-inline ms-xl-1">Prefs</span>
                                </button>
                            </li>
                        </ul>
                        <div class="overflow-auto tab-content pt-2 me-2">
                            <div class="tab-pane"
                                 id="docinfo-tab-pane"
                                 role="tabpanel"
                                 aria-labelledby="docinfo-tab"
                                 tabindex="0">
                                <table class="table table-sm table-borderless">
                                    







<tbody class="meta align-top ">
    <tr>
        <th scope="row">Document</th>
        <th scope="row">Document type</th>
        <td class="edit"></td>
        <td>
            





<span class="text-success">RFC
    
    - Proposed Standard
    
</span>

            
                
                    <br>August 1995
                
                <br>
                
                
                    <a class="btn btn-sm btn-warning"
                       title="Click to report an error in the document."
                       href="https://www.rfc-editor.org/errata.php#reportnew"
                       target="_blank">
                        Report errata
                    </a>
                
                
                
                
                
                
                
                
                
                    <div>
                        Was
                        <a href="/doc/draft-ietf-ipsec-esp-des-cbc/03/">draft-ietf-ipsec-esp-des-cbc</a>
                        (<a href="/wg/ipsec/about/">ipsec WG</a>)
                    </div>
                
            
            
            
                




    


            
        </td>
    </tr>
    
        <tr>
            <td></td>
            <th scope="row">Select version</th>
            <td class="edit"></td>
            <td>
                



    <ul class="revision-list pagination pagination-sm text-center flex-wrap my-0">
        
            
            
                
                    <li class="page-item">
                        <a class="page-link"
                        href="/doc/html/draft-ietf-ipsec-esp-des-cbc-03"
                        rel="nofollow">
                            03
                        </a>
                    </li>
                
            
            
            <li class="page-item rfc active">
                <a class="page-link"
                href="/doc/html/rfc1829">
                    RFC 1829
                </a>
            </li>
        
    </ul>

            </td>
        </tr>
        
            <tr>
                <td></td>
                <th scope="row">Compare versions</th>
                <td class="edit"></td>
                <td>
                    



<form class="form-horizontal diff-form"
      action="https://author-tools.ietf.org/iddiff"
      method="get"
      target="_blank">

            <select class="form-select form-select-sm mb-1 select2-field"
                    data-max-entries="1"
                    data-width="resolve"
                    data-allow-clear="false"
                    data-minimum-input-length="0"
                    aria-label="From revision"
                    name="url1">
                
                    <option value="rfc1829">
                        RFC 1829
                        
                    </option>
                
                    <option value="draft-ietf-ipsec-esp-des-cbc-03" selected>
                        draft-ietf-ipsec-esp-des-cbc-03
                        
                    </option>
                
                    <option value="draft-ietf-ipsec-esp-des-cbc-00">
                        draft-ietf-ipsec-esp-des-cbc-00
                        
                    </option>
                
                
            </select>

            <select class="form-select form-select-sm mb-1 select2-field"
                    data-max-entries="1"
                    data-width="resolve"
                    data-allow-clear="false"
                    data-minimum-input-length="0"
                    aria-label="To revision"
                    name="url2">
                
                    <option value="rfc1829" selected>
                        RFC 1829
                        
                    </option>
                
                    <option value="draft-ietf-ipsec-esp-des-cbc-03">
                        draft-ietf-ipsec-esp-des-cbc-03
                        
                    </option>
                
                    <option value="draft-ietf-ipsec-esp-des-cbc-00">
                        draft-ietf-ipsec-esp-des-cbc-00
                        
                    </option>
                
                
            </select>

            <button type="submit"
                    class="btn btn-primary btn-sm"
                    value="--html"
                    name="difftype">
                Side-by-side
            </button>
            
            <button type="submit"
                    class="btn btn-primary btn-sm"
                    value="--hwdiff"
                    name="difftype">
                Inline
            </button>

</form>
                </td>
            </tr>
        
    
    <tr>
        <td></td>
        <th scope="row">Authors</th>
        <td class="edit">
            
        </td>
        <td>
            
            
                <span ><a 
           title="Datatracker profile of Phil R. Karn"
            href="/person/karn@qualcomm.com" >Phil R. Karn</a> <a 
               href="mailto:karn%40qualcomm.com"
               aria-label="Compose email to karn@qualcomm.com"
               title="Compose email to karn@qualcomm.com">
                <i class="bi bi-envelope"></i></a></span>,
            
                <span ><a 
           title="Datatracker profile of William A. Simpson"
            href="/person/wsimpson@umich.edu" >William A. Simpson</a> <a 
               href="mailto:wsimpson%40umich.edu"
               aria-label="Compose email to wsimpson@umich.edu"
               title="Compose email to wsimpson@umich.edu">
                <i class="bi bi-envelope"></i></a></span>,
            
                <span ><a 
           title="Datatracker profile of Perry E. Metzger"
            href="/person/perry@piermont.com" >Perry E. Metzger</a> <a 
               href="mailto:perry%40piermont.com"
               aria-label="Compose email to perry@piermont.com"
               title="Compose email to perry@piermont.com">
                <i class="bi bi-envelope"></i></a></span>
            
            
                <br>
                <a class="btn btn-primary btn-sm mt-1" href="mailto:rfc1829@ietf.org?subject=rfc1829" title="Send email to the document authors">Email authors</a>
            
        </td>
    </tr>
    
    
    <tr>
        <td></td>
        <th scope="row">
            RFC stream
        </th>
        <td class="edit">
            
        </td>
        <td >
            
                
                
                    
                        



<img alt="IETF Logo"
     class="d-lm-none w-25 mt-1"
     
     
        
             src="https://static.ietf.org/dt/12.40.0/ietf/images/ietf-logo-nor-white.svg"
        
     
     >

<img alt="IETF Logo"
     class="d-dm-none w-25 mt-1"
     
     
        
             src="https://static.ietf.org/dt/12.40.0/ietf/images/ietf-logo-nor.svg"
        
     
     >
                    
                
                
            
        </td>
    </tr>
    
    <tr>
        <td></td>
        <th scope="row">
            Other formats
        </th>
        <td class="edit">
        </td>
        <td>
            
                
    <div class="buttonlist">
    
        
        <a class="btn btn-primary btn-sm"
          
          target="_blank"
          href="https://www.rfc-editor.org/rfc/rfc1829.txt">
            
                <i class="bi bi-file-text"></i> txt
            
        </a>
        
    
        
        <a class="btn btn-primary btn-sm"
          
          target="_blank"
          href="https://www.rfc-editor.org/rfc/rfc1829.html">
            
                <i class="bi bi-file-code"></i> html
            
        </a>
        
    
        
        <a class="btn btn-primary btn-sm"
          
            download="rfc1829.pdf"
          
         
          target="_blank"
          href="https://www.rfc-editor.org/rfc/pdfrfc/rfc1829.txt.pdf">
            
                <i class="bi bi-file-pdf"></i> pdf
            
        </a>
        
    
        
    
        
        <a class="btn btn-primary btn-sm"
          
          target="_blank"
          href="/doc/rfc1829/bibtex/">
            
                <i class="bi bi-file-ruled"></i> bibtex
            
        </a>
        
    
</div>

            
        </td>
    </tr>
    
    
        
            <tr>
                <td>
                </td>
                <th scope="row">
                    Additional resources
                </th>
                <td class="edit">
                    
                </td>
                <td>
                    
                        
                        
                            
                                <a href="https://mailarchive.ietf.org/arch/browse/ipsec?q=rfc1829 OR %22draft-ietf-ipsec-esp-des-cbc%22">
                                    Mailing list discussion
                                </a>
                            
                        
                    
                </td>
            </tr>
        
    
</tbody>
                                </table>
                                <a class="btn btn-sm btn-warning mb-3"
                                target="_blank"
                                href="https://github.com/ietf-tools/datatracker/issues/new/choose">
                                    Report a datatracker bug
                                    <i class="bi bi-bug"></i>
                                </a>
                            </div>
                            <div class="tab-pane mb-5"
                                 id="toc-tab-pane"
                                 role="tabpanel"
                                 aria-labelledby="toc-tab"
                                 tabindex="0">
                                <nav class="nav nav-pills flex-column small" id="toc-nav">
                                </nav>
                            </div>
                            <div class="tab-pane mb-5 small"
                                 id="pref-tab-pane"
                                 role="tabpanel"
                                 aria-labelledby="pref-tab"
                                 tabindex="0">
                                <label class="form-label fw-bold mb-2">Show sidebar by default</label>
                                <div class="btn-group-vertical btn-group-sm d-flex" role="group">
                                    <input type="radio" class="btn-check" name="sidebar" id="on-radio">
                                    <label class="btn btn-outline-primary" for="on-radio">Yes</label>
                                    <input type="radio" class="btn-check" name="sidebar" id="off-radio">
                                    <label class="btn btn-outline-primary" for="off-radio">No</label>
                                </div>
                                <label class="form-label fw-bold mt-4 mb-2">Tab to show by default</label>
                                <div class="btn-group-vertical btn-group-sm d-flex" role="group">
                                    <input type="radio" class="btn-check" name="deftab" id="docinfo-radio">
                                    <label class="btn btn-outline-primary" for="docinfo-radio">
                                        <i class="bi bi-info-circle me-1"></i>Info
                                    </label>
                                    <input type="radio" class="btn-check" name="deftab" id="toc-radio">
                                    <label class="btn btn-outline-primary" for="toc-radio">
                                        <i class="bi bi-list-ol me-1"></i>Contents
                                    </label>
                                </div>
                                <label class="form-label fw-bold mt-4 mb-2">HTMLization configuration</label>
                                <div class="btn-group-vertical btn-group-sm d-flex" role="group">
                                    <input type="radio" class="btn-check" name="htmlconf" id="txt-radio">
                                    <label class="btn btn-outline-primary" for="txt-radio" title="This is the traditional HTMLization method.">
                                        <i class="bi bi-badge-sd me-1"></i>HTMLize the plaintext
                                    </label>
                                    <input type="radio" class="btn-check" name="htmlconf" id="html-radio">
                                    <label class="btn btn-outline-primary" for="html-radio" title="This is the modern HTMLization method.">
                                        <i class="bi bi-badge-hd me-1"></i>Plaintextify the HTML
                                    </label>
                                </div>
                                <label class="form-label fw-bold mt-4 mb-2" for="ptsize">Maximum font size</label>
                                <input type="range" class="form-range" min="7" max="16" id="ptsize" oninput="ptdemo.value = ptsize.value">
                                <label class="form-label fw-bold mt-4 mb-2">Page dependencies</label>
                                <div class="btn-group-vertical btn-group-sm d-flex" role="group">
                                    <input type="radio" class="btn-check" name="pagedeps" id="inline-radio">
                                    <label class="btn btn-outline-primary" for="inline-radio" title="Generate larger, standalone web pages that do not require network access to render.">
                                        <i class="bi bi-box me-1"></i>Inline
                                    </label>
                                    <input type="radio" class="btn-check" name="pagedeps" id="reference-radio">
                                    <label class="btn btn-outline-primary" for="reference-radio" title="Generate regular web pages that require network access to render.">
                                        <i class="bi bi-link-45deg me-1"></i>Reference
                                    </label>
                                </div>
                                <label class="form-label fw-bold mt-4 mb-2">Citation links</label>
                                <div class="btn-group-vertical btn-group-sm d-flex" role="group">
                                    <input type="radio" class="btn-check" name="reflinks" id="refsection-radio">
                                    <label class="btn btn-outline-primary" for="refsection-radio" title="Citation links go to the reference section.">
                                        <i class="bi bi-arrow-clockwise"></i> Go to reference section
                                    </label>
                                    <input type="radio" class="btn-check" name="reflinks" id="citation-radio">
                                    <label class="btn btn-outline-primary" for="citation-radio" title="Citation links go directly to the cited document.">
                                        <i class="bi bi-link-45deg me-1"></i>Go to linked document
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    
<script type="text/javascript">
  var _paq = window._paq || [];
  
  _paq.push(['disableCookies']);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//analytics.ietf.org/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', 7]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript><p><img src="//analytics.ietf.org/piwik.php?idsite=7" style="border:0;" alt="" /></p></noscript>

    <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'940579c1bec44afa',t:'MTc0NzM0MTg5MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
