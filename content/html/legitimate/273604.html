<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Windows driver examples</title>
</head>
<body>
<center><h1>Windows driver examples</h1></center>
Windows driver examples with free source code related to file systems, virtual disks and network communication from kernel mode. Published by Bo Brant&eacute;n.<br>
Please send comments, suggestions and corrections to
<a href="mailto:bosse@accum.se">bosse@accum.se</a>.<br>
<hr>

<h1>Latest news</h1>
<h3><i><b>Milko AFS server:</b> I have updated Milko, the server part from the Arla project, to work on modern systems: <a href="https://github.com/bobranten/milko-afs-server">https://github.com/bobranten/milko-afs-server</a>.</i></h3>
<i><b>Ext4:</b> Signed for Windows 10 and Windows 11, see below. I have implemented support for the new ext4 features metadata checksums and 64-bit blocknumbers in the ext2fsd project by Matt Wu.</i><br>
<i><b>wdkundoc.h:</b> Subset of ntifs.h to use with the WDK.</i><br>
<i><b>ntifs.h:</b> Small update.</i><br>
<i><b>RomFs release 24:</b> Implemented relative create.</i><br>
<i><b>SwapFs release 3.2:</b> Support for more than one swap partition.</i><br>
<i><b>HttpDisk release 10.1:</b> Ksocket is now built as a library.</i><br>
<i><b>Khttpd release 2.2:</b> Ksocket is now built as a library.</i><br>
<i><b>rfsd release 0.27:</b> Corrected a few memory leaks found by the ReactOS project.</i><br>
<i><b>ffsdrv release 0.5.3b:</b> Updated with a number of bug fixes from the ReactOS project including memory leaks, debug printing and pool tags.</i><br>
<i><b>nfs41-client release bb3:</b> Can be compiled with Visual Studio Community 2017 and Windows Driver Kit (WDK) for Windows 10 version 1809.</i><br>
<hr>

<h1>Documentation</h1>
My <a href="doc/branten2005.pdf">report</a> <i>"High performance kernel mode web server for Windows".</i><br>
<hr>

<h1>Ext4 filesystem driver for Windows</h1>
<b>Ext2Mgr</b> is now also updated for HiDPI displays and to show correct text on Chinese language Windows.<br>
<b>Updated</b> <a href="ext2fsd/0.71/Ext2Mgr.exe">Ext2Mgr</a> <a href="ext2fsd/0.71/Ext2Mgr-arm.exe">Ext2Mgr-arm</a> that gives more detailed information on the type of filesystems on the disk. If an on disk filesystem contains new ext4 features that is not supported by the Windows driver it will show a <q>+</q> sign after the filesystem name, e.g <q>EXT4+</q>. You can run this application together with an already installed driver, see below for install programs.<br>
<i>Release 0.71 (2024-03-02)</i><br>
<b>Signed</b> for Windows 10 and Windows 11: <a href="ext2fsd/0.71/Ext2Fsd-0.71b-setup.exe">Installation program</a>.<br>
<b>Signed</b> <a href="ext2fsd/0.71/signed/">driver files</a> for manual install (ARM/ARM64 also!)<br>
<b>Unsigned</b> for Windows XP, Windows Vista, Windows 7 and Windows 8: <a href="ext2fsd/0.71/Ext2Fsd-0.71b-setup-xp.exe">Installation program</a>.<br>
<i>Release 0.70 beta 3 (2021-02-02)</i><br>
<i>Release 0.70 beta 2 (2020-04-23)</i><br>
I am helping Matt Wu to develop support for the new features metadata checksums and 64-bit block numbers in the <a href="http://www.ext2fsd.com">ext2fsd</a> project. If you want to help to test this work here is an install program for the new driver <a href="ext2fsd/0.71/Ext2Fsd-0.71b-setup.exe">Ext2Fsd-0.71-setup.exe</a> for Windows 10 and Windows 11 and <a href="ext2fsd/0.71/Ext2Fsd-0.71-setup-xp.exe">Ext2Fsd-0.71-setup-xp.exe</a> for Windows XP, Windows Vista, Windows 7 and Windows 8. Now you can read and write ext4 filesystems using the latest features from Windows.<br>
Source code: <a href="https://github.com/bobranten/Ext4Fsd">https://github.com/bobranten/Ext4Fsd</a><br>
<hr>

<h1>Wdkundoc.h</h1>
<i>Release 3 (2015-06-11)</i><br>
Information that is undocumented in the Microsoft Windows Driver Kit (WDK).<br>
<a href="wdkundoc/wdkundoc.h">wdkundoc.h</a><br>
<a href="wdkundoc/wdkundoc.html">wdkundoc.html</a><br>
<a href="wdkundoc/wdkundoc.zip">wdkundoc.zip</a><br>
<a href="wdkundoc/wdkundoc.rar">wdkundoc.rar</a><br>
Old versions of <a href="wdkundoc/">wdkundoc.h</a>.<br>
<hr>

<h1>Ntifs.h</h1>
<i>Release 58 (2015-06-11)</i><br>
I maintain a free version of the file <a href="ntifs.h">ntifs.h</a>. It is a
collection of information of interrest to people building file system and file
system filter drivers for Windows NT, Windows 2000 and Windows XP. The
information has been found in books, magazines, on the Internet and received
from contributors.<br>
<a href="ntifs/ntifs.h">ntifs.h</a><br>
<a href="ntifs/ntifs.html">ntifs.html</a><br>
<a href="ntifs/ntifs.zip">ntifs.zip</a><br>
<a href="ntifs/ntifs.rar">ntifs.rar</a><br>
Old versions of <a href="ntifs/">ntifs.h</a>.<br>
<hr>

<h1>RomFs</h1>
<i>Release 24 (2019-03-07)</i><br>
<a href="romfs/romfs-24.zip">romfs-24.zip</a>
I want to provide an example file system driver for Windows NT/2000/XP. For some
time I have worked on an implementation of RomFs. RomFs is a small filesystem
originally implemented in Linux, because of its simple disk layout its a good
choice for an example driver. The current status is a working read-only driver
that supports caching of file data.
<a href="img/">Disk images</a> to test the driver. You can use a virtual disk like FileDisk. Note that Romfs is slow over HttpDisk.<br>
Old versions of <a href="romfs/">romfs</a>.<br>
<hr>

<h3>Links to other file system drivers for Windows with free source code</h3>
<a href="http://www.ext2fsd.com/">Ext2Fsd</a> by Matt Wu is an 
ext2, ext3 and ext4 file system driver for Windows 10.<br>
<a href="https://github.com/maharmstone/btrfs">WinBtrfs</a> by Mark Harmstone is an Btrfs driver for Windows 10.<br>
<a href="https://github.com/openzfsonwindows/ZFSin">ZFSin</a> by Jörgen Lundman is an ZFS driver for Windows 10.<br>
<a href="http://www.yipton.net/content/fsdext2/">FSDEXT2</a> by Peter van Sebille is
an ext2fs driver for Windows 95/98.<br>
<a href="http://uranus.chrysocome.net/linux/ext2ifs.htm">EXT2IFS</a> by John
Newbigin is an ext2fs driver for Windows NT.<br>
<a href="http://freesourcecodes.tripod.com/ext2.htm">Ext2 File System Driver</a>
for Windows NT 4.0 by Manoj Paul Joseph.<br>
<a href="http://win2fs.sourceforge.net">Win2fs</a> by Satish kumar Janarthanan is an Ext2 file system driver for the Microsoft Windows 2000 family of operating systems.<br>
<a href="http://www.stacken.kth.se/projekt/arla/">The arla project</a> by
Stacken at KTH is a free AFS implementation for many platforms including
Windows.<br>
<a href="http://openafs.org/">OpenAFS</a> is a free and portable AFS implementation. It contains an native network redirector for Windows.<br>
<a href="http://research.microsoft.com/~galenh/">Creating User-Mode Device
Drivers with a Proxy</a> by Galen C. Hunt.<br>
<a href="http://web.mit.edu/fifs/www/">FIFS</a> A Fremework for Implementing
User-Mode File Systems in Windows NT by Danilo Almeida.<br>
<a href="https://sourceforge.net/projects/ffsdrv/">FFS File System Driver for
Windows</a> by Lee Jae-Hong allows you to get a read access to FreeBSD, NetBSD
and OpenBSD FFS partitions.<br>
<a href="http://rfsd.sourceforge.net/">ReiserDriver</a> is an Installable File System Driver (IFSD) that allows ReiserFS partitions to be accessed under Windows. This driver has been <a href="rfsd">updated by me</a> to fix bugs and support newer versions of Windows.<br>
<u>Dokan</u> was a project to create a framework for usermode file system drivers on Windows but it is now unmaintained. Dokan is similar to <a href="https://github.com/libfuse/libfuse/">FUSE</a> (Linux file system in user space) but works on Windows.<br>
<a href="https://github.com/BenjaminKim/dokanx/">DokanX</a> and <a href="https://github.com/dokan-dev/dokany/">DokanY</a> is two forked projects that continue the development of Dokan.<br>
<hr>

<h1>SwapFs</h1>
<i>Release 3.3 (2020-03-26)</i><br>
<a href="swapfs/swapfs-3.3.zip">swapfs-3.3.zip</a>
is a driver for Windows that let you use a Linux swap partition for temporary storage like a RAM-disk. It is possible to put Windows page file on it and it has support for Plug and Play and Power Management so that standby and hibernation works. SwapFs is implemented as a disk filter driver.<br>
<i><b>Note:</b> You can allow Windows to load testsigned drivers with the command "bcdedit /set testsigning on".</i><br>
<i><b>New in release 3.2:</b> Support for more than one swap partition.</i><br>
<i><b>New in release 3.1:</b> Support for disks with GUID Partition Table (GPT).</i><br>
<i><b>New in release 3:</b> Support for swap partitions bigger than 4GB.</i><br>
<i><b>New in release 2:</b> Support for standby and hibernation.</i><br>
<a href="swapfs/swapfs-2.1.zip">SwapFs release 2.1</a> for Windows 2000 and later.<br>
<a href="swapfs/swapfs-1.zip">SwapFs release 1</a> for Windows NT 4.0.<br>
Old versions of <a href="swapfs/">swapfs</a>.<br>
<hr>

<h1>FileDisk</h1>
<i>Release 22 (2020-03-26)</i><br>
<a href="filedisk/filedisk-22.zip">filedisk-22.zip</a>
is a virtual disk driver for Windows that uses one or more files to emulate physical disks. A console application is included that let you dynamically mount and unmount files. FileDisk can also use ISO images from optical disks.<br>
<a href="filedisk/filedisk.jpg">Screenshot</a> of an example of use.<br>
FileDisk will use sparse files as disk images if the underlying file system supports it. A sparse file is a file were suficiently large blocks of zeros isn't allocated disk space. To see how much disk space a file actually uses right click on the file and choose properties. If you for example create a sparse file of 4GB, mounts it in FileDisk and formats it to NTFS, it will only take up 24MB on disk but look like a volume of 4GB. When you copy files to it the used disk space will automatically increase.<br>
<i><b>Note:</b> To be sure to take advantage of sparse image files you should use "Quick Format" when formating them.</i><br>
<i><b>Note:</b> To be able to see the virtual disks in Explorer on later versions of Windows you should run the mount program filedisk.exe as a normal user and not from a command prompt run as administrator.</i><br>
<i><b>Note:</b> You can allow Windows to load testsigned drivers with the command "bcdedit /set testsigning on".</i><br>
<a href="filedisk/filedisk-17p3.zip">filedisk-17p3.zip</a>
is a version of FileDisk contributed by Anton Zechner that lets you use an disk image of a full harddisk with partitions.<br>
<a href="filedisk/filedisk-15-signed.zip">filedisk-15-signed.zip</a>
Signed by Matt Wu so that it can be loaded on 64-bit versions of Windows without pressing F8 at boot and select "Disable enforce driver signing".<br>
<a href="http://www.winimage.com/misc/filedisk64.htm">FileDisk</a>
with support for .bin CD-ROM images by Gilles Vollant.<br>
<a href="img/">Disk images</a> to test the driver.<br>
Old versions of <a href="filedisk/">filedisk</a>.<br>
<hr>

<h1>HttpDisk</h1>
<i>Release 10.2 (2020-05-27)</i><br>
<a href="httpdisk/httpdisk-10.2.zip">httpdisk-10.2.zip</a>
is a virtual disk driver for Windows that uses the HTTP protocol to mount disk images from a web server. It is also a demonstration on how to do network communication from kernel mode on Windows using the transport driver interface (TDI).<br>
<a href="httpdisk/httpdisk.jpg">Screenshot</a> of an example of use.<br>
<i><b>Note:</b> To be able to see the virtual disks in Explorer on later versions of Windows you should run the mount program httpdisk.exe as a normal user and not from a command prompt run as administrator.</i><br>
<i><b>Note:</b> You can allow Windows to load testsigned drivers with the command "bcdedit /set testsigning on".</i><br>
<i><b>New in release 10.1:</b> Ksocket is now built as a library, this will make it easier to maintain and use for more than one project.</i><br>
<i><b>Example:</b> Installing the Windows Server 2003 Service Pack 1 (SP1) Driver Development Kit (DDK) and the Windows Driver Kit (WDK) 7.1.0 direct from Microsoft by mounting the ISO images over HTTP.</i>
<pre>
C:\&gt; httpdisk /mount 0 http://download.microsoft.com/download/9/0/f/90f019ac-8243-48d3-91cf-81fc4093ecfd/1830_usa_ddk.iso /cd f:
C:\&gt; httpdisk /mount 1 http://download.microsoft.com/download/4/a/2/4a25c7d5-efbe-4182-b6a9-ae6850409a78/grmwdk_en_7600_1.iso /cd h:
C:\&gt; f:\setup.exe &amp;&amp; h:\kitsetup.exe
</pre>
<a href="img/">Disk images</a> to test the driver.<br>
Old versions of <a href="httpdisk/">httpdisk</a>.<br>
<hr>

<h1>Khttpd</h1>
<i>Release 2.3 (2020-03-27)</i><br>
<a href="khttpd/khttpd-2.3.zip">khttpd-2.3.zip</a>
is a kernel mode web server for Windows that demonstrates how to do network communication from kernel mode using the transport driver interface (TDI) and how to use the MDL interface to the filesystem (IRP_MN_MDL and IRP_MN_COMPLETE_MDL). Using chained MDLs the HTTP header and the first file data can be sent in one network packet without any memory copy operation &mdash; so called zero-copy networking.<br>
<i><b>Note:</b> You can allow Windows to load testsigned drivers with the command "bcdedit /set testsigning on".</i><br>
<i><b>New in release 2.2:</b> Ksocket is now built as a library, this will make it easier to maintain and use for more than one project.</i><br>
<i><b>New in release 2.1:</b> Can be compiled with Visual Studio Community 2015 and Windows Driver Kit (WDK) 10.</i><br>
<i><b>New in release 2:</b> Support for 64-bit systems.</i><br>
Old versions of <a href="khttpd/">khttpd</a>.<br>
<hr>

<h1>Maintained drivers</h1>
I maintain a few open source file system drivers for Windows that was developed by other open source groups:<br>
<h3>ReiserFS file system driver for Windows</h3>
<i>Release 0.27b (2024-06-24)</i><br>
<a href="rfsd/rfsd-0.27b.zip">rfsd-0.27b.zip</a><br>
<i><b>New in release 0.27b:</b> Updated to build with newer WDK.</i><br>
<i><b>New in release 0.27:</b> Corrected a few memory leaks found by the ReactOS project.</i><br>
<i><b>New in release 0.26:</b> Can be compiled with Visual Studio Community 2015 and Windows Driver Kit (WDK) 10.</i><br>
<i><b>Note:</b> Users can continue to install 0.25.5-signed if they need a signed version.</i><br>
<a href="rfsd/rfsd-0.25.5.zip">rfsd-0.25.5.zip</a>
and
<a href="rfsd/rfsd-0.25.5-signed.zip">rfsd-0.25.5-signed.zip</a>
is an Installable File System Driver (IFSD) that allows ReiserFS partitions to be accessed under Windows. This driver has been updated by me to fix bugs and support newer versions of Windows. This driver was originally developed by Mark W Piper &lt;markwpiper@users.sourceforge.net&gt;<br>
<a href="img/">Disk images</a> to test the driver. You can use a virtual disk like FileDisk or HttpDisk.<br>
Old versions of <a href="rfsd/">rfsd</a>.<br>
<h3>FFS/UFS file system driver for Windows</h3>
<i>Release 0.5.3c (2024-06-24)</i><br>
<a href="ffsdrv/ffsdrv-0.5.3c.zip">ffsdrv-0.5.3c.zip</a>
is a file system driver for Windows that allows you to get read access to FreeBSD, NetBSD and OpenBSD FFS/UFS partitions. This driver has been updated by me to fix bugs and support newer versions of Windows. This driver was originally developed by Lee Jae-Hong &lt;pyrasis@gmail.com&gt;<br>
<i><b>Note:</b> To be able to see the file system in Explorer on later versions of Windows you should run the mount program as a normal user and not as an administrator.</i><br>
<i><b>New in release 0.5.3c:</b> Updated to build with newer WDK.</i><br>
<i><b>New in release 0.5.3b:</b> Updated with a number of bug fixes from the ReactOS project including memory leaks, debug printing and pool tags.</i><br>
<i><b>New in release 0.5.3a:</b> Corrected an bug in the reg file used when manually installing the driver.</i><br>
<i><b>New in release 0.5.3:</b> Allow to mount without administrative privileges. Can be compiled with Visual Studio Community 2015 and Windows Driver Kit (WDK) 10.</i><br>
<i><b>New in release 0.5.2:</b> Support for both normal partitions and BSD type partitions that contain one or more logical partitions.</i><br>
<a href="img/">Disk images</a> to test the driver. You can use a virtual disk like FileDisk or HttpDisk.<br>
Old versions of <a href="ffsdrv/">ffsdrv</a>.<br>
<h3>NFS version 4.1 file system driver for Windows</h3>
This driver is now maintained again at <a href="https://github.com/kofemann/ms-nfs41-client">https://github.com/kofemann/ms-nfs41-client</a> with regular releases at <a href="http://www.nrubsig.org/people/gisburn/work/msnfs41client/releases/testing/">http://www.nrubsig.org/people/gisburn/work/msnfs41client/releases/testing/</a>.<br>
This is an NFS version 4.1 client for Windows developed by the Center for Information Technology Integration at the University of Michigan. This driver has been updated by me to support more versions of Windows and to be able to be compiled with the latest versions of Visual Studio and the Windows Driver Kit (WDK).<br>
<i><b>New in release bb4:</b> Updated to build with newer WDK.</i><br>
<i><b>New in release bb3:</b> Can be compiled with Visual Studio Community 2017 and Windows Driver Kit (WDK) for Windows 10 version 1809.</i><br>
<i><b>New in release bb2:</b> Build separate versions for Windows Vista and later versions of Windows.</i><br>
<i><b>New in release bb1:</b> Support for Windows Vista, before the client only supported Windows 7 and later versions of Windows. Can be compiled with Visual Studio Community 2015 and Windows Driver Kit (WDK) 10.</i><br>
Old versions of <a href="nfs41-client/">nfs41-client</a>.<br>
<hr>

<h1>Mirrors</h1>
<a href="arla/">Mirror</a> of some files from the <a href="http://www.stacken.kth.se/project/arla/">Arla</a> project at <a href="http://www.stacken.kth.se/">stacken.kth.se</a>.<br>
<a href="ext2fsd/">Mirror</a> of <a href="http://www.ext2fsd.com/">ext2fsd.com</a> by Matt Wu.<br>
<hr>

<h1>Links</h1>
<a href="doc/SvenskPressAvBeritBranten.pdf">Svensk Press av Berit Branten</a> en uppsats i Statskunskap från 1960-talet där mamma undersöker Östersunds-Posten och Karlskoga Tidningen.<br>
Ritning p&aring; SMHIs klassiska <a href="doc/termometerbur.html">termometerbur</a> i tr&auml;.<br>
<a href="http://www.osronline.com/">OSR Online</a> by Open Systems Resources, Inc.<br>
<a href="http://www.winimage.com/">WinImage</a> by Gilles Vollant.<br>
<a href="http://www.ltr-data.se/opencode.html">Tools and utilities for Windows</a> by Olof Lagerkvist.<br>
<a href="http://members.inode.at/anton.zechner/az/VirtualNetwork.en.htm">VirtualNetwork</a> by Anton Zechner. A virtual network card, wich simulates a network card on mac level.<br>
<a href="http://www.accum.se/~bosse/hjertstedt/">Birger Sj&ouml;lins samling om sl&auml;kten Hjertstedt</a> (page in swedish on genealogy)<br>
<hr>

<i>Last modified:</i> Tuesday, 08-Apr-2025 14:25:12 CEST
</body>
</html>
