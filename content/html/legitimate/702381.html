<!DOCTYPE HTML>


<html lang="en">
<head>

	
	<link rel="preconnect" href="https://www.google-analytics.com">

	<link rel="preconnect" href="https://www.codeproject.com">


	<link rel="preload" href="https://www.codeproject.com/App_Themes/CodeProject/Img/logo250x135.gif" as="image">


	<link rel="preload" href="/App_Themes/CodeProject/Img/logo135-bg.gif" as="image">
	<link rel="preload" href="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js" as="script" type="text/javascript" >


	<title>Find the Intersection Point of Two Line Segments- CodeProject</title> 
    
	<link type="text/css" rel="stylesheet" href="https://www.codeproject.com/App_Themes/CodeProject/Css/Article.min.css?dt=2.8:2024-12-08:1">


    <script type="text/javascript" src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js" defer ></script>
<script type="text/javascript" src="https://www.codeproject.com/script/Articles/JS/article.min.js?dt=2.8:2024-12-08:1" defer ></script>

	
<meta http-equiv="content-language" content="en-US">
<meta charset="UTF-8">
<meta name="Description" content="An implementation of a line segment intersection algorithm">
<meta name="Keywords" content="C#, Dev, Beginner">
<meta name="Author" content="Kristian Lindberg Vinther">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">



<link rel="dns-prefetch" href="//ajax.googleapis.com"> 
<link rel="canonical" href="https://www.codeproject.com/Tips/862988/Find-the-Intersection-Point-of-Two-Line-Segments" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@CodeProject" />
<meta name="og:site_name" content="CodeProject" />
<meta name="twitter:creator" content="@CodeProject" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="1/9/2015 9:49:00 AM" />
<meta property="article:modified_time" content="1/9/2015 9:49:00 AM" />
<meta name="twitter:label1" content="Written by">
<meta name="twitter:data1" content="Kristian Lindberg Vinther">
<meta name="twitter:label2" content="Reading time">
<meta name="twitter:data2" content="4 min read">
<meta property="og:url" content="https://www.codeproject.com/Tips/862988/Find-the-Intersection-Point-of-Two-Line-Segments" />
<meta property="og:title" content="Find the Intersection Point of Two Line Segments" />
<meta property="og:description" content="An implementation of a line segment intersection algorithm" />


<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"> 
<link rel="manifest" href="/favicon/manifest.json"> 
<link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type='application/ld+json'>{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Tips/862988/Find-the-Intersection-Point-of-Two-Line-Segments"
   },
  "name": "Find the Intersection Point of Two Line Segments",
  "headline": "Find the Intersection Point of Two Line Segments",
  "url": "https://www.codeproject.com/Tips/862988/Find-the-Intersection-Point-of-Two-Line-Segments",
  "discussionUrl": "https://www.codeproject.com/Tips/862988/Find-the-Intersection-Point-of-Two-Line-Segments#_comments",
  "isFamilyFriendly": "true",
  "image": "https://www.codeproject.com/App_Themes/CodeProject/Img/Article100.png",
  "keywords": "C#,Dev,Beginner",
  "commentCount": "0",
  "editor" : {
    "@type" : "Person",
    "name" : "Editor",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=3866010"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "An implementation of a line segment intersection algorithm",
  "articleSection": "C#",
  "author" : [{
      "@type" : "Person",
      "name" : "Kristian Lindberg Vinther",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=1734631"
    }],
  "datePublished": "2015-01-09",
  "dateCreated": "2015-01-09",
  "dateModified": "2015-01-09"
,
  "contentRating" : {
    "@type" : "Rating",
    "ratingValue" : 5.00,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type='application/ld+json'>{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=Languages",
      "name" : "Languages"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=Csharp",
      "name" : "C#"
    }
  }]
}</script>


	<base target="_top" />
	
    


<script type='text/javascript'>
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





    <script async type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-1735123-1"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-1735123-1' , {'user_id': '46792c9a-7f7c-48c1-a2af-08db544487e3'});
    </script>

</head>	

<body class="chrome chrome115">



<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="https://www.codeproject.com/images/t.gif" /></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed narrow">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">65,938 articles</div>
	
	<div id="ctl00_MemberBar_ChangeNotice" class="flex-item align-left">CodeProject
	is changing. <a href="/info/Changes.aspx">Read more</a>.</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		

		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed narrow">
        <div class="main-content">
            <div class="logo"><a href="/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="https://www.codeproject.com/App_Themes/CodeProject/Img/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;" /></a></div>
            <div class="promo"></div>
        </div>
    </div>

	
			
	

	<div id="A" class="container-content-wrap fixed narrow"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a rel="nofollow" href="/script/Content/SiteMap.aspx">Articles</a> / <a rel="nofollow" href="/script/Content/Tag.aspx?tags=Languages">Languages</a> / <a rel="nofollow" href="/script/Content/Tag.aspx?tags=Csharp">C#</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="/Tips/862988/Find-the-Intersection-Point-of-Two-Line-Segments?display=Print">
   <img src="/App_Themes/CodeProject/Img/print48.png" 
	    width="24" height="24" style="border:0">
</a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
		    
            

			
			<div id="AT" class="article-container  fixed narrow" style="max-width:inherit;"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="./View.aspx" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="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" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69" />
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>
					    <a name="_articleTop" id="_articleTop"></a>

					    
						<div>
							<span id="ctl00_TagListHorz_TagWrp" class="tags horizontal">

	
	

	
	<span id="ctl00_TagListHorz_VisibleTags"><div class="t"><a rel="tag" href="/Tags/Csharp" data-id="81">C#</a></div></span> 

	
	
</span>


						</div>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">Find the Intersection Point of Two Line Segments</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

								

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="/script/Membership/View.aspx?mid=1734631" rel="author">Kristian Lindberg Vinther</a></span> 

                                        <div class="flex-item" style="margin-top:-4px;">
                                            <div id="ctl00_RateArticle_RatingTable" class="small-text" data-objectref="2_862988">

	<meta itemprop="upvoteCount" content="10">


	<div id="ctl00_RateArticle_RatingRow" class="flex-container rating-container large-stars">

					
		

		
		<div class="nowrap tooltip">

			
			<div id="ctl00_RateArticle_ResultNoHist" class="rating-result"><div class="flex-container rating-stars large-stars"><div><img src='https://www.codeproject.com/script/Ratings/Images/star-fill-lg.png' style='width:24px;height:24px'></div><div><img src='https://www.codeproject.com/script/Ratings/Images/star-fill-lg.png' style='width:24px;height:24px'></div><div><img src='https://www.codeproject.com/script/Ratings/Images/star-fill-lg.png' style='width:24px;height:24px'></div><div><img src='https://www.codeproject.com/script/Ratings/Images/star-fill-lg.png' style='width:24px;height:24px'></div><div><img src='https://www.codeproject.com/script/Ratings/Images/star-fill-lg.png' style='width:24px;height:24px'></div></div></div>
			

			
			

			
            

			
                

		</div>
		
	
		
		<div id="ctl00_RateArticle_VoteCountNoHist" class="rating-votes nowrap">5.00/5  (10 votes)</div>	

		

		
		<div class="rating-undo" title="Undo vote" style="margin-left:5px;display:none"></div>

		
		
	</div>

	
	

</div>

                                        </div>
                                    </div>

                                    <div class="flex-container" style="color:#666;font-size:smaller">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">9 Jan 2015</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" title="Licence" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a><span id="ctl00_ReadingTime" class="stats flex-item-tight">4 min read</span><span id="ctl00_HorizontalStats" class="stats flex-item-tight"><span class="stats"><span title='Views'><img src='https://www.codeproject.com/App_Themes/CodeProject/Img/views32.png' style='width:16px'> 115.4K</span> &nbsp; <span title='Downloads'><img src='https://www.codeproject.com/App_Themes/CodeProject/Img/download32.png' style='width:16px'> 1.5K</span> &nbsp; </span></span>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_DescriptionSpot" class="summary">An implementation of a line segment intersection algorithm</div><span id="ctl00_ThumbnailUrl" class="date" content="https://www.codeproject.com/script/Articles/Images/tip100x80.png"></span>			

                    </div>
                    
					
					

					

					
					

					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<!-- Article Starts -->

<ul class="download">
    <li><a href="/KB/recipes/862988/LineSegmentIntersection.zip">Download source - 1.7 KB</a></li></ul>

<h2>Introduction</h2>

<p>The following is an implementation of a Line Segment Intersection Algorithm that will test whether two line segments intersect. If so, it will calculate the actual intersection point. <a href="http://stackoverflow.com/users/68063/gareth-rees">Gareth Rees</a> describes the algorithm in <a href="http://stackoverflow.com/a/565282/292237">a StackOverflow article on the subject</a>.</p>

<p>See: <a href="http://stackoverflow.com/a/565282/292237">http://stackoverflow.com/a/565282/292237</a>.</p>

<h3>Using the Code</h3>

<p>The attached zip-file contains a single C# source file. Apart from the algorithm code itself, it contains a small test class using Visual Studio 2013's test framework.</p>

<h3>My Motivation</h3>

<p>While fooling around with some graphics code, I ran into the problem of clipping line segments using a bounding box. My approach was to test whether my line segment intersected one of the four sides of the bounding rectangle. I searched around for an implementation but was not immediately able to find something that I could copy/paste into my C# project. Therefore, I decided to do the implementation myself. I chose a very explicitly described algorithm, so that I was sure that I understood what was going on - my geometry lessons from school were buried deep within my brain, so I basically had to re-learn it all.</p>

<h2>Background</h2>

<p>Testing for intersection between segments is a bit more tricky than finding intersections between infinite lines on the form <code>y = ax + b</code>, as they are a bit easier to solve symbolically.</p>

<p>When testing for intersection between two line segments, there are five cases to consider. The code will go through these cases one by one.</p>

<ol>
    <li>The line segments are collinear and overlapping, meaning that they share more than one point.</li>    <li>The line segments are collinear but not overlapping, sort of "chunks" of the same line.</li>    <li>The line segments are parallel and non-intersecting.</li>    <li>The line segments have a single point of intersection.</li>    <li>The line segments do not intersect.</li></ol>

<h2>Implementing the Algorithm</h2>

<p>This algorithm uses basic vector math including calculation of the so-called dot product and cross product. I will start by implementing a 2D vector class containing the basic arithmetic functions. This makes the algorithm code far more readable and similar to the symbolic description in Gareth's article.</p>

<h3>A Simple 2D Vector Class</h3>

<p>This class implements vector arithmetic such as addition, subtraction and scaling (multiplying with a constant). The '*' (asterisk sign) used between two vectors will return the dot product. Finally, the <code>Cross()</code> function returns the cross product between the vector and another vector. I will use two vectors to describe the start and end points of a line segment.</p>

<div class='pre-lang' id='premain491916'><div>C#</div><div class='pre-action-link'><span id='copycode491916' class='copy-code' data-index='491916' style='visibility:hidden'><svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' viewBox='0 0 460 460' style='width: 16px;height:16px;' xml:space='preserve'><g><path d='M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z'></path><path d='M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z'></path></g></svg></span></div></div>
<pre id='pre491916' style='margin-top:0;' class='lang-csharp' data-language='cs' data-allowShrink='True' data-collapse='False'>
<span class="code-keyword">public</span> <span class="code-keyword">class</span> Vector
{
    <span class="code-keyword">public</span> <span class="code-keyword">double</span> X;
    <span class="code-keyword">public</span> <span class="code-keyword">double</span> Y;

    <span class="code-comment">//</span><span class="code-comment"> Constructors.</span>
    <span class="code-keyword">public</span> Vector(<span class="code-keyword">double</span> x, <span class="code-keyword">double</span> y) { X = x; Y = y; }
    <span class="code-keyword">public</span> Vector() : <span class="code-keyword">this</span>(<span class="code-keyword">double</span>.NaN, <span class="code-keyword">double</span>.NaN) {}

    <span class="code-keyword">public</span> <span class="code-keyword">static</span> Vector <span class="code-keyword">operator</span> -(Vector v, Vector w)
    {
        <span class="code-keyword">return</span> <span class="code-keyword">new</span> Vector(v.X - w.X, v.Y - w.Y);
    }

    <span class="code-keyword">public</span> <span class="code-keyword">static</span> Vector <span class="code-keyword">operator</span> +(Vector v, Vector w)
    {
        <span class="code-keyword">return</span> <span class="code-keyword">new</span> Vector(v.X + w.X, v.Y + w.Y);
    }

    <span class="code-keyword">public</span> <span class="code-keyword">static</span> <span class="code-keyword">double</span> <span class="code-keyword">operator</span> *(Vector v, Vector w)
    {
        <span class="code-keyword">return</span> v.X * w.X + v.Y * w.Y;
    }

    <span class="code-keyword">public</span> <span class="code-keyword">static</span> Vector <span class="code-keyword">operator</span> *(Vector v, <span class="code-keyword">double</span> mult)
    {
        <span class="code-keyword">return</span> <span class="code-keyword">new</span> Vector(v.X * mult, v.Y * mult);
    }

    <span class="code-keyword">public</span> <span class="code-keyword">static</span> Vector <span class="code-keyword">operator</span> *(<span class="code-keyword">double</span> mult, Vector v)
    {
        <span class="code-keyword">return</span> <span class="code-keyword">new</span> Vector(v.X * mult, v.Y * mult);
    }

    <span class="code-keyword">public</span> <span class="code-keyword">double</span> Cross(Vector v)
    {
        <span class="code-keyword">return</span> X * v.Y - Y * v.X;
    }

    <span class="code-keyword">public</span> <span class="code-keyword">override</span> <span class="code-keyword">bool</span> Equals(<span class="code-keyword">object</span> obj)
    {
        <span class="code-keyword">var</span> v = (Vector)obj;
        <span class="code-keyword">return</span> (X - v.X).IsZero() &amp;&amp; (Y - v.Y).IsZero();
    }
}</pre>

<h3>A Small Helper Class</h3>

<p>When working with floating point numbers in computers, there is bound to be some rounding errors, which makes it difficult when you, for example, want to test if a number is equal to zero. Therefore, we choose a very small constant to test against, and if our number is lower than this constant, we consider it zero. Here, I have made a little extension method to help us. I use an extension method, merely because I find it visually pleasing.</p>

<div class='pre-lang' id='premain755197'><div>C#</div><div class='pre-action-link'><span id='copycode755197' class='copy-code' data-index='755197' style='visibility:hidden'><svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' viewBox='0 0 460 460' style='width: 16px;height:16px;' xml:space='preserve'><g><path d='M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z'></path><path d='M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z'></path></g></svg></span></div></div>
<pre id='pre755197' style='margin-top:0;' class='lang-csharp' data-language='cs' data-allowShrink='True' data-collapse='False'>
<span class="code-keyword">public</span> <span class="code-keyword">static</span> <span class="code-keyword">class</span> Extensions
{
    <span class="code-keyword">private</span> <span class="code-keyword">const</span> <span class="code-keyword">double</span> Epsilon = 1e-10;

    <span class="code-keyword">public</span> <span class="code-keyword">static</span> <span class="code-keyword">bool</span> IsZero(<span class="code-keyword">this</span> <span class="code-keyword">double</span> d)
    {
        <span class="code-keyword">return</span> Math.Abs(d) &lt; Epsilon;
    }
}</pre>

<h3>The Algorithm</h3>

<p>At this point, I would suggest that you open Gareth's original article and follow along in his description. He gives a very good explanation and has some meaningful images to go along. Also I have chosen to stick very close to the naming used in his article.</p>

<p>The <code>LineSegementsIntersect</code> function takes the start and end points of the two line segments and an <code>out </code>parameter for the intersection point.</p>

<p>For the purpose of my own code, I have added a Boolean parameter to decide whether we should consider overlapping lines as "intersecting". If we do, the function will return <code>true </code>in these cases, but the intersection point will have no meaning and will have the value <code>NaN </code>(not a number) for both <code>x </code>and <code>y</code>.</p>

<div class='pre-lang' id='premain911505'><div>C#</div><div class='pre-action-link'><span id='copycode911505' class='copy-code' data-index='911505' style='visibility:hidden'><svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' viewBox='0 0 460 460' style='width: 16px;height:16px;' xml:space='preserve'><g><path d='M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z'></path><path d='M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z'></path></g></svg></span></div></div>
<pre id='pre911505' style='margin-top:0;' class='lang-csharp' data-language='cs' data-allowShrink='True' data-collapse='False'>
<span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> Test whether two line segments intersect. If so, calculate the intersection point.
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">see</span><span class="code-summarycomment"> </span><span class="code-summarycomment">cref="http://stackoverflow.com/a/14143738/292237"/</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">param</span><span class="code-summarycomment"> </span><span class="code-summarycomment">name="p"</span><span class="code-summarycomment">&gt;</span>Vector to the start point of p.<span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/param</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">param</span><span class="code-summarycomment"> </span><span class="code-summarycomment">name="p2"</span><span class="code-summarycomment">&gt;</span>Vector to the end point of p.<span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/param</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">param</span><span class="code-summarycomment"> </span><span class="code-summarycomment">name="q"</span><span class="code-summarycomment">&gt;</span>Vector to the start point of q.<span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/param</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">param</span><span class="code-summarycomment"> </span><span class="code-summarycomment">name="q2"</span><span class="code-summarycomment">&gt;</span>Vector to the end point of q.<span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/param</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">param</span><span class="code-summarycomment"> </span><span class="code-summarycomment">name="intersection"</span><span class="code-summarycomment">&gt;</span>The point of intersection, if any.<span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/param</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">param</span><span class="code-summarycomment"> </span><span class="code-summarycomment">name="considerOverlapAsIntersect"</span><span class="code-summarycomment">&gt;</span>Do we consider overlapping lines as intersecting?
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/param</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">returns</span><span class="code-summarycomment">&gt;</span>True if an intersection point was found.<span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/returns</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-keyword">public</span> <span class="code-keyword">static</span> <span class="code-keyword">bool</span> LineSegementsIntersect(Vector p, Vector p2, Vector q, Vector q2, 
    <span class="code-keyword">out</span> Vector intersection, <span class="code-keyword">bool</span> considerCollinearOverlapAsIntersect = <span class="code-keyword">false</span>)
{
    intersection = <span class="code-keyword">new</span> Vector();

    <span class="code-keyword">var</span> r = p2 - p;
    <span class="code-keyword">var</span> s = q2 - q;
    <span class="code-keyword">var</span> rxs = r.Cross(s);
    <span class="code-keyword">var</span> qpxr = (q - p).Cross(r);

    <span class="code-comment">//</span><span class="code-comment"> If r x s = 0 and (q - p) x r = 0, then the two lines are collinear.</span>
    <span class="code-keyword">if</span> (rxs.IsZero() &amp;&amp; qpxr.IsZero())
    {
        <span class="code-comment">//</span><span class="code-comment"> 1. If either  0 &lt;= (q - p) * r &lt;= r * r or 0 &lt;= (p - q) * s &lt;= * s</span>
        <span class="code-comment">//</span><span class="code-comment"> then the two lines are overlapping,</span>
        <span class="code-keyword">if</span> (considerCollinearOverlapAsIntersect)
            <span class="code-keyword">if</span> ((<span class="code-digit">0</span> &lt;= (q - p)*r &amp;&amp; (q - p)*r &lt;= r*r) || (<span class="code-digit">0</span> &lt;= (p - q)*s &amp;&amp; (p - q)*s &lt;= s*s))
                <span class="code-keyword">return</span> <span class="code-keyword">true</span>;

        <span class="code-comment">//</span><span class="code-comment"> 2. If neither 0 &lt;= (q - p) * r = r * r nor 0 &lt;= (p - q) * s &lt;= s * s</span>
        <span class="code-comment">//</span><span class="code-comment"> then the two lines are collinear but disjoint.</span>
        <span class="code-comment">//</span><span class="code-comment"> No need to implement this expression, as it follows from the expression above.</span>
        <span class="code-keyword">return</span> <span class="code-keyword">false</span>;
    }

    <span class="code-comment">//</span><span class="code-comment"> 3. If r x s = 0 and (q - p) x r != 0, then the two lines are parallel and non-intersecting.</span>
    <span class="code-keyword">if</span> (rxs.IsZero() &amp;&amp; !qpxr.IsZero())
        <span class="code-keyword">return</span> <span class="code-keyword">false</span>;

    <span class="code-comment">//</span><span class="code-comment"> t = (q - p) x s / (r x s)</span>
    <span class="code-keyword">var</span> t = (q - p).Cross(s)/rxs;

    <span class="code-comment">//</span><span class="code-comment"> u = (q - p) x r / (r x s)</span>

    <span class="code-keyword">var</span> u = (q - p).Cross(r)/rxs;

    <span class="code-comment">//</span><span class="code-comment"> 4. If r x s != 0 and 0 &lt;= t &lt;= 1 and 0 &lt;= u &lt;= 1</span>
    <span class="code-comment">//</span><span class="code-comment"> the two line segments meet at the point p + t r = q + u s.</span>
    <span class="code-keyword">if</span> (!rxs.IsZero() &amp;&amp; (<span class="code-digit">0</span> &lt;= t &amp;&amp; t &lt;= <span class="code-digit">1</span>) &amp;&amp; (<span class="code-digit">0</span> &lt;= u &amp;&amp; u &lt;= <span class="code-digit">1</span>))
    {
        <span class="code-comment">//</span><span class="code-comment"> We can calculate the intersection point using either t or u.</span>
        intersection = p + t*r;

        <span class="code-comment">//</span><span class="code-comment"> An intersection was found.</span>
        <span class="code-keyword">return</span> <span class="code-keyword">true</span>;
    }

    <span class="code-comment">//</span><span class="code-comment"> 5. Otherwise, the two line segments are not parallel but do not intersect.</span>
    <span class="code-keyword">return</span> <span class="code-keyword">false</span>;
}</pre>

<h2>Testing the Code</h2>

<p>A few simple unit tests could look like the ones below. I am using Visual Studio 2013's test framework.</p>

<div class='pre-lang' id='premain303662'><div>C#</div><div class='pre-action-link'><span id='copycode303662' class='copy-code' data-index='303662' style='visibility:hidden'><svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' viewBox='0 0 460 460' style='width: 16px;height:16px;' xml:space='preserve'><g><path d='M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z'></path><path d='M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z'></path></g></svg></span></div></div>
<pre id='pre303662' style='margin-top:0;' class='lang-csharp' data-language='cs' data-allowShrink='True' data-collapse='False'>
<span class="code-bracket">[</span><span class="code-sdkkeyword">TestMethod</span>]
<span class="code-keyword">public</span> <span class="code-keyword">void</span> LineSegmentsIntersect()
{
    Vector intersection;
    <span class="code-keyword">var</span> actual = LineSegementsIntersect(
        <span class="code-keyword">new</span> Vector(<span class="code-digit">0</span>, <span class="code-digit">0</span>),
        <span class="code-keyword">new</span> Vector(<span class="code-digit">5</span>, <span class="code-digit">5</span>),
        <span class="code-keyword">new</span> Vector(<span class="code-digit">0</span>, <span class="code-digit">5</span>),
        <span class="code-keyword">new</span> Vector(<span class="code-digit">5</span>, <span class="code-digit">0</span>),
        <span class="code-keyword">out</span> intersection);

    Assert.IsTrue(actual);
    Assert.AreEqual(<span class="code-keyword">new</span> Vector(<span class="code-digit">2</span>.<span class="code-digit">5</span>, <span class="code-digit">2</span>.<span class="code-digit">5</span>), intersection);
}

[TestMethod]
<span class="code-keyword">public</span> <span class="code-keyword">void</span> LineSegmentsDoNotIntersect()
{
    Vector intersection;
    <span class="code-keyword">var</span> actual = LineSegementsIntersect(
        <span class="code-keyword">new</span> Vector(<span class="code-digit">3</span>, <span class="code-digit">0</span>),
        <span class="code-keyword">new</span> Vector(<span class="code-digit">3</span>, <span class="code-digit">4</span>),
        <span class="code-keyword">new</span> Vector(<span class="code-digit">0</span>, <span class="code-digit">5</span>),
        <span class="code-keyword">new</span> Vector(<span class="code-digit">5</span>, <span class="code-digit">5</span>),
        <span class="code-keyword">out</span> intersection);

    Assert.IsFalse(actual);
}

[TestMethod]
<span class="code-keyword">public</span> <span class="code-keyword">void</span> LineSegmentsAreCollinearAndOverlapping()
{
    Vector intersection;
    <span class="code-keyword">var</span> actual = LineSegementsIntersect(
        <span class="code-keyword">new</span> Vector(<span class="code-digit">0</span>, <span class="code-digit">0</span>),
        <span class="code-keyword">new</span> Vector(<span class="code-digit">2</span>, <span class="code-digit">0</span>),
        <span class="code-keyword">new</span> Vector(<span class="code-digit">1</span>, <span class="code-digit">0</span>),
        <span class="code-keyword">new</span> Vector(<span class="code-digit">3</span>, <span class="code-digit">0</span>),
        <span class="code-keyword">out</span> intersection, 
        considerCollinearOverlapAsIntersect: <span class="code-keyword">true</span>);

    Assert.IsTrue(actual);
    Assert.AreEqual(<span class="code-keyword">double</span>.NaN, intersection.X);
    Assert.AreEqual(<span class="code-keyword">double</span>.NaN, intersection.Y);
}</pre>

<h2>Points of Interest</h2>

<h3>Proper and Non-proper Intersection</h3>

<p>There exists a concept of <em>proper </em>and <em>non-proper </em>intersection. A proper intersection is when the two segments share exactly one point and this point lies in the <em>interior</em> of both segments, whereas a non-proper intersection would occur in one of the segments' start or end point. At the moment, the code does not distinguish between these two cases, but a check could be easily added by testing the intersection point for equality against the four input vectors. I guess the choice of whether you would like to include non-proper intersections is up to the use case of your code.</p>

<h3>Collinearity and Non-proper Intersection</h3>

<p>When two segments are overlapping, e.g. (0,0-&gt;2,0) and (1,0-&gt;2,0), we have no meaningful concept of an intersection point, as there in theory are an infinite amount of them. However, consider the two line segments along the x-axis (0,0-&gt;1,0) and (1,0 -&gt;2,0). These two segments have a non-proper intersection in the point (1,0). If we include non-proper intersections, we actually would have a valid intersection point in this case. As they are collinear, the code will not calculate this intersection point. However, it will return <code>true</code>, if we have set the <em><code>considerCollinearOverlapAsIntersect </code></em>parameter to <code>true</code>. Again, the code could be modified to handle this edge case if you see fit.</p>

<h2>Changes</h2>


            
    <table class="ArticleTable"><thead>        <tr>            <td>Date</td>            <td>Changes</td>        </tr>    </thead>    <tbody>        <tr>            <td>15 Jan 2015</td>            <td>Corrections based on feedback from user <a href="http://www.codeproject.com/script/Membership/View.aspx?mid=11059550" style="color: rgba(51, 51, 51, 1); font-size: 12px; font-weight: bold">raildude</a> </td>        </tr></tbody></table>

<!-- Article Ends -->


						</div>
						

						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						

						
						<br />
						
						    <br />
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    
				</div>
				
                
                

				
				
				

			</div>
			

            
            
            

        </div>
        

		
		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="/Tips/862988/Find-the-Intersection-Point-of-Two-Line-Segments">Permalink</a><br>
				<br>
				<a id="ctl00_PrivacyLink" href="/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="/tips/862988/webcontrols?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="/tips/862988/webcontrols?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2015 by Kristian Lindberg Vinther<br />Everything else
				Copyright &copy; <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2025<br />
                <br>
				Web01 
				2.8:2024-12-08:1<br>
			</div>
		</div>
		

		<br clear="all" />
		
			

	</div> 
	</div> 
</div>







<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	new CodeBlocks().initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');

})
</script>








</body>

</html>